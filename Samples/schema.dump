--
-- PostgreSQL database dump
--

-- Dumped from database version 13.10
-- Dumped by pg_dump version 13.10

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_quest_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: _access_groups; Type: TYPE; Schema: public; Owner: -
--

CREATE TYPE public._access_groups AS ENUM (
    'Prefranchise',
    'franchiseContact',
    'Instructor',
    'InstructorAdmin',
    'GroupLeader',
    'franchiseAdmin',
    'Coordinator',
    'CorporateAdmin',
    'AssocAdmin',
    'Support',
    'Manager',
    'Administrators'
);


--
-- Name: all_access_levels; Type: TYPE; Schema: public; Owner: -
--

CREATE TYPE public.all_access_levels AS ENUM (
    'Learner',
    'Prefranchise',
    'franchiseContact',
    'OAuth2RemoteDeveloper',
    'InstructorAdmin',
    'Instructor',
    'GroupLeader',
    'franchiseAdmin',
    'Coordinator',
    'CorporateAdmin',
    'AssocAdmin',
    'Support',
    'Manager',
    'Administrators',
    'SoftwareDevelopment'
);


--
-- Name: add_update_triggers(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.add_update_triggers() RETURNS text
    LANGUAGE plpgsql
    AS $$
		DECLARE
			tbl varchar;
		BEGIN
			FOR tbl in SELECT tablename FROM pg_tables WHERE tablename LIKE '%' LOOP
				PERFORM add_trigger(tbl);
			END LOOP;
			RETURN tbl;

		END;
	$$;


--
-- Name: add_trigger(text); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.add_trigger(text) RETURNS text
    LANGUAGE plpgsql
    AS $_$
		DECLARE
			tbl varchar := $1;

		BEGIN

			EXECUTE 'DROP TRIGGER IF EXISTS tgr_autoupdate_modified_column ON  '
				|| quote_ident(tbl);

			EXECUTE 'CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON  '
				|| quote_ident(tbl)
				|| ' FOR EACH ROW EXECUTE PROCEDURE '
				|| ' fn_autoupdate_modified_column() ';
			RETURN 'TRIGGER ADDED';
		END;
	$_$;


--
-- Name: fn_all_roles(integer, text); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_all_roles(prin_var integer, assoc text DEFAULT 'None'::text) RETURNS SETOF character varying
    LANGUAGE plpgsql IMMUTABLE
    AS $_$ 
           DECLARE
                prin_var integer := $1;
		ret text;
    	   BEGIN
		RETURN QUERY SELECT DISTINCT prin.name FROM principals AS prin
        	       	      WHERE prin.id IN (
		       	        SELECT group_id FROM usergroup
		        	WHERE principal_id = prin_var
				) AND prin.name IN (
		                    SELECT enumlabel FROM pg_enum);
           END;

$_$;


--
-- Name: fn_autoupdate_modified_column(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_autoupdate_modified_column() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
	BEGIN
		NEW.modified = NOW();
		return NEW;
	END;
	$$;


--
-- Name: fn_insert_top_role(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_insert_top_role() RETURNS trigger
    LANGUAGE plpgsql
    AS $_$
DECLARE
    _row RECORD;
    pid INTEGER;
    type_val TEXT;
    roles TEXT[];
    top_role TEXT;
    _insert_query TEXT;
BEGIN

    BEGIN
        _row := NEW;
        pid := _row.principal_id;
        SELECT type INTO type_val FROM principals WHERE id = pid;
        IF type_val != 'users' THEN
            RETURN NEW;
        END IF;
    EXCEPTION
        WHEN OTHERS THEN
            _row := OLD;
            pid := _row.principal_id;
    END;

    EXECUTE 'DELETE FROM principal_top_role WHERE principal_id = ' || pid;

    EXECUTE '
        SELECT ARRAY(
            SELECT prin.name FROM principals AS prin
            JOIN usergroup AS ug ON ug.group_id = prin.id
            WHERE ug.principal_id = ' || pid || '
            INTERSECT (
                SELECT name::varchar FROM unnest(enum_range(NULL::all_access_levels)) AS name
            )
        )
    ' INTO roles;

    IF roles = NULL OR roles IS NULL OR array_length(roles, 1) = 0 THEN
        roles := ARRAY['Learner'];
    ELSE
        EXECUTE '
            SELECT max(name::all_access_levels) FROM (
                SELECT name FROM principals AS prin
                JOIN usergroup AS ug ON ug.group_id = prin.id
                WHERE ug.principal_id = ' || pid || '
                INTERSECT (
                    SELECT name::varchar FROM unnest(enum_range(NULL::all_access_levels)) AS name
                )
            ) AS FOO
        ' INTO top_role;
    END IF;

    IF roles = '{}' OR roles IS NULL OR array_length(roles, 1) = 0 THEN
        roles := ARRAY['Learner'];
    END IF;

    IF top_role IS NULL OR top_role = NULL THEN
        top_role := 'Learner';
    END IF;

    _insert_query := 'INSERT INTO principal_top_role (principal_id, top_role, roles) VALUES ($1, $2, $3)';
    EXECUTE _insert_query using pid, top_role, roles;
    RETURN NEW;
END;
$_$;


--
-- Name: fn_ses_mis_lics(integer, integer); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_ses_mis_lics(integer, integer) RETURNS SETOF character varying
    LANGUAGE plpgsql IMMUTABLE
    AS $_$ 
           DECLARE
                mem_var integer := $1;
                ses_var integer := $2;

    	   	BEGIN
			RETURN QUERY SELECT product_title FROM products 
			       WHERE ID in (
			       SELECT product_id FROM quests_req_lics 
			       	      WHERE quest_id = ses_var 
				      	    AND product_id NOT IN  (
				       	    	SELECT product_id FROM players_licenses WHERE player_id = mem_var) 
				            AND product_id not in (
				       	    	SELECT product_id FROM product_kits WHERE kit_id IN (
					   	SELECT product_id FROM players_licenses WHERE player_id = mem_var
						)
					        )
					);
	   RETURN;
			   
           END;

$_$;


--
-- Name: fn_top_role(integer); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_top_role(prin integer) RETURNS public.all_access_levels
    LANGUAGE sql
    AS $_$
  WITH all_access_levels AS (
    SELECT unnest(enum_range(null::all_access_levels)) AS level
  )
  SELECT COALESCE(MAX(name::all_access_levels), 'Learner')  AS name
  FROM principals
  WHERE id IN (
    SELECT group_id
    FROM usergroup
    WHERE principal_id = $1
    and name in (select unnest(enum_range(null::all_access_levels))::varchar)
    )
$_$;


--
-- Name: fn_update_current_state(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.fn_update_current_state() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    UPDATE players
    SET current_state = (
        SELECT activation_title
        FROM activation_states
        WHERE id = NEW.activation_id
    )
    WHERE id = NEW.player_id;
    RETURN NEW;
END;
$$;


--
-- Name: setmoddate(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.setmoddate() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
  BEGIN
  new.modification_date = NOW();
  RETURN new;
  END;
$$;


SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: activation_details; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.activation_details (
    id integer NOT NULL,
    player_id integer,
    activation_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: activation_details_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.activation_details_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: activation_details_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.activation_details_id_seq OWNED BY public.activation_details.id;


--
-- Name: activation_states; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.activation_states (
    id integer NOT NULL,
    activation_id integer,
    activation_title character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: activation_states_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.activation_states_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: activation_states_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.activation_states_id_seq OWNED BY public.activation_states.id;


--
-- Name: assoc_course_types; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.assoc_course_types (
    id integer NOT NULL,
    title character varying(255),
    description character varying(255),
    association_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: assoc_course_types_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.assoc_course_types_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: assoc_course_types_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.assoc_course_types_id_seq OWNED BY public.assoc_course_types.id;


--
-- Name: assoc_franchise_gp_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.assoc_franchise_gp_map (
    gp_id integer NOT NULL,
    association_id integer NOT NULL
);


--
-- Name: assoc_franchise_type_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.assoc_franchise_type_map (
    type_id integer NOT NULL,
    association_id integer NOT NULL
);


--
-- Name: assoc_quest_types; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.assoc_quest_types (
    id integer NOT NULL,
    title character varying(255),
    description character varying(255),
    association_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    learning_path_id character varying(255),
    proctor_options character varying(16)[]
);


--
-- Name: assoc_quest_types_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.assoc_quest_types_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: assoc_quest_types_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.assoc_quest_types_id_seq OWNED BY public.assoc_quest_types.id;


--
-- Name: association_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.association_map (
    id integer NOT NULL,
    association_id integer,
    franchise_id integer,
    quest_id integer,
    player_id integer,
    product_id integer,
    login_sequence_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: association_map_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.association_map_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: association_map_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.association_map_id_seq OWNED BY public.association_map.id;


--
-- Name: associations; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.associations (
    id integer NOT NULL,
    association_id character varying,
    association_title character varying,
    address character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    prc_address character varying(255) DEFAULT ''::character varying,
    crm_address character varying(255) DEFAULT ''::character varying,
    chooser_address character varying(255) DEFAULT ''::character varying,
    email_from_address character varying(255) DEFAULT ''::character varying,
    global_bcc character varying(255) DEFAULT ''::character varying,
    ecom_bcc character varying(255) DEFAULT ''::character varying,
    ecom_error_email character varying(255) DEFAULT ''::character varying,
    business_owner_email character varying(255),
    assoc_support_email character varying(255),
    inventory_updated_roles character varying[],
    lac_address character varying(255),
    help_url_en character varying(255) DEFAULT NULL::character varying,
    help_url_fr character varying(255) DEFAULT NULL::character varying,
    prc_groups_merged boolean DEFAULT false,
    system_error_email character varying(255),
    ws_test_uri character varying(255),
    customercare_phone character varying,
    customercare_email character varying,
    ecom_store_url character varying,
    allow_deep_links boolean DEFAULT false,
    languages character varying[]
);


--
-- Name: associations_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.associations_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: associations_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.associations_id_seq OWNED BY public.associations.id;


--
-- Name: ceu; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ceu (
    id integer NOT NULL,
    provider_id integer,
    parent_id integer NOT NULL,
    title character varying,
    author character varying,
    employer character varying,
    organization character varying,
    job_title character varying,
    other_provider character varying,
    content_areas character varying[],
    description character varying,
    start_date date,
    end_date date,
    url character varying,
    contact_name character varying,
    contact_email character varying,
    contact_phone character varying,
    credits double precision,
    category character varying,
    publication_year character varying,
    recertification_date date,
    created timestamp without time zone DEFAULT now()
);


--
-- Name: ceu_container; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ceu_container (
    id integer NOT NULL,
    player_id integer,
    product_id integer,
    status character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    renewal_date date
);


--
-- Name: ceu_container_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.ceu_container_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: ceu_container_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.ceu_container_id_seq OWNED BY public.ceu_container.id;


--
-- Name: ceu_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.ceu_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: ceu_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.ceu_id_seq OWNED BY public.ceu.id;


--
-- Name: ceu_provider; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ceu_provider (
    id integer NOT NULL,
    title character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: ceu_provider_assoc_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ceu_provider_assoc_map (
    id integer NOT NULL,
    provider_id integer,
    association_id integer
);


--
-- Name: ceu_provider_assoc_map_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.ceu_provider_assoc_map_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: ceu_provider_assoc_map_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.ceu_provider_assoc_map_id_seq OWNED BY public.ceu_provider_assoc_map.id;


--
-- Name: ceu_provider_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.ceu_provider_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: ceu_provider_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.ceu_provider_id_seq OWNED BY public.ceu_provider.id;


--
-- Name: course_types; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.course_types (
    id integer NOT NULL,
    title character varying,
    description character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: course_types_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.course_types_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: course_types_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.course_types_id_seq OWNED BY public.course_types.id;


--
-- Name: ecommerce; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ecommerce (
    id integer NOT NULL,
    player_id integer,
    franchise_id integer,
    xml_payload character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: ecommerce_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.ecommerce_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: ecommerce_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.ecommerce_id_seq OWNED BY public.ecommerce.id;


--
-- Name: global; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.global (
    id integer NOT NULL,
    great_plains_url character varying(255),
    great_plains_error_email character varying(255),
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: global_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.global_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: global_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.global_id_seq OWNED BY public.global.id;


--
-- Name: gp_log; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.gp_log (
    id integer NOT NULL,
    request text,
    response text,
    status character varying(10),
    msg character varying,
    upload_type character varying(25),
    actor character varying(25),
    player_id integer,
    product_id integer,
    franchise_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: gp_log_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.gp_log_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: gp_log_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.gp_log_id_seq OWNED BY public.gp_log.id;


--
-- Name: history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.history (
    id integer NOT NULL,
    msg character varying,
    actor character varying,
    player_id integer,
    franchise_id integer,
    quest_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    site_id character varying,
    action character varying,
    filename character varying(255),
    url character varying(255),
    hostname character varying(255),
    pid character varying(16),
    principal_id integer,
    ip_address character varying(15),
    assoc_id integer,
    instance character varying(16)
);


--
-- Name: history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.history_id_seq OWNED BY public.history.id;


--
-- Name: crm_log; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.crm_log (
    id integer NOT NULL,
    payload_id integer,
    player_id integer,
    quest_id integer,
    message text,
    status character varying(255),
    meeting_code character varying(255),
    player_number character varying(255),
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    order_number character varying(25)
);


--
-- Name: crm_log_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.crm_log_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: crm_log_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.crm_log_id_seq OWNED BY public.crm_log.id;


--
-- Name: crm_payload; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.crm_payload (
    id integer NOT NULL,
    payload text,
    status character varying(255),
    actor character varying(255),
    upload_type character varying(255),
    message text,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    error_count integer DEFAULT 0 NOT NULL
);


--
-- Name: crm_payload_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.crm_payload_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: crm_payload_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.crm_payload_id_seq OWNED BY public.crm_payload.id;


--
-- Name: instances; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.instances (
    instance_id character varying(255),
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: marketing_tiles; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.marketing_tiles (
    id integer NOT NULL,
    title character varying,
    file_path character varying,
    address character varying,
    pre_expire_days integer,
    description character varying,
    included character varying[],
    excluded character varying[],
    association_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    target character varying(8) DEFAULT '_self'::character varying,
    extension_sku integer,
    conditional_include character varying[]
);


--
-- Name: marketing_tiles_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.marketing_tiles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: marketing_tiles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.marketing_tiles_id_seq OWNED BY public.marketing_tiles.id;


--
-- Name: mceu; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.mceu (
    id integer NOT NULL,
    provider_id integer NOT NULL,
    parent_id integer NOT NULL,
    title character varying,
    other_provider character varying,
    speaker character varying,
    credits double precision,
    start_date date,
    end_date date,
    created timestamp without time zone DEFAULT now()
);


--
-- Name: mceu_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.mceu_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: mceu_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.mceu_id_seq OWNED BY public.mceu.id;


--
-- Name: player_details; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_details (
    id integer NOT NULL,
    player_id integer,
    address_1 character varying,
    address_2 character varying,
    designation character varying,
    job_title character varying,
    company_name character varying,
    player_number character varying,
    telephone1 character varying,
    mobile_phone character varying,
    fax character varying,
    postal_code character varying,
    country character varying,
    state character varying,
    city character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    telephone1_ext character varying(255),
    department character varying(255),
    opt_in boolean DEFAULT false,
    telephone2 character varying,
    telephone2_ext character varying
);


--
-- Name: player_details_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_details_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_details_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_details_id_seq OWNED BY public.player_details.id;


--
-- Name: player_emails_history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_emails_history (
    id integer NOT NULL,
    player_id integer,
    email_description character varying,
    email_type character varying,
    email_state character varying,
    email_content character varying,
    actor character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: player_emails_history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_emails_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_emails_history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_emails_history_id_seq OWNED BY public.player_emails_history.id;


--
-- Name: player_eula; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_eula (
    id integer NOT NULL,
    eula_id integer,
    state character varying(255),
    player_id integer,
    msg character varying,
    creator integer,
    created timestamp without time zone DEFAULT now(),
    accepted timestamp without time zone
);


--
-- Name: player_eula_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_eula_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_eula_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_eula_id_seq OWNED BY public.player_eula.id;


--
-- Name: player_login_sequence; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_login_sequence (
    id integer NOT NULL,
    login_sequence_name character varying,
    player_id integer,
    product_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    completed boolean DEFAULT true
);


--
-- Name: player_login_sequence_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_login_sequence_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_login_sequence_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_login_sequence_id_seq OWNED BY public.player_login_sequence.id;


--
-- Name: player_franchise_contact; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_franchise_contact (
    id integer NOT NULL,
    franchise_id integer,
    player_id integer,
    product_id integer,
    main boolean DEFAULT false,
    marketing boolean DEFAULT false,
    alternate boolean DEFAULT false,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: player_franchise_contact_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_franchise_contact_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_franchise_contact_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_franchise_contact_id_seq OWNED BY public.player_franchise_contact.id;


--
-- Name: player_franchise_rank; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.player_franchise_rank (
    id integer NOT NULL,
    association_id integer,
    franchise_id integer,
    player_id integer,
    rank integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: player_franchise_rank_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.player_franchise_rank_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: player_franchise_rank_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.player_franchise_rank_id_seq OWNED BY public.player_franchise_rank.id;


--
-- Name: players; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.players (
    id integer NOT NULL,
    player_id character varying,
    firstname character varying,
    middlename character varying,
    lastname character varying,
    email character varying,
    language character varying,
    phone character varying,
    comments character varying,
    user_id character varying,
    rand_key character varying,
    last_login timestamp without time zone,
    login_step character varying,
    notify character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    principal_id integer,
    employee_id character varying(255),
    login_count integer DEFAULT 0,
    current_state character varying(255),
    crm character varying(255),
    bio character varying
);


--
-- Name: players_bk; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.players_bk (
    id integer,
    player_id character varying,
    firstname character varying,
    middlename character varying,
    lastname character varying,
    email character varying,
    language character varying,
    phone character varying,
    comments character varying,
    user_id character varying,
    rand_key character varying,
    last_login timestamp without time zone,
    login_step character varying,
    notify character varying,
    created timestamp without time zone,
    modified timestamp without time zone,
    principal_id integer,
    employee_id character varying(255),
    login_count integer,
    current_state character varying(255),
    crm character varying(255),
    bio character varying
);


--
-- Name: players_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.players_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: players_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.players_id_seq OWNED BY public.players.id;


--
-- Name: players_licenses; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.players_licenses (
    id integer NOT NULL,
    player_id integer,
    franchise_id integer,
    product_id integer,
    product_code character varying,
    ecom boolean,
    error boolean,
    expires timestamp without time zone,
    free_product boolean,
    state character varying,
    substate character varying,
    rand_key character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    ecom_sku character varying,
    order_id character varying
);


--
-- Name: players_licenses_bk; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.players_licenses_bk (
    id integer,
    player_id integer,
    franchise_id integer,
    product_id integer,
    product_code character varying,
    ecom boolean,
    error boolean,
    expires timestamp without time zone,
    free_product boolean,
    state character varying,
    substate character varying,
    rand_key character varying,
    created timestamp without time zone,
    modified timestamp without time zone,
    ecom_sku character varying,
    order_id character varying
);


--
-- Name: players_licenses_duplicates; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.players_licenses_duplicates (
    id integer,
    modified character varying(255),
    player_id character varying(255),
    franchise_id character varying(255),
    product_id character varying(255)
);


--
-- Name: players_licenses_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.players_licenses_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: players_licenses_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.players_licenses_id_seq OWNED BY public.players_licenses.id;


--
-- Name: orders; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.orders (
    id integer NOT NULL,
    franchise_id integer,
    product_id integer,
    comment character varying,
    quantity character varying,
    "sellerId" character varying,
    order_id character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    ecom_sku character varying
);


--
-- Name: orders_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.orders_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: orders_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.orders_id_seq OWNED BY public.orders.id;


--
-- Name: franchise_courses; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_courses (
    id integer NOT NULL,
    franchise_id integer,
    product_id integer,
    url character varying,
    zip_codes character varying,
    marketing_flag boolean,
    enable boolean,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    virtual boolean
);


--
-- Name: franchise_courses_dups; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_courses_dups (
    id integer,
    franchise_id integer,
    product_id integer,
    url character varying,
    zip_codes character varying,
    marketing_flag boolean,
    enable boolean,
    created timestamp without time zone,
    modified timestamp without time zone,
    virtual boolean
);


--
-- Name: franchise_courses_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.franchise_courses_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: franchise_courses_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.franchise_courses_id_seq OWNED BY public.franchise_courses.id;


--
-- Name: franchise_gp; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_gp (
    id integer NOT NULL,
    gp_id character varying(255) NOT NULL,
    description character varying,
    franchise_id integer NOT NULL,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: franchise_gp_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.franchise_gp_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: franchise_gp_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.franchise_gp_id_seq OWNED BY public.franchise_gp.id;


--
-- Name: franchise_product_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_product_map (
    id integer NOT NULL,
    franchise_id integer,
    product_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: franchise_product_map_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.franchise_product_map_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: franchise_product_map_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.franchise_product_map_id_seq OWNED BY public.franchise_product_map.id;


--
-- Name: franchise_type; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_type (
    id integer NOT NULL,
    title character varying,
    group_id character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    principal_id integer
);


--
-- Name: franchise_type_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.franchise_type_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: franchise_type_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.franchise_type_id_seq OWNED BY public.franchise_type.id;


--
-- Name: franchise_type_old; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchise_type_old (
    id integer NOT NULL,
    title character varying,
    group_id character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: franchises; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.franchises (
    id integer NOT NULL,
    franchise_id character varying,
    group_id character varying,
    title character varying,
    description character varying,
    contactinfo character varying,
    "websiteURL" character varying,
    "franchiseCountry" character varying,
    "franchiseCity" character varying,
    "franchiseState" character varying,
    "franchiseAddress" character varying,
    "franchiseZip" character varying,
    "marketingZipCodes" character varying,
    "marketingURL" character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    address2 character varying,
    address3 character varying,
    franchise_type integer,
    principal_id integer,
    allow_virtual_instruction boolean DEFAULT false,
    ignore_inventory boolean DEFAULT false,
    assoc_franchise_type integer
);


--
-- Name: franchises_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.franchises_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: franchises_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.franchises_id_seq OWNED BY public.franchises.id;


--
-- Name: proctor; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.proctor (
    id integer NOT NULL,
    firstname character varying(50),
    lastname character varying(50),
    email character varying(50),
    company character varying(255),
    title character varying(50),
    phone character varying(50),
    relationship character varying(255),
    message character varying(255),
    invite_email_content character varying,
    invite_created timestamp without time zone,
    response_email_content character varying,
    response_created timestamp without time zone,
    status character varying(10),
    status_date timestamp without time zone DEFAULT now(),
    unlock_code character varying(255),
    rand_key character varying(255),
    actor character varying,
    player_id integer,
    quest_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: proctor_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.proctor_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: proctor_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.proctor_id_seq OWNED BY public.proctor.id;


--
-- Name: proctor_log; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.proctor_log (
    id integer NOT NULL,
    proctor_id integer,
    player_id integer,
    site_id character varying(255),
    exid character varying(255),
    msg character varying,
    action character varying(15),
    actor character varying,
    created timestamp without time zone,
    modified timestamp without time zone
);


--
-- Name: proctor_log_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.proctor_log_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: proctor_log_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.proctor_log_id_seq OWNED BY public.proctor_log.id;


--
-- Name: product_code_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.product_code_map (
    id integer NOT NULL,
    product_code character varying,
    product_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: product_code_map_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.product_code_map_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: product_code_map_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.product_code_map_id_seq OWNED BY public.product_code_map.id;


--
-- Name: product_kits; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.product_kits (
    id integer NOT NULL,
    kit_id integer,
    product_id integer,
    description character varying,
    exp_duration integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: product_kits_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.product_kits_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: product_kits_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.product_kits_id_seq OWNED BY public.product_kits.id;


--
-- Name: product_login_sequence; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.product_login_sequence (
    id integer NOT NULL,
    title character varying,
    description character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: product_login_sequence_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.product_login_sequence_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: product_login_sequence_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.product_login_sequence_id_seq OWNED BY public.product_login_sequence.id;


--
-- Name: product_login_sequence_step; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.product_login_sequence_step (
    id integer NOT NULL,
    login_sequence_id integer,
    url character varying,
    title character varying,
    description character varying,
    name character varying,
    number integer,
    contentpage boolean,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    language character varying(16)
);


--
-- Name: product_login_sequence_step_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.product_login_sequence_step_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: product_login_sequence_step_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.product_login_sequence_step_id_seq OWNED BY public.product_login_sequence_step.id;


--
-- Name: product_title_translation; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.product_title_translation (
    id integer NOT NULL,
    product_id integer,
    language character varying(16),
    title character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: product_title_translation_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.product_title_translation_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: product_title_translation_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.product_title_translation_id_seq OWNED BY public.product_title_translation.id;


--
-- Name: products; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.products (
    id integer NOT NULL,
    login_sequence_id integer,
    product_id character varying NOT NULL,
    product_title character varying,
    description character varying,
    product_url character varying DEFAULT ''::character varying,
    invite_view character varying,
    exp_duration integer,
    mapped_group character varying,
    product_version character varying,
    franchise_default boolean,
    learning_system boolean,
    ecommerce_product boolean DEFAULT false,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    ignore boolean,
    language character varying(16),
    individual_sale boolean,
    principal_id integer,
    send_ecom_receipt boolean DEFAULT true,
    set_expire_immediately boolean DEFAULT false,
    site_product character varying(255),
    product_order integer,
    image_url character varying(255),
    association_id integer,
    dsf_parent_id integer,
    requires_quest_enrollment boolean DEFAULT false,
    fr_product_title character varying,
    instructor_kit boolean DEFAULT false,
    learning_path_id character varying(255),
    use_lac_url boolean DEFAULT false,
    end_of_life timestamp without time zone,
    es_product_title character varying,
    certification_product boolean DEFAULT false,
    active boolean DEFAULT true,
    extension_grace_period integer,
    license_extension_only boolean,
    midterm_exurl character varying(255),
    final_exurl character varying(255),
    validate_user_data boolean DEFAULT true,
    requisite_products integer[],
    require_valid_requisite boolean DEFAULT false
);


--
-- Name: products_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.products_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: products_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.products_id_seq OWNED BY public.products.id;


--
-- Name: quest_types; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.quest_types (
    id integer NOT NULL,
    title character varying,
    description character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: quest_types_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.quest_types_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: quest_types_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.quest_types_id_seq OWNED BY public.quest_types.id;


--
-- Name: quests; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.quests (
    id integer NOT NULL,
    quest_id character varying,
    franchise_id integer,
    title character varying,
    description character varying,
    quest_type integer,
    course_type integer,
    college_credit boolean,
    closed boolean,
    est_player_count character varying,
    city character varying,
    state character varying,
    country character varying,
    "startDate" character varying,
    "endDate" character varying,
    comments character varying,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    group_id character varying,
    principal_id integer,
    access_by_quest_window boolean DEFAULT false,
    assoc_course_type integer,
    assoc_quest_type integer,
    max_player_count integer,
    mid_exstart character varying(255),
    mid_exend character varying(255),
    final_exstart character varying(255),
    final_exend character varying(255),
    language character varying(16),
    crm character varying(255),
    association_id integer
);


--
-- Name: quests_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.quests_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: quests_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.quests_id_seq OWNED BY public.quests.id;


--
-- Name: quests_req_lics; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.quests_req_lics (
    id integer NOT NULL,
    quest_id integer,
    product_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: quests_req_lics_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.quests_req_lics_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: quests_req_lics_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.quests_req_lics_id_seq OWNED BY public.quests_req_lics.id;


--
-- Name: templates; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.templates (
    id integer NOT NULL,
    association_id integer,
    body text,
    cls character varying(255),
    actor character varying(255),
    template_id character varying(255),
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    language character varying(10) DEFAULT NULL::character varying
);


--
-- Name: templates_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.templates_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: templates_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.templates_id_seq OWNED BY public.templates.id;


--
-- Name: assoc_fix; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.assoc_fix (
    id integer,
    player_id character varying,
    proper_assocs integer[],
    cur_assocs integer[]
);


--
-- Name: bloat; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.bloat AS
 SELECT sml.schemaname,
    sml.tablename,
    (sml.reltuples)::bigint AS reltuples,
    (sml.relpages)::bigint AS relpages,
    sml.otta,
    round(
        CASE
            WHEN (sml.otta = (0)::double precision) THEN 0.0
            ELSE ((sml.relpages)::numeric / (sml.otta)::numeric)
        END, 1) AS tbloat,
    (((sml.relpages)::bigint)::double precision - sml.otta) AS wastedpages,
    (sml.bs * ((((sml.relpages)::double precision - sml.otta))::bigint)::numeric) AS wastedbytes,
    pg_size_pretty((((sml.bs)::double precision * ((sml.relpages)::double precision - sml.otta)))::bigint) AS wastedsize,
    sml.iname,
    (sml.ituples)::bigint AS ituples,
    (sml.ipages)::bigint AS ipages,
    sml.iotta,
    round(
        CASE
            WHEN ((sml.iotta = (0)::double precision) OR (sml.ipages = 0)) THEN 0.0
            ELSE ((sml.ipages)::numeric / (sml.iotta)::numeric)
        END, 1) AS ibloat,
        CASE
            WHEN ((sml.ipages)::double precision < sml.iotta) THEN (0)::double precision
            ELSE (((sml.ipages)::bigint)::double precision - sml.iotta)
        END AS wastedipages,
        CASE
            WHEN ((sml.ipages)::double precision < sml.iotta) THEN (0)::double precision
            ELSE ((sml.bs)::double precision * ((sml.ipages)::double precision - sml.iotta))
        END AS wastedibytes,
        CASE
            WHEN ((sml.ipages)::double precision < sml.iotta) THEN pg_size_pretty((0)::bigint)
            ELSE pg_size_pretty((((sml.bs)::double precision * ((sml.ipages)::double precision - sml.iotta)))::bigint)
        END AS wastedisize
   FROM ( SELECT rs.schemaname,
            rs.tablename,
            cc.reltuples,
            cc.relpages,
            rs.bs,
            ceil(((cc.reltuples * (((((rs.datahdr + (rs.ma)::numeric) -
                CASE
                    WHEN ((rs.datahdr % (rs.ma)::numeric) = (0)::numeric) THEN (rs.ma)::numeric
                    ELSE (rs.datahdr % (rs.ma)::numeric)
                END))::double precision + rs.nullhdr2) + (4)::double precision)) / ((rs.bs)::double precision - (20)::double precision))) AS otta,
            COALESCE(c2.relname, '?'::name) AS iname,
            COALESCE(c2.reltuples, (0)::real) AS ituples,
            COALESCE(c2.relpages, 0) AS ipages,
            COALESCE(ceil(((c2.reltuples * ((rs.datahdr - (12)::numeric))::double precision) / ((rs.bs)::double precision - (20)::double precision))), (0)::double precision) AS iotta
           FROM ((((( SELECT foo.ma,
                    foo.bs,
                    foo.schemaname,
                    foo.tablename,
                    ((foo.datawidth + (((foo.hdr + foo.ma) -
                        CASE
                            WHEN ((foo.hdr % foo.ma) = 0) THEN foo.ma
                            ELSE (foo.hdr % foo.ma)
                        END))::double precision))::numeric AS datahdr,
                    (foo.maxfracsum * (((foo.nullhdr + foo.ma) -
                        CASE
                            WHEN ((foo.nullhdr % (foo.ma)::bigint) = 0) THEN (foo.ma)::bigint
                            ELSE (foo.nullhdr % (foo.ma)::bigint)
                        END))::double precision) AS nullhdr2
                   FROM ( SELECT s.schemaname,
                            s.tablename,
                            constants.hdr,
                            constants.ma,
                            constants.bs,
                            sum((((1)::double precision - s.null_frac) * (s.avg_width)::double precision)) AS datawidth,
                            max(s.null_frac) AS maxfracsum,
                            (constants.hdr + ( SELECT (1 + (count(*) / 8))
                                   FROM pg_stats s2
                                  WHERE ((s2.null_frac <> (0)::double precision) AND (s2.schemaname = s.schemaname) AND (s2.tablename = s.tablename)))) AS nullhdr
                           FROM pg_stats s,
                            ( SELECT ( SELECT (current_setting('block_size'::text))::numeric AS current_setting) AS bs,
CASE
 WHEN ("substring"(foo_1.v, 12, 3) = ANY (ARRAY['8.0'::text, '8.1'::text, '8.2'::text])) THEN 27
 ELSE 23
END AS hdr,
CASE
 WHEN (foo_1.v ~ 'mingw32'::text) THEN 8
 ELSE 4
END AS ma
                                   FROM ( SELECT version() AS v) foo_1) constants
                          GROUP BY s.schemaname, s.tablename, constants.hdr, constants.ma, constants.bs) foo) rs
             JOIN pg_class cc ON ((cc.relname = rs.tablename)))
             JOIN pg_namespace nn ON (((cc.relnamespace = nn.oid) AND (nn.nspname = rs.schemaname))))
             LEFT JOIN pg_index i ON ((i.indrelid = cc.oid)))
             LEFT JOIN pg_class c2 ON ((c2.oid = i.indexrelid)))) sml
  WHERE ((((sml.relpages)::double precision - sml.otta) > (0)::double precision) OR (((sml.ipages)::double precision - sml.iotta) > (10)::double precision))
  ORDER BY (sml.bs * ((((sml.relpages)::double precision - sml.otta))::bigint)::numeric) DESC,
        CASE
            WHEN ((sml.ipages)::double precision < sml.iotta) THEN (0)::double precision
            ELSE ((sml.bs)::double precision * ((sml.ipages)::double precision - sml.iotta))
        END DESC;


--
-- Name: code_profile; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.code_profile (
    id integer NOT NULL,
    package character varying,
    class character varying,
    function character varying,
    url character varying,
    actor character varying,
    lifespan double precision,
    hostname character varying,
    transaction character varying,
    layer integer,
    pid integer,
    created timestamp without time zone DEFAULT now(),
    instance character varying(255)
);


--
-- Name: code_profile_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.code_profile_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: code_profile_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.code_profile_id_seq OWNED BY public.code_profile.id;


--
-- Name: content; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.content (
    content_id integer NOT NULL,
    id character varying(256) NOT NULL,
    uid character varying(36) NOT NULL,
    portal_type character varying(64),
    status character varying(64),
    type character varying(64),
    container_id integer,
    path text,
    title text DEFAULT ''::text,
    description text DEFAULT ''::text,
    subject text,
    location text,
    contributors text,
    creators text,
    creation_date timestamp without time zone DEFAULT now(),
    modification_date timestamp without time zone DEFAULT now(),
    effectivedate timestamp without time zone,
    expirationdate timestamp without time zone,
    language text,
    rights text,
    format character varying(64) DEFAULT 'text/html'::character varying,
    excludefromnav boolean,
    allowdiscussion boolean,
    posincontainer integer DEFAULT 0,
    translation_source integer,
    okforuse boolean DEFAULT true NOT NULL,
    hidekids boolean DEFAULT false NOT NULL
);


--
-- Name: content_content_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.content_content_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: content_content_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.content_content_id_seq OWNED BY public.content.content_id;


--
-- Name: credentials; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.credentials (
    id integer NOT NULL,
    name character varying(10)
);


--
-- Name: credentials_assoc; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.credentials_assoc (
    mailinglist_id integer,
    credentials_id integer
);


--
-- Name: credentials_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.credentials_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: credentials_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.credentials_id_seq OWNED BY public.credentials.id;


--
-- Name: customer_care_contact; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.customer_care_contact (
    id integer NOT NULL,
    title character varying,
    internal_title character varying,
    language character varying,
    roles character varying[],
    product_ids integer[],
    association_id integer,
    display_order integer,
    email character varying,
    telephone1 character varying,
    all_users boolean,
    fax character varying,
    postal_code character varying,
    country character varying,
    state character varying,
    city character varying,
    address_1 character varying,
    address_2 character varying,
    address_3 character varying,
    created_by integer,
    modified_by integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: customer_care_contact_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.customer_care_contact_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: customer_care_contact_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.customer_care_contact_id_seq OWNED BY public.customer_care_contact.id;


--
-- Name: eula; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.eula (
    id integer NOT NULL,
    active boolean,
    short_name character varying(255),
    title character varying(255),
    body character varying,
    refusal_msg character varying(1024),
    lang character varying(16),
    all_users_must_accept boolean,
    new_product_reaccept boolean,
    roles character varying(255)[],
    association_id integer,
    parent_eula_id integer,
    display_order integer,
    creator integer,
    modified_by integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    ignore_existing_activated boolean DEFAULT true
);


--
-- Name: eula_history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.eula_history (
    id integer NOT NULL,
    actor character varying(255),
    action character varying(255),
    principal_id integer,
    association_id integer,
    body_diff character varying,
    eula_id integer,
    msg character varying,
    created timestamp without time zone DEFAULT now()
);


--
-- Name: eula_history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.eula_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: eula_history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.eula_history_id_seq OWNED BY public.eula_history.id;


--
-- Name: eula_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.eula_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: eula_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.eula_id_seq OWNED BY public.eula.id;


--
-- Name: eula_product; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.eula_product (
    eula_id integer,
    product_id integer
);


--
-- Name: files; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.files (
    id integer NOT NULL,
    content_id integer,
    attribute character varying(156),
    type character varying(30),
    content bytea,
    path character varying(300),
    size integer,
    checksum character varying(33),
    file_name character varying(156),
    mime_type character varying(80)
);


--
-- Name: files_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.files_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: files_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.files_id_seq OWNED BY public.files.id;


--
-- Name: history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.history (
    id integer NOT NULL,
    franchise_id integer,
    matches integer DEFAULT 0,
    "timestamp" timestamp without time zone DEFAULT now(),
    association_id integer,
    product_id integer,
    filename character varying(50),
    actor character varying,
    action character varying(255)
);


--
-- Name: history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.history_id_seq OWNED BY public.history.id;


--
-- Name: ifma_prd_map; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.ifma_prd_map (
    v1_pid integer,
    v2_pid integer
);


--
-- Name: login_flood_counter; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.login_flood_counter (
    player_id integer NOT NULL,
    login_count integer,
    last_login timestamp without time zone
);


--
-- Name: mailinglist; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.mailinglist (
    id integer NOT NULL,
    added timestamp with time zone,
    updated timestamp with time zone,
    first character varying(25),
    last character varying(25),
    display character varying(80),
    title character varying(255),
    company character varying(50),
    address1 character varying(80),
    address2 character varying(25),
    address3 character varying(25),
    city character varying(25),
    state character varying(25),
    zipcode character varying(10),
    email character varying(80),
    association_id integer,
    product_id integer
);


--
-- Name: mailinglist_history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.mailinglist_history (
    id integer NOT NULL,
    franchise_id integer,
    matches integer,
    "timestamp" timestamp without time zone DEFAULT now(),
    association_id integer,
    product_id integer,
    filename character varying(50),
    actor character varying,
    action character varying(255),
    mailinglist_id integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: mailinglist_history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.mailinglist_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: mailinglist_history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.mailinglist_history_id_seq OWNED BY public.mailinglist_history.id;


--
-- Name: mailinglist_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.mailinglist_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: mailinglist_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.mailinglist_id_seq OWNED BY public.mailinglist.id;


--
-- Name: matches; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.matches (
    mailinglist_id character varying,
    matches text,
    product_id integer,
    zip integer
);


--
-- Name: media; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.media (
    content_id integer NOT NULL,
    filename character varying(255),
    mime_type character varying(255),
    width integer,
    height integer,
    playtime interval
);


--
-- Name: playerdata; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.playerdata (
    id integer NOT NULL,
    fullname character varying(255),
    email character varying(255),
    home_page character varying(255),
    portal_skin character varying(60),
    location character varying(255),
    description text,
    language character varying(40),
    wysiwyg_editor character varying(40),
    listed boolean,
    visible_ids boolean,
    ext_editor boolean,
    login_time timestamp without time zone,
    last_login_time timestamp without time zone,
    firstname character varying(127),
    lastname character varying(127),
    phone character varying(60)
);


--
-- Name: oauth2_client; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_client (
    id integer NOT NULL,
    association_id integer,
    title character varying(255),
    client_id character varying(255),
    comment character varying,
    authorization_uri character varying(255),
    error_threshold_value integer,
    error_threshold_metric character varying,
    error_email_sent timestamp without time zone,
    contact_email character varying,
    email_interval integer,
    redirect_uri character varying(255),
    active boolean,
    creator integer,
    modified_by integer,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    owner integer[],
    contact_phone character varying(255),
    contact_person character varying(16),
    success_uri character varying(255)
);


--
-- Name: oauth2_client_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_client_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_client_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_client_id_seq OWNED BY public.oauth2_client.id;


--
-- Name: oauth2_client_user; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_client_user (
    id integer NOT NULL,
    client_id integer,
    remote_user_id character varying(255),
    principal_id integer,
    creator integer,
    association_id integer,
    active boolean,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now()
);


--
-- Name: oauth2_client_user_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_client_user_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_client_user_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_client_user_id_seq OWNED BY public.oauth2_client_user.id;


--
-- Name: oauth2_email; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_email (
    id integer NOT NULL,
    recipient character varying,
    errors_since_last_email integer,
    client_id integer,
    sent boolean,
    record_id integer,
    error_id integer,
    association_id integer,
    created timestamp without time zone DEFAULT now()
);


--
-- Name: oauth2_email_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_email_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_email_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_email_id_seq OWNED BY public.oauth2_email.id;


--
-- Name: oauth2_error; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_error (
    id integer NOT NULL,
    client_id integer,
    client_user_id integer,
    record_id integer,
    association_id integer,
    error character varying(255),
    error_description character varying,
    created timestamp without time zone DEFAULT now(),
    hostname character varying(255),
    pid character varying(16)
);


--
-- Name: oauth2_error_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_error_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_error_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_error_id_seq OWNED BY public.oauth2_error.id;


--
-- Name: oauth2_history; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_history (
    id integer NOT NULL,
    actor character varying(255),
    action character varying(255),
    association_id integer,
    principal_id integer,
    record_id integer,
    client_id integer,
    msg character varying,
    created timestamp without time zone DEFAULT now()
);


--
-- Name: oauth2_history_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_history_id_seq OWNED BY public.oauth2_history.id;


--
-- Name: oauth2_record; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.oauth2_record (
    id integer NOT NULL,
    client_id integer,
    client_user_id integer,
    redirect_uri character varying(255),
    state character varying(255),
    code_challenge character varying(255),
    code_challenge_method character varying(255),
    association_id integer,
    authorization_code character varying(255),
    access_token character varying(255),
    authorization_code_expires integer,
    access_token_created timestamp without time zone,
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    hostname character varying(255),
    pid character varying(16)
);


--
-- Name: oauth2_record_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.oauth2_record_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: oauth2_record_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.oauth2_record_id_seq OWNED BY public.oauth2_record.id;


--
-- Name: principal_top_role; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.principal_top_role (
    principal_id integer NOT NULL,
    top_role character varying,
    roles text[]
);


--
-- Name: principalrole; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.principalrole (
    principal_id integer NOT NULL,
    role_id integer NOT NULL
);


--
-- Name: principals; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.principals (
    id integer NOT NULL,
    type character varying(64),
    name character varying(255),
    association character varying(255),
    product character varying(255)
);


--
-- Name: principals_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.principals_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: principals_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.principals_id_seq OWNED BY public.principals.id;


--
-- Name: proctor_provider; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.proctor_provider (
    id integer NOT NULL,
    association_id integer,
    name character varying(255),
    username character varying(255),
    password character varying(255),
    host character varying(255),
    sso_url character varying(255),
    client_id character varying(255),
    created timestamp without time zone DEFAULT now(),
    modified timestamp without time zone DEFAULT now(),
    instructor_id character varying(255)
);


--
-- Name: proctor_provider_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.proctor_provider_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: proctor_provider_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.proctor_provider_id_seq OWNED BY public.proctor_provider.id;


--
-- Name: relations; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.relations (
    source_id integer NOT NULL,
    target_id integer NOT NULL,
    relationship character varying(128) NOT NULL
);


--
-- Name: roles; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.roles (
    id integer NOT NULL,
    name character varying(255),
    association character varying(255),
    product character varying(255)
);


--
-- Name: roles_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: roles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.roles_id_seq OWNED BY public.roles.id;


--
-- Name: sso; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.sso (
    id integer NOT NULL,
    secret bytea
);


--
-- Name: sso_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.sso_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: sso_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.sso_id_seq OWNED BY public.sso.id;


--
-- Name: usergroup; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.usergroup (
    principal_id integer NOT NULL,
    group_id integer NOT NULL
);


--
-- Name: users; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.users (
    id integer NOT NULL,
    login character varying(255),
    password_hash character varying(48),
    password_salt character varying(48),
    password_hashtype character varying(8) DEFAULT 'MD5'::character varying
);


--
-- Name: versionlog; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.versionlog (
    id bigint NOT NULL,
    ts timestamp without time zone DEFAULT now(),
    modtype character varying(6),
    usr character varying(40),
    tbl character varying(40),
    pkname character varying(40),
    pkvalue integer,
    fld character varying(40),
    oldval text,
    newval text
);


--
-- Name: versionlog_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.versionlog_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: versionlog_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.versionlog_id_seq OWNED BY public.versionlog.id;


--
-- Name: vproperties; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.vproperties (
    id integer NOT NULL,
    type character varying(20),
    key character varying(20) NOT NULL,
    strval text,
    datetimeval timestamp without time zone,
    boolval boolean,
    intval integer,
    floatval double precision
);


--
-- Name: vw_code_profile; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_code_profile AS
 SELECT code.package,
    code.class,
    code.function,
    count(code.*) AS count,
    min(code.lifespan) AS min,
    avg(code.lifespan) AS avg,
    max(code.lifespan) AS max
   FROM public.code_profile code
  GROUP BY code.package, code.class, code.function;


--
-- Name: vw_eula; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_eula AS
 SELECT eula.id,
    eula.display_order,
    eula.short_name,
    eula.title,
    eula.lang,
    eula.active,
    eula.association_id,
    eula.roles,
    eula.created,
    eula.modified,
    eula.new_product_reaccept,
    eula.ignore_existing_activated,
    eula.all_users_must_accept,
    ( SELECT DISTINCT count(ame.player_id) AS count
           FROM public.player_eula ame
          WHERE ((ame.eula_id = eula.id) AND ((ame.state)::text = 'viewed'::text))) AS viewed_count,
    ( SELECT DISTINCT count(ame2.player_id) AS count
           FROM public.player_eula ame2
          WHERE ((ame2.eula_id = eula.id) AND ((ame2.state)::text = 'accepted'::text))) AS accepted_count,
    _uc.login AS creator,
    _um.login AS modifier
   FROM ((public.eula
     JOIN public.users _uc ON ((_uc.id = eula.creator)))
     JOIN public.users _um ON ((_um.id = eula.modified_by)))
  ORDER BY eula.title;


--
-- Name: vw_gp_log; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_gp_log AS
 SELECT log.id,
    log.request,
    log.response,
    log.msg,
    log.status,
    log.upload_type,
    log.actor,
    mem.player_id,
    prd.product_id,
    prd.association_id,
    ptnr.franchise_id,
    prd.product_title,
    (((mem.lastname)::text || ', '::text) || (mem.firstname)::text) AS listname,
    ptnr.title AS franchise_title,
    log.created,
    log.modified
   FROM (((public.gp_log log
     LEFT JOIN public.players mem ON ((mem.id = log.player_id)))
     LEFT JOIN public.franchises ptnr ON ((ptnr.id = log.franchise_id)))
     LEFT JOIN public.products prd ON ((prd.id = log.product_id)))
  GROUP BY log.id, log.request, log.response, log.msg, log.status, log.upload_type, log.actor, mem.player_id, ptnr.franchise_id, prd.product_id, prd.association_id, ptnr.title, prd.product_title, (((mem.lastname)::text || ', '::text) || (mem.firstname)::text), log.created, log.modified;


--
-- Name: vw_crm_log; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_crm_log AS
 SELECT log.id,
    log.quest_id AS quest_int_id,
    log.payload_id,
    log.status,
    log.message,
    log.meeting_code,
    log.player_number,
    log.order_number,
    log.player_id,
    mem.player_id AS player_str_id,
    (((mem.lastname)::text || ', '::text) || (mem.firstname)::text) AS listname,
    mem.lastname,
    mem.firstname,
    ses.franchise_id AS franchise_int_id,
    ses.quest_id,
    ses.title AS quest_title,
    ptnr.franchise_id,
    log.created
   FROM (((public.crm_log log
     LEFT JOIN public.players mem ON ((mem.id = log.player_id)))
     LEFT JOIN public.quests ses ON ((ses.id = log.quest_id)))
     LEFT JOIN public.franchises ptnr ON ((ptnr.id = ses.franchise_id)))
  GROUP BY log.id, ses.franchise_id, log.quest_id, log.created, log.payload_id, log.status, log.message, log.meeting_code, log.player_number, log.order_number, log.player_id, mem.player_id, mem.lastname, mem.firstname, ses.quest_id, ses.title, ptnr.franchise_id;


--
-- Name: vw_player_last_state; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_player_last_state AS
 SELECT mem.player_id,
    ast.activation_title,
    actd.modified,
    mem.principal_id
   FROM ((public.players mem
     RIGHT JOIN public.activation_details actd ON ((actd.player_id = mem.id)))
     JOIN public.activation_states ast ON ((ast.id = actd.activation_id)))
  WHERE (actd.id = ( SELECT max(activation_details.id) AS max
           FROM public.activation_details
          WHERE (activation_details.player_id = mem.id)))
  GROUP BY mem.id, mem.player_id, ast.activation_title, actd.activation_id, actd.modified, mem.principal_id
  ORDER BY mem.player_id;


--
-- Name: vw_player_listing; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.vw_player_listing (
    id integer NOT NULL,
    player_id character varying,
    firstname character varying,
    lastname character varying,
    email character varying,
    principal_id character varying,
    login_id character varying,
    top_role character varying,
    roles character varying,
    products character varying,
    franchises character varying,
    "activationState" character varying
);


--
-- Name: vw_player_listing_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.vw_player_listing_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: vw_player_listing_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.vw_player_listing_id_seq OWNED BY public.vw_player_listing.id;


--
-- Name: vw_player_franchise_quests_grid; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_player_franchise_quests_grid AS
 SELECT ptnr.id AS franchise_id,
    mem.id AS player_id,
    sess.id AS int_quest_id,
    sess.quest_id,
    sess.title AS quest_title,
    sess.closed,
    sess.association_id AS assoc_id,
    ARRAY( SELECT products.product_title
           FROM public.products
          WHERE ((products.id IN ( SELECT quests_req_lics.product_id
                   FROM public.quests_req_lics
                  WHERE (quests_req_lics.quest_id = sess.id))) AND (NOT (products.id IN ( SELECT products_1.id
                   FROM public.products products_1
                  WHERE (products_1.id IN ( SELECT players_licenses.product_id
                           FROM public.players_licenses
                          WHERE (players_licenses.player_id = mem.id)))))))) AS missing_products,
    ARRAY( SELECT products.product_title
           FROM public.products
          WHERE (products.id IN ( SELECT quests_req_lics.product_id
                   FROM public.quests_req_lics
                  WHERE (quests_req_lics.quest_id = sess.id)))) AS required_products,
    ( SELECT count(*) AS count
           FROM public.usergroup
          WHERE ((usergroup.group_id = sess.principal_id) AND (usergroup.principal_id = mem.principal_id))) AS quest_player
   FROM (((public.quests sess
     LEFT JOIN public.franchises ptnr ON ((ptnr.id = sess.franchise_id)))
     JOIN public.usergroup ug ON ((ug.group_id = ptnr.principal_id)))
     LEFT JOIN public.players mem ON ((mem.principal_id = ug.principal_id)))
  GROUP BY ptnr.id, mem.id, sess.id, sess.quest_id, sess.principal_id, sess.closed, mem.principal_id, sess.title, ptnr.title, sess.association_id;


--
-- Name: vw_orphan_users; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_orphan_users AS
 SELECT users.id,
    users.login,
    users.password_hash,
    users.password_salt,
    users.password_hashtype
   FROM public.users
  WHERE (users.id IN ( SELECT users_1.id
           FROM (public.users users_1
             LEFT JOIN public.players mem ON ((mem.principal_id = users_1.id)))
        EXCEPT
         SELECT users_1.id
           FROM (public.users users_1
             RIGHT JOIN public.players mem ON ((mem.principal_id = users_1.id)))));


--
-- Name: vw_franchise_details; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_franchise_details AS
SELECT
    NULL::integer AS id,
    NULL::character varying AS franchise_id,
    NULL::boolean AS ignore_inventory,
    NULL::boolean AS allow_virtual_instruction,
    NULL::character varying AS title,
    NULL::character varying AS description,
    NULL::character varying AS city,
    NULL::character varying AS state,
    NULL::character varying AS country,
    NULL::character varying AS contactinfo,
    NULL::character varying AS franchise_type,
    NULL::integer AS franchise_type_id,
    NULL::integer AS principal_id,
    NULL::character varying(255) AS gp_id,
    NULL::character varying AS association_str,
    NULL::integer AS association_id,
    NULL::integer[] AS assocs,
    NULL::bigint AS total_users,
    NULL::bigint AS assoc_users,
    NULL::bigint AS open_quests,
    NULL::bigint AS closed_quests,
    NULL::timestamp without time zone AS created;


--
-- Name: vw_franchise_inventory; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_franchise_inventory AS
SELECT
    NULL::character varying AS franchise_title,
    NULL::integer AS ptnr_id,
    NULL::character varying AS product_id,
    NULL::character varying AS p_product_id,
    NULL::character varying AS p_product_title,
    NULL::integer AS p_id,
    NULL::character varying AS product_title,
    NULL::character varying AS product_version,
    NULL::boolean AS individual_sale,
    NULL::integer AS assoc_id,
    NULL::bigint AS ordered,
    NULL::bigint AS consumed,
    NULL::bigint AS inventory,
    NULL::boolean AS is_kit,
    NULL::boolean AS has_sale_parts;


--
-- Name: vw_franchise_players_summary; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.vw_franchise_players_summary (
    franchise_id integer,
    id integer NOT NULL,
    assoc_id integer,
    player_id character varying,
    login_id character varying,
    firstname character varying,
    lastname character varying,
    email character varying,
    roles character varying,
    role character varying,
    account_state character varying,
    license_titles character varying
);


--
-- Name: vw_franchise_summary; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_franchise_summary AS
 SELECT ptnr.id AS franchise_id,
    ptnr.title AS franchise_title,
    ptnr.principal_id AS p_principal_id,
    amp.association_id AS assoc_id,
    ( SELECT count(association_map.id) AS count
           FROM public.association_map
          WHERE ((association_map.association_id = amp.association_id) AND (association_map.player_id IN ( SELECT players.id
                   FROM public.players
                  WHERE (players.principal_id IN ( SELECT usergroup.principal_id
                           FROM public.usergroup
                          WHERE (usergroup.group_id = ptnr.principal_id))))))) AS player_count,
    ( SELECT count(orders.id) AS count
           FROM public.orders
          WHERE ((orders.franchise_id = ptnr.id) AND (orders.product_id IN ( SELECT products.id
                   FROM public.products
                  WHERE (products.association_id = amp.association_id))))) AS order_count,
    ( SELECT sum((orders.quantity)::integer) AS sum
           FROM public.orders
          WHERE ((orders.franchise_id = ptnr.id) AND (orders.product_id IN ( SELECT products.id
                   FROM public.products
                  WHERE (products.association_id = amp.association_id))))) AS lic_count,
    ( SELECT count(quests.id) AS count
           FROM public.quests
          WHERE ((quests.association_id = amp.association_id) AND (quests.franchise_id = ptnr.id) AND (quests.closed <> true))) AS quest_count,
    ARRAY( SELECT products.product_title
           FROM public.products
          WHERE (products.id IN ( SELECT franchise_courses.product_id
                   FROM public.franchise_courses
                  WHERE ((franchise_courses.franchise_id = ptnr.id) AND (franchise_courses.enable = true) AND (franchise_courses.product_id IN ( SELECT products_1.id
                           FROM public.products products_1
                          WHERE (products_1.association_id = amp.association_id))))))) AS available_products
   FROM (((((((public.franchises ptnr
     JOIN public.principals ON ((ptnr.principal_id = principals.id)))
     LEFT JOIN public.association_map amp ON ((ptnr.id = amp.franchise_id)))
     LEFT JOIN public.associations assoc ON ((assoc.id = amp.association_id)))
     LEFT JOIN public.players mem ON ((mem.id = amp.player_id)))
     LEFT JOIN public.orders ordr ON ((ordr.franchise_id = ptnr.id)))
     LEFT JOIN public.products pd ON (((pd.id = amp.product_id) AND (pd.id = ordr.product_id))))
     LEFT JOIN public.quests sess ON (((sess.id = amp.quest_id) AND (sess.franchise_id = ptnr.id))))
  GROUP BY amp.association_id, ptnr.id, ptnr.title, ptnr.principal_id, sess.id, ordr.franchise_id;


--
-- Name: vw_product_details; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_product_details AS
SELECT
    NULL::integer AS id,
    NULL::character varying AS product_id,
    NULL::boolean AS active,
    NULL::character varying AS product_title,
    NULL::character varying AS description,
    NULL::character varying AS invite_view,
    NULL::character varying AS product_url,
    NULL::character varying(255) AS midterm_exurl,
    NULL::character varying(255) AS final_exurl,
    NULL::character varying AS product_version,
    NULL::integer AS product_order,
    NULL::integer AS exp_duration,
    NULL::character varying AS mapped_group,
    NULL::boolean AS individual_sale,
    NULL::integer[] AS requisite_products,
    NULL::boolean AS require_valid_requisite,
    NULL::boolean AS validate_user_data,
    NULL::boolean AS license_extension_only,
    NULL::integer AS extension_grace_period,
    NULL::boolean AS use_lac_url,
    NULL::timestamp without time zone AS end_of_life,
    NULL::boolean AS requires_quest_enrollment,
    NULL::integer AS dsf_parent_id,
    NULL::character varying(255) AS learning_path_id,
    NULL::integer AS association_id,
    NULL::boolean AS ecommerce_product,
    NULL::boolean AS certification_product,
    NULL::character varying AS association_str,
    NULL::character varying AS association_url,
    NULL::timestamp without time zone AS created,
    NULL::bigint AS ordered,
    NULL::bigint AS franchises,
    NULL::bigint AS enabled_franchises,
    NULL::bigint AS quests,
    NULL::bigint AS open_quests,
    NULL::bigint AS closed_quests,
    NULL::bigint AS consumed,
    NULL::bigint AS expired,
    NULL::bigint AS unexpired,
    NULL::bigint AS activated,
    NULL::bigint AS invited,
    NULL::bigint AS ignored_orders,
    NULL::bigint AS total_orders,
    NULL::bigint AS consumed_from_franchise,
    NULL::bigint AS consumed_individually,
    NULL::bigint AS consumed_from_ecom,
    NULL::bigint AS actual_inventory;


--
-- Name: vw_quest_avail_players; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.vw_quest_avail_players (
    firstname character varying,
    lastname character varying,
    email character varying,
    roles character varying,
    top_role character varying,
    player_id character varying NOT NULL,
    quest_id integer,
    franchise_id integer,
    assoc_id integer,
    missing_products character varying,
    other_quests character varying
);


--
-- Name: vw_quest_cur_players; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_quest_cur_players AS
 SELECT mem.firstname,
    mem.lastname,
    mem.player_id,
    mem.id AS mem_id,
    ARRAY( SELECT public.fn_all_roles(mem.principal_id) AS fn_all_roles) AS roles,
    sess.id AS quest_id,
    ptnr.id AS franchise_id
   FROM ((((public.players mem
     JOIN public.principals prin ON ((prin.id = mem.principal_id)))
     JOIN public.usergroup ug ON ((ug.principal_id = mem.principal_id)))
     JOIN public.quests sess ON ((ug.group_id = sess.principal_id)))
     JOIN public.franchises ptnr ON ((ptnr.id = sess.franchise_id)))
  GROUP BY sess.id, mem.firstname, mem.lastname, mem.player_id, mem.principal_id, ptnr.id, mem.id
  ORDER BY mem.lastname, mem.firstname;


--
-- Name: vw_quest_details; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_quest_details AS
SELECT
    NULL::integer AS franchise_id,
    NULL::character varying AS franchise_title,
    NULL::character varying AS str_franchise_id,
    NULL::character varying AS ptnr_description,
    NULL::character varying AS ptnr_city,
    NULL::character varying AS ptnr_state,
    NULL::character varying AS ptnr_country,
    NULL::integer AS id,
    NULL::character varying AS quest_id,
    NULL::character varying AS title,
    NULL::character varying(16) AS language,
    NULL::character varying(255) AS crm,
    NULL::bigint AS user_count,
    NULL::integer AS principal_id,
    NULL::character varying AS description,
    NULL::integer AS quest_type_id,
    NULL::character varying(255) AS quest_type,
    NULL::character varying(255) AS learning_path_id,
    NULL::integer AS course_type_id,
    NULL::character varying(255) AS course_type,
    NULL::integer AS franchise_type_id,
    NULL::character varying AS franchise_type,
    NULL::boolean AS closed,
    NULL::character varying AS est_player_count,
    NULL::character varying AS city,
    NULL::character varying AS state,
    NULL::character varying AS country,
    NULL::character varying AS comments,
    NULL::character varying AS "startDate",
    NULL::character varying AS "endDate",
    NULL::character varying AS group_id,
    NULL::timestamp without time zone AS modified,
    NULL::integer AS assoc_id,
    NULL::character varying[] AS required_pids,
    NULL::character varying[] AS required_products,
    NULL::text AS location,
    NULL::timestamp without time zone AS created;


--
-- Name: vw_tmp_quest_details; Type: VIEW; Schema: public; Owner: -
--

CREATE VIEW public.vw_tmp_quest_details AS
SELECT
    NULL::integer AS franchise_id,
    NULL::character varying AS franchise_title,
    NULL::character varying AS str_franchise_id,
    NULL::character varying AS ptnr_description,
    NULL::character varying AS ptnr_city,
    NULL::character varying AS ptnr_state,
    NULL::character varying AS ptnr_country,
    NULL::integer AS id,
    NULL::character varying AS quest_id,
    NULL::character varying AS title,
    NULL::boolean AS access_by_quest_window,
    NULL::character varying(16) AS language,
    NULL::character varying(255) AS crm,
    NULL::bigint AS user_count,
    NULL::integer AS principal_id,
    NULL::character varying AS description,
    NULL::integer AS quest_type_id,
    NULL::character varying(255) AS quest_type,
    NULL::integer AS course_type_id,
    NULL::character varying(255) AS course_type,
    NULL::integer AS franchise_type_id,
    NULL::character varying AS franchise_type,
    NULL::boolean AS closed,
    NULL::character varying AS est_player_count,
    NULL::character varying AS city,
    NULL::character varying AS state,
    NULL::character varying AS country,
    NULL::character varying AS comments,
    NULL::character varying AS "startDate",
    NULL::character varying AS "endDate",
    NULL::character varying AS group_id,
    NULL::timestamp without time zone AS modified,
    NULL::integer AS assoc_id,
    NULL::character varying[] AS required_pids,
    NULL::character varying[] AS required_products,
    NULL::text AS location;


--
-- Name: workflow_entry; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.workflow_entry (
    wfe_id integer NOT NULL,
    wf_id integer NOT NULL,
    action character varying(64),
    review_state character varying(64),
    actor character varying(255),
    comments text DEFAULT ''::text,
    "time" timestamp without time zone DEFAULT now()
);


--
-- Name: workflow_entry_wfe_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.workflow_entry_wfe_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: workflow_entry_wfe_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.workflow_entry_wfe_id_seq OWNED BY public.workflow_entry.wfe_id;


--
-- Name: workflowhistory; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.workflowhistory (
    wf_id integer NOT NULL,
    content_id integer NOT NULL,
    name character varying(128) DEFAULT ''::character varying
);


--
-- Name: workflowhistory_wf_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

CREATE SEQUENCE public.workflowhistory_wf_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- Name: workflowhistory_wf_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: -
--

ALTER SEQUENCE public.workflowhistory_wf_id_seq OWNED BY public.workflowhistory.wf_id;


--
-- Name: activation_details id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_details ALTER COLUMN id SET DEFAULT nextval('public.activation_details_id_seq'::regclass);


--
-- Name: activation_states id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_states ALTER COLUMN id SET DEFAULT nextval('public.activation_states_id_seq'::regclass);


--
-- Name: assoc_course_types id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_course_types ALTER COLUMN id SET DEFAULT nextval('public.assoc_course_types_id_seq'::regclass);


--
-- Name: assoc_quest_types id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_quest_types ALTER COLUMN id SET DEFAULT nextval('public.assoc_quest_types_id_seq'::regclass);


--
-- Name: association_map id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map ALTER COLUMN id SET DEFAULT nextval('public.association_map_id_seq'::regclass);


--
-- Name: associations id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.associations ALTER COLUMN id SET DEFAULT nextval('public.associations_id_seq'::regclass);


--
-- Name: ceu id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu ALTER COLUMN id SET DEFAULT nextval('public.ceu_id_seq'::regclass);


--
-- Name: ceu_container id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_container ALTER COLUMN id SET DEFAULT nextval('public.ceu_container_id_seq'::regclass);


--
-- Name: ceu_provider id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider ALTER COLUMN id SET DEFAULT nextval('public.ceu_provider_id_seq'::regclass);


--
-- Name: ceu_provider_assoc_map id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider_assoc_map ALTER COLUMN id SET DEFAULT nextval('public.ceu_provider_assoc_map_id_seq'::regclass);


--
-- Name: course_types id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.course_types ALTER COLUMN id SET DEFAULT nextval('public.course_types_id_seq'::regclass);


--
-- Name: ecommerce id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ecommerce ALTER COLUMN id SET DEFAULT nextval('public.ecommerce_id_seq'::regclass);


--
-- Name: global id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.global ALTER COLUMN id SET DEFAULT nextval('public.global_id_seq'::regclass);


--
-- Name: gp_log id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.gp_log ALTER COLUMN id SET DEFAULT nextval('public.gp_log_id_seq'::regclass);


--
-- Name: history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history ALTER COLUMN id SET DEFAULT nextval('public.history_id_seq'::regclass);


--
-- Name: crm_log id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_log ALTER COLUMN id SET DEFAULT nextval('public.crm_log_id_seq'::regclass);


--
-- Name: crm_payload id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_payload ALTER COLUMN id SET DEFAULT nextval('public.crm_payload_id_seq'::regclass);


--
-- Name: marketing_tiles id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.marketing_tiles ALTER COLUMN id SET DEFAULT nextval('public.marketing_tiles_id_seq'::regclass);


--
-- Name: mceu id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mceu ALTER COLUMN id SET DEFAULT nextval('public.mceu_id_seq'::regclass);


--
-- Name: player_details id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_details ALTER COLUMN id SET DEFAULT nextval('public.player_details_id_seq'::regclass);


--
-- Name: player_emails_history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_emails_history ALTER COLUMN id SET DEFAULT nextval('public.player_emails_history_id_seq'::regclass);


--
-- Name: player_eula id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_eula ALTER COLUMN id SET DEFAULT nextval('public.player_eula_id_seq'::regclass);


--
-- Name: player_login_sequence id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_login_sequence ALTER COLUMN id SET DEFAULT nextval('public.player_login_sequence_id_seq'::regclass);


--
-- Name: player_franchise_contact id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_contact ALTER COLUMN id SET DEFAULT nextval('public.player_franchise_contact_id_seq'::regclass);


--
-- Name: player_franchise_rank id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_rank ALTER COLUMN id SET DEFAULT nextval('public.player_franchise_rank_id_seq'::regclass);


--
-- Name: players id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players ALTER COLUMN id SET DEFAULT nextval('public.players_id_seq'::regclass);


--
-- Name: players_licenses id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players_licenses ALTER COLUMN id SET DEFAULT nextval('public.players_licenses_id_seq'::regclass);


--
-- Name: orders id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.orders ALTER COLUMN id SET DEFAULT nextval('public.orders_id_seq'::regclass);


--
-- Name: franchise_courses id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_courses ALTER COLUMN id SET DEFAULT nextval('public.franchise_courses_id_seq'::regclass);


--
-- Name: franchise_gp id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_gp ALTER COLUMN id SET DEFAULT nextval('public.franchise_gp_id_seq'::regclass);


--
-- Name: franchise_product_map id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_product_map ALTER COLUMN id SET DEFAULT nextval('public.franchise_product_map_id_seq'::regclass);


--
-- Name: franchise_type id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_type ALTER COLUMN id SET DEFAULT nextval('public.franchise_type_id_seq'::regclass);


--
-- Name: franchises id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchises ALTER COLUMN id SET DEFAULT nextval('public.franchises_id_seq'::regclass);


--
-- Name: proctor id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor ALTER COLUMN id SET DEFAULT nextval('public.proctor_id_seq'::regclass);


--
-- Name: proctor_log id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_log ALTER COLUMN id SET DEFAULT nextval('public.proctor_log_id_seq'::regclass);


--
-- Name: product_code_map id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_code_map ALTER COLUMN id SET DEFAULT nextval('public.product_code_map_id_seq'::regclass);


--
-- Name: product_kits id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_kits ALTER COLUMN id SET DEFAULT nextval('public.product_kits_id_seq'::regclass);


--
-- Name: product_login_sequence id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence ALTER COLUMN id SET DEFAULT nextval('public.product_login_sequence_id_seq'::regclass);


--
-- Name: product_login_sequence_step id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence_step ALTER COLUMN id SET DEFAULT nextval('public.product_login_sequence_step_id_seq'::regclass);


--
-- Name: product_title_translation id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_title_translation ALTER COLUMN id SET DEFAULT nextval('public.product_title_translation_id_seq'::regclass);


--
-- Name: products id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products ALTER COLUMN id SET DEFAULT nextval('public.products_id_seq'::regclass);


--
-- Name: quest_types id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quest_types ALTER COLUMN id SET DEFAULT nextval('public.quest_types_id_seq'::regclass);


--
-- Name: quests id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests ALTER COLUMN id SET DEFAULT nextval('public.quests_id_seq'::regclass);


--
-- Name: quests_req_lics id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics ALTER COLUMN id SET DEFAULT nextval('public.quests_req_lics_id_seq'::regclass);


--
-- Name: templates id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.templates ALTER COLUMN id SET DEFAULT nextval('public.templates_id_seq'::regclass);


--
-- Name: code_profile id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.code_profile ALTER COLUMN id SET DEFAULT nextval('public.code_profile_id_seq'::regclass);


--
-- Name: content content_id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.content ALTER COLUMN content_id SET DEFAULT nextval('public.content_content_id_seq'::regclass);


--
-- Name: credentials id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.credentials ALTER COLUMN id SET DEFAULT nextval('public.credentials_id_seq'::regclass);


--
-- Name: customer_care_contact id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_care_contact ALTER COLUMN id SET DEFAULT nextval('public.customer_care_contact_id_seq'::regclass);


--
-- Name: eula id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.eula ALTER COLUMN id SET DEFAULT nextval('public.eula_id_seq'::regclass);


--
-- Name: eula_history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.eula_history ALTER COLUMN id SET DEFAULT nextval('public.eula_history_id_seq'::regclass);


--
-- Name: files id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.files ALTER COLUMN id SET DEFAULT nextval('public.files_id_seq'::regclass);


--
-- Name: history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history ALTER COLUMN id SET DEFAULT nextval('public.history_id_seq'::regclass);


--
-- Name: mailinglist id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist ALTER COLUMN id SET DEFAULT nextval('public.mailinglist_id_seq'::regclass);


--
-- Name: mailinglist_history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist_history ALTER COLUMN id SET DEFAULT nextval('public.mailinglist_history_id_seq'::regclass);


--
-- Name: oauth2_client id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_client ALTER COLUMN id SET DEFAULT nextval('public.oauth2_client_id_seq'::regclass);


--
-- Name: oauth2_client_user id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_client_user ALTER COLUMN id SET DEFAULT nextval('public.oauth2_client_user_id_seq'::regclass);


--
-- Name: oauth2_email id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_email ALTER COLUMN id SET DEFAULT nextval('public.oauth2_email_id_seq'::regclass);


--
-- Name: oauth2_error id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_error ALTER COLUMN id SET DEFAULT nextval('public.oauth2_error_id_seq'::regclass);


--
-- Name: oauth2_history id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_history ALTER COLUMN id SET DEFAULT nextval('public.oauth2_history_id_seq'::regclass);


--
-- Name: oauth2_record id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_record ALTER COLUMN id SET DEFAULT nextval('public.oauth2_record_id_seq'::regclass);


--
-- Name: principals id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principals ALTER COLUMN id SET DEFAULT nextval('public.principals_id_seq'::regclass);


--
-- Name: proctor_provider id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_provider ALTER COLUMN id SET DEFAULT nextval('public.proctor_provider_id_seq'::regclass);


--
-- Name: roles id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.roles ALTER COLUMN id SET DEFAULT nextval('public.roles_id_seq'::regclass);


--
-- Name: sso id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.sso ALTER COLUMN id SET DEFAULT nextval('public.sso_id_seq'::regclass);


--
-- Name: versionlog id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.versionlog ALTER COLUMN id SET DEFAULT nextval('public.versionlog_id_seq'::regclass);


--
-- Name: vw_player_listing id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_player_listing ALTER COLUMN id SET DEFAULT nextval('public.vw_player_listing_id_seq'::regclass);


--
-- Name: workflow_entry wfe_id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflow_entry ALTER COLUMN wfe_id SET DEFAULT nextval('public.workflow_entry_wfe_id_seq'::regclass);


--
-- Name: workflowhistory wf_id; Type: DEFAULT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflowhistory ALTER COLUMN wf_id SET DEFAULT nextval('public.workflowhistory_wf_id_seq'::regclass);


--
-- Name: activation_states ad_idx; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_states
    ADD CONSTRAINT ad_idx UNIQUE (id);


--
-- Name: activation_details activation_details_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_details
    ADD CONSTRAINT activation_details_pkey PRIMARY KEY (id);


--
-- Name: activation_states activation_states_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_states
    ADD CONSTRAINT activation_states_pkey PRIMARY KEY (id);


--
-- Name: association_map association_map_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_pkey PRIMARY KEY (id);


--
-- Name: associations associations_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.associations
    ADD CONSTRAINT associations_pkey PRIMARY KEY (id);


--
-- Name: ceu_container ceu_container_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_container
    ADD CONSTRAINT ceu_container_pkey PRIMARY KEY (id);


--
-- Name: ceu ceu_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu
    ADD CONSTRAINT ceu_pkey PRIMARY KEY (id);


--
-- Name: ceu_provider_assoc_map ceu_provider_assoc_map_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider_assoc_map
    ADD CONSTRAINT ceu_provider_assoc_map_pkey PRIMARY KEY (id);


--
-- Name: ceu_provider ceu_provider_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider
    ADD CONSTRAINT ceu_provider_pkey PRIMARY KEY (id);


--
-- Name: course_types course_types_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.course_types
    ADD CONSTRAINT course_types_pkey PRIMARY KEY (id);


--
-- Name: course_types course_types_title_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.course_types
    ADD CONSTRAINT course_types_title_key UNIQUE (title);


--
-- Name: ecommerce ecommerce_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ecommerce
    ADD CONSTRAINT ecommerce_pkey PRIMARY KEY (id);


--
-- Name: gp_log gp_log_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.gp_log
    ADD CONSTRAINT gp_log_pkey PRIMARY KEY (id);


--
-- Name: history history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history
    ADD CONSTRAINT history_pkey PRIMARY KEY (id);


--
-- Name: crm_payload crm_payload_id_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_payload
    ADD CONSTRAINT crm_payload_id_key UNIQUE (id);


--
-- Name: marketing_tiles marketing_tiles_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.marketing_tiles
    ADD CONSTRAINT marketing_tiles_pkey PRIMARY KEY (id);


--
-- Name: mceu mceu_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mceu
    ADD CONSTRAINT mceu_pkey PRIMARY KEY (id);


--
-- Name: player_details player_details_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_details
    ADD CONSTRAINT player_details_pkey PRIMARY KEY (id);


--
-- Name: player_emails_history player_emails_history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_emails_history
    ADD CONSTRAINT player_emails_history_pkey PRIMARY KEY (id);


--
-- Name: player_eula player_eula_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_eula
    ADD CONSTRAINT player_eula_pkey PRIMARY KEY (id);


--
-- Name: player_login_sequence player_login_sequence_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_login_sequence
    ADD CONSTRAINT player_login_sequence_pkey PRIMARY KEY (id);


--
-- Name: player_franchise_contact player_franchise_contact_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_contact
    ADD CONSTRAINT player_franchise_contact_pkey PRIMARY KEY (id);


--
-- Name: player_franchise_rank player_franchise_rank_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_rank
    ADD CONSTRAINT player_franchise_rank_pkey PRIMARY KEY (id);


--
-- Name: players_licenses players_licenses_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players_licenses
    ADD CONSTRAINT players_licenses_pkey PRIMARY KEY (id);


--
-- Name: players players_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players
    ADD CONSTRAINT players_pkey PRIMARY KEY (id);


--
-- Name: orders orders_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT orders_pkey PRIMARY KEY (id);


--
-- Name: franchise_courses franchise_courses_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_courses
    ADD CONSTRAINT franchise_courses_pkey PRIMARY KEY (id);


--
-- Name: franchise_gp franchise_gp_id_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_gp
    ADD CONSTRAINT franchise_gp_id_key UNIQUE (id);


--
-- Name: franchise_product_map franchise_product_map_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_product_map
    ADD CONSTRAINT franchise_product_map_pkey PRIMARY KEY (id);


--
-- Name: franchise_type_old franchise_type_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_type_old
    ADD CONSTRAINT franchise_type_pkey PRIMARY KEY (id);


--
-- Name: franchise_type franchise_type_pkey1; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_type
    ADD CONSTRAINT franchise_type_pkey1 PRIMARY KEY (id);


--
-- Name: franchises franchises_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchises
    ADD CONSTRAINT franchises_pkey PRIMARY KEY (id);


--
-- Name: proctor_log proctor_log_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_log
    ADD CONSTRAINT proctor_log_pkey PRIMARY KEY (id);


--
-- Name: proctor proctor_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor
    ADD CONSTRAINT proctor_pkey PRIMARY KEY (id);


--
-- Name: product_code_map product_code_map_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_code_map
    ADD CONSTRAINT product_code_map_pkey PRIMARY KEY (id);


--
-- Name: product_kits product_kits_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_kits
    ADD CONSTRAINT product_kits_pkey PRIMARY KEY (id);


--
-- Name: product_login_sequence product_login_sequence_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence
    ADD CONSTRAINT product_login_sequence_pkey PRIMARY KEY (id);


--
-- Name: product_login_sequence_step product_login_sequence_step_name_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence_step
    ADD CONSTRAINT product_login_sequence_step_name_key UNIQUE (name);


--
-- Name: product_login_sequence_step product_login_sequence_step_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence_step
    ADD CONSTRAINT product_login_sequence_step_pkey PRIMARY KEY (id);


--
-- Name: products products_id_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_id_key UNIQUE (id);


--
-- Name: products products_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_pkey PRIMARY KEY (id, product_id);


--
-- Name: quest_types quest_types_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quest_types
    ADD CONSTRAINT quest_types_pkey PRIMARY KEY (id);


--
-- Name: quest_types quest_types_title_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quest_types
    ADD CONSTRAINT quest_types_title_key UNIQUE (title);


--
-- Name: quests quests_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_pkey PRIMARY KEY (id);


--
-- Name: quests_req_lics quests_req_lics_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics
    ADD CONSTRAINT quests_req_lics_pkey PRIMARY KEY (id);


--
-- Name: quests_req_lics quests_req_lics_quest_id_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics
    ADD CONSTRAINT quests_req_lics_quest_id_key UNIQUE (quest_id, product_id);


--
-- Name: quests quests_quest_id_key; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_quest_id_key UNIQUE (quest_id);


--
-- Name: code_profile code_profile_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.code_profile
    ADD CONSTRAINT code_profile_pkey PRIMARY KEY (id);


--
-- Name: content content_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.content
    ADD CONSTRAINT content_pkey PRIMARY KEY (content_id);


--
-- Name: credentials credentials_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.credentials
    ADD CONSTRAINT credentials_pkey PRIMARY KEY (id);


--
-- Name: customer_care_contact customer_care_contact_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_care_contact
    ADD CONSTRAINT customer_care_contact_pkey PRIMARY KEY (id);


--
-- Name: eula_history eula_history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.eula_history
    ADD CONSTRAINT eula_history_pkey PRIMARY KEY (id);


--
-- Name: eula eula_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.eula
    ADD CONSTRAINT eula_pkey PRIMARY KEY (id);


--
-- Name: files files_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.files
    ADD CONSTRAINT files_pkey PRIMARY KEY (id);


--
-- Name: franchise_gp gp_assoc_ky; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_gp
    ADD CONSTRAINT gp_assoc_ky PRIMARY KEY (gp_id, franchise_id);


--
-- Name: assoc_franchise_gp_map gp_assoc_map_ky; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_gp_map
    ADD CONSTRAINT gp_assoc_map_ky PRIMARY KEY (gp_id, association_id);


--
-- Name: history history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history
    ADD CONSTRAINT history_pkey PRIMARY KEY (id);


--
-- Name: login_flood_counter login_flood_counter_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.login_flood_counter
    ADD CONSTRAINT login_flood_counter_pkey PRIMARY KEY (player_id);


--
-- Name: mailinglist_history mailinglist_history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist_history
    ADD CONSTRAINT mailinglist_history_pkey PRIMARY KEY (id);


--
-- Name: mailinglist mailinglist_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist
    ADD CONSTRAINT mailinglist_pkey PRIMARY KEY (id);


--
-- Name: media media_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.media
    ADD CONSTRAINT media_pkey PRIMARY KEY (content_id);


--
-- Name: playerdata playerdata_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.playerdata
    ADD CONSTRAINT playerdata_pkey PRIMARY KEY (id);


--
-- Name: oauth2_history oauth2_history_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.oauth2_history
    ADD CONSTRAINT oauth2_history_pkey PRIMARY KEY (id);


--
-- Name: assoc_quest_types po_id; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_quest_types
    ADD CONSTRAINT po_id UNIQUE (id);


--
-- Name: principal_top_role principal_top_role_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principal_top_role
    ADD CONSTRAINT principal_top_role_pkey PRIMARY KEY (principal_id);


--
-- Name: principalrole principalrole_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principalrole
    ADD CONSTRAINT principalrole_pkey PRIMARY KEY (principal_id, role_id);


--
-- Name: principals principals_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principals
    ADD CONSTRAINT principals_pkey PRIMARY KEY (id);


--
-- Name: relations relations_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.relations
    ADD CONSTRAINT relations_pkey PRIMARY KEY (source_id, target_id, relationship);


--
-- Name: roles roles_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);


--
-- Name: sso sso_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.sso
    ADD CONSTRAINT sso_pkey PRIMARY KEY (id);


--
-- Name: assoc_franchise_type_map type_assoc_ky; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_type_map
    ADD CONSTRAINT type_assoc_ky PRIMARY KEY (type_id, association_id);


--
-- Name: usergroup usergroup_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.usergroup
    ADD CONSTRAINT usergroup_pkey PRIMARY KEY (principal_id, group_id);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: versionlog versionlog_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.versionlog
    ADD CONSTRAINT versionlog_pkey PRIMARY KEY (id);


--
-- Name: vproperties vproperties_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vproperties
    ADD CONSTRAINT vproperties_pkey PRIMARY KEY (id, key);


--
-- Name: vw_player_listing vw_player_listing_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_player_listing
    ADD CONSTRAINT vw_player_listing_pkey PRIMARY KEY (id);


--
-- Name: vw_franchise_players_summary vw_franchise_players_summary_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_franchise_players_summary
    ADD CONSTRAINT vw_franchise_players_summary_pkey PRIMARY KEY (id);


--
-- Name: vw_quest_avail_players vw_quest_avail_players_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_quest_avail_players
    ADD CONSTRAINT vw_quest_avail_players_pkey PRIMARY KEY (player_id);


--
-- Name: workflow_entry workflow_entry_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflow_entry
    ADD CONSTRAINT workflow_entry_pkey PRIMARY KEY (wfe_id);


--
-- Name: workflowhistory workflowhistory_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflowhistory
    ADD CONSTRAINT workflowhistory_pkey PRIMARY KEY (wf_id);


--
-- Name: action_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX action_idx ON public.history USING btree (action);


--
-- Name: activation_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX activation_id_idx ON public.activation_states USING btree (id);


--
-- Name: activation_state_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX activation_state_id_idx ON public.activation_states USING btree (activation_id);


--
-- Name: activation_state_title_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX activation_state_title_idx ON public.activation_states USING btree (activation_title);


--
-- Name: activation_details_activation_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX activation_details_activation_id_idx ON public.activation_details USING btree (activation_id);


--
-- Name: activation_details_player_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX activation_details_player_id_idx ON public.activation_details USING btree (player_id);


--
-- Name: aq_lics_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX aq_lics_id_idx ON public.players_licenses USING btree (id);


--
-- Name: aq_lics_player_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX aq_lics_player_id_idx ON public.players_licenses USING btree (player_id);


--
-- Name: aq_lics_franchise_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX aq_lics_franchise_id_idx ON public.players_licenses USING btree (franchise_id);


--
-- Name: aq_lics_product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX aq_lics_product_id_idx ON public.players_licenses USING btree (product_id);


--
-- Name: assoc_map_mem_assoc_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX assoc_map_mem_assoc_idx ON public.association_map USING btree (association_id, player_id);


--
-- Name: assoc_map_mem_assoc_idx_2; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX assoc_map_mem_assoc_idx_2 ON public.association_map USING btree (association_id, player_id) WHERE (association_id = 2);


--
-- Name: assoc_map_ptr_assoc_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX assoc_map_ptr_assoc_idx ON public.association_map USING btree (association_id, franchise_id);


--
-- Name: association_map_assoc_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX association_map_assoc_id ON public.association_map USING btree (association_id);


--
-- Name: association_map_mem_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX association_map_mem_id ON public.association_map USING btree (player_id);


--
-- Name: association_map_ptnr_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX association_map_ptnr_id ON public.association_map USING btree (franchise_id);


--
-- Name: courses_types_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX courses_types_id_idx ON public.course_types USING btree (id);


--
-- Name: ecom_mem_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ecom_mem_id_idx ON public.ecommerce USING btree (player_id);


--
-- Name: ecom_ptnr_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ecom_ptnr_id_idx ON public.ecommerce USING btree (franchise_id);


--
-- Name: hist_prin_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_prin_idx ON public.history USING btree (principal_id);


--
-- Name: map_mid_aididx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX map_mid_aididx ON public.association_map USING btree (association_id, player_id);


--
-- Name: mem_current_state_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX mem_current_state_idx ON public.players USING btree (current_state);


--
-- Name: mem_email_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX mem_email_idx ON public.players USING btree (email);


--
-- Name: mem_id_pid2; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX mem_id_pid2 ON public.players USING btree (id, principal_id);


--
-- Name: player_details_mem_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_details_mem_id_idx ON public.player_details USING btree (player_id);


--
-- Name: player_emails_mem_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_emails_mem_id_idx ON public.player_emails_history USING btree (player_id);


--
-- Name: player_id_midx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_id_midx ON public.players USING btree (id, player_id);


--
-- Name: player_id_pidmidx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_id_pidmidx ON public.players USING btree (id, player_id, principal_id);


--
-- Name: player_login_sequence_mem_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_login_sequence_mem_id_idx ON public.player_login_sequence USING btree (player_id);


--
-- Name: player_franchise_rank_mem_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_franchise_rank_mem_idx ON public.player_franchise_rank USING btree (player_id);


--
-- Name: player_franchise_rank_ptnrid_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_franchise_rank_ptnrid_idx ON public.player_franchise_rank USING btree (franchise_id);


--
-- Name: player_ptnr_contact_mem_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_ptnr_contact_mem_id_idx ON public.player_franchise_contact USING btree (player_id);


--
-- Name: player_ptnr_contact_prdct_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_ptnr_contact_prdct_id_idx ON public.player_franchise_contact USING btree (product_id);


--
-- Name: player_ptnr_contact_ptnr_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX player_ptnr_contact_ptnr_id_idx ON public.player_franchise_contact USING btree (franchise_id);


--
-- Name: players_licenses_mpp_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX players_licenses_mpp_idx ON public.players_licenses USING btree (product_id, franchise_id, player_id);


--
-- Name: players_prin_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX players_prin_id ON public.players USING btree (principal_id);


--
-- Name: orders_franchise_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX orders_franchise_idx ON public.orders USING btree (franchise_id);


--
-- Name: orders_product_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX orders_product_idx ON public.orders USING btree (product_id);


--
-- Name: franchise_courses_ptnr_id_prd_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchise_courses_ptnr_id_prd_id ON public.franchise_courses USING btree (franchise_id, product_id);


--
-- Name: franchise_gp_pg_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchise_gp_pg_idx ON public.franchise_gp USING btree (franchise_id, gp_id);


--
-- Name: franchise_type_id_pid; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchise_type_id_pid ON public.franchise_type USING btree (id, principal_id);


--
-- Name: franchises_id_principal_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchises_id_principal_idx ON public.franchises USING btree (id, principal_id);


--
-- Name: franchises_prin_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchises_prin_id ON public.franchises USING btree (principal_id);


--
-- Name: pc_prdct_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX pc_prdct_id ON public.franchise_courses USING btree (product_id);


--
-- Name: pc_ptnr_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX pc_ptnr_id ON public.franchise_courses USING btree (franchise_id);


--
-- Name: prdct_login_seq_seq_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX prdct_login_seq_seq_idx ON public.product_login_sequence_step USING btree (login_sequence_id);


--
-- Name: products_cert_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX products_cert_idx ON public.products USING btree (certification_product);


--
-- Name: ptnr_courses_product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ptnr_courses_product_id_idx ON public.franchise_courses USING btree (product_id);


--
-- Name: ptnr_prdct_map_prdct_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ptnr_prdct_map_prdct_idx ON public.franchise_product_map USING btree (product_id);


--
-- Name: ptnr_prdct_map_ptnr_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ptnr_prdct_map_ptnr_idx ON public.franchise_product_map USING btree (franchise_id);


--
-- Name: ptnr_type_prin_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ptnr_type_prin_idx ON public.franchise_type USING btree (principal_id);


--
-- Name: req_product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX req_product_id_idx ON public.quests_req_lics USING btree (product_id);


--
-- Name: req_quest_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX req_quest_id_idx ON public.quests_req_lics USING btree (quest_id);


--
-- Name: ses_ptr_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ses_ptr_id ON public.quests USING btree (association_id, quest_id, franchise_id);


--
-- Name: ses_sid_prdid; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX ses_sid_prdid ON public.quests_req_lics USING btree (quest_id, product_id);


--
-- Name: quest_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX quest_id_idx ON public.quests USING btree (id);


--
-- Name: quest_quest_id_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX quest_quest_id_id_idx ON public.quests USING btree (quest_id);


--
-- Name: quest_title_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX quest_title_idx ON public.quests USING btree (title);


--
-- Name: quests_id_principal_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX quests_id_principal_idx ON public.quests USING btree (id, principal_id);


--
-- Name: quests_principal_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX quests_principal_idx ON public.quests USING btree (principal_id);


--
-- Name: quests_types_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX quests_types_id_idx ON public.quest_types USING btree (id);


--
-- Name: association_association_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX association_association_id_idx ON public.associations USING btree (association_id);


--
-- Name: association_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX association_id_idx ON public.associations USING btree (id);


--
-- Name: content_container_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_container_idx ON public.content USING btree (container_id);


--
-- Name: content_creation_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_creation_idx ON public.content USING btree (creation_date);


--
-- Name: content_creator_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_creator_idx ON public.content USING btree (creators);


--
-- Name: content_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_id_idx ON public.content USING btree (id);


--
-- Name: content_lang_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_lang_idx ON public.content USING btree (language);


--
-- Name: content_okforuse_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_okforuse_idx ON public.content USING btree (okforuse);


--
-- Name: content_portal_type_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_portal_type_idx ON public.content USING btree (portal_type);


--
-- Name: content_status_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_status_idx ON public.content USING btree (status);


--
-- Name: content_title_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_title_idx ON public.content USING btree (title);


--
-- Name: content_transsource_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_transsource_idx ON public.content USING btree (translation_source);


--
-- Name: content_type_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX content_type_idx ON public.content USING btree (type);


--
-- Name: content_uid_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX content_uid_idx ON public.content USING btree (uid);


--
-- Name: eula_prin_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX eula_prin_idx ON public.eula USING btree (creator);


--
-- Name: eula_prin_mod_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX eula_prin_mod_idx ON public.eula USING btree (modified_by);


--
-- Name: files_attribute_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX files_attribute_idx ON public.files USING btree (attribute);


--
-- Name: hist_actor_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_actor_idx ON public.history USING btree (actor);


--
-- Name: hist_created_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_created_idx ON public.history USING btree (created);


--
-- Name: hist_player_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_player_id_idx ON public.history USING btree (player_id);


--
-- Name: hist_franchise_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_franchise_id_idx ON public.history USING btree (franchise_id);


--
-- Name: hist_quest_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX hist_quest_id_idx ON public.history USING btree (quest_id);


--
-- Name: idx_gin_roles; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX idx_gin_roles ON public.principal_top_role USING gin (roles);


--
-- Name: idx_franchise_type_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX idx_franchise_type_id_idx ON public.franchise_type USING btree (id);


--
-- Name: ix_franchises_franchise_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX ix_franchises_franchise_id ON public.franchises USING btree (franchise_id);


--
-- Name: ix_products_product_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX ix_products_product_id ON public.products USING btree (product_id);


--
-- Name: kit_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX kit_id_idx ON public.product_kits USING btree (id);


--
-- Name: kit_kit_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX kit_kit_id_idx ON public.product_kits USING btree (kit_id);


--
-- Name: kit_product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX kit_product_id_idx ON public.product_kits USING btree (product_id);


--
-- Name: mailinglist_zipcode_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX mailinglist_zipcode_idx ON public.mailinglist USING btree (zipcode);


--
-- Name: playerdata_email_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX playerdata_email_idx ON public.playerdata USING btree (email);


--
-- Name: players_fname_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX players_fname_idx ON public.players USING btree (firstname);


--
-- Name: players_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX players_id_idx ON public.players USING btree (id);


--
-- Name: players_lname_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX players_lname_idx ON public.players USING btree (lastname);


--
-- Name: players_user_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX players_user_id_idx ON public.players USING btree (user_id);


--
-- Name: franchise_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX franchise_id_idx ON public.franchises USING btree (id);


--
-- Name: franchise_franchise_group_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchise_franchise_group_idx ON public.franchises USING btree (group_id);


--
-- Name: franchise_franchise_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX franchise_franchise_id_idx ON public.franchises USING btree (franchise_id);


--
-- Name: franchise_franchise_title_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX franchise_franchise_title_idx ON public.franchises USING btree (title);


--
-- Name: franchise_product_course_index; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX franchise_product_course_index ON public.franchise_courses USING btree (franchise_id, product_id);


--
-- Name: principal_top_role_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX principal_top_role_idx ON public.principal_top_role USING btree (principal_id, top_role, roles);


--
-- Name: principalrole_principal_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX principalrole_principal_id_idx ON public.principalrole USING btree (principal_id);


--
-- Name: principalrole_role_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX principalrole_role_id_idx ON public.principalrole USING btree (role_id);


--
-- Name: principals_name_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX principals_name_idx ON public.principals USING btree (name, association, product);


--
-- Name: principals_type_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX principals_type_idx ON public.principals USING btree (type);


--
-- Name: product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX product_id_idx ON public.products USING btree (id);


--
-- Name: product_product_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX product_product_id_idx ON public.products USING btree (product_id);


--
-- Name: roles_assoc_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX roles_assoc_idx ON public.roles USING btree (association);


--
-- Name: roles_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX roles_idx ON public.principal_top_role USING btree (roles);


--
-- Name: roles_name_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX roles_name_idx ON public.roles USING btree (name);


--
-- Name: roles_product_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX roles_product_idx ON public.roles USING btree (product);


--
-- Name: roles_rolename_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX roles_rolename_idx ON public.roles USING btree (association, product, name);


--
-- Name: usergroup_group_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usergroup_group_id_idx ON public.usergroup USING btree (group_id);


--
-- Name: usergroup_pid_gid; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usergroup_pid_gid ON public.usergroup USING btree (principal_id, group_id);


--
-- Name: usergroup_principal_id_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usergroup_principal_id_idx ON public.usergroup USING btree (principal_id);


--
-- Name: users_login_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX users_login_idx ON public.users USING btree (login);


--
-- Name: versionlog_tbl; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX versionlog_tbl ON public.versionlog USING btree (tbl);


--
-- Name: wfh_name_idx; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX wfh_name_idx ON public.workflowhistory USING btree (name);


--
-- Name: vw_franchise_details _RETURN; Type: RULE; Schema: public; Owner: -
--

CREATE OR REPLACE VIEW public.vw_franchise_details AS
 SELECT ptnr.id,
    ptnr.franchise_id,
    ptnr.ignore_inventory,
    ptnr.allow_virtual_instruction,
    ptnr.title,
    ptnr.description,
    ptnr."franchiseCity" AS city,
    ptnr."franchiseState" AS state,
    ptnr."franchiseCountry" AS country,
    ptnr.contactinfo,
    pt.title AS franchise_type,
    pt.id AS franchise_type_id,
    ptnr.principal_id,
    gp.gp_id,
    assoc.association_id AS association_str,
    am.association_id,
    ARRAY( SELECT 1.association_id
           FROM public.association_map 1
          WHERE (1.franchise_id = ptnr.id)
          ORDER BY 1.association_id) AS assocs,
    ( SELECT count(*) AS count
           FROM public.usergroup
          WHERE (usergroup.group_id = ptnr.principal_id)) AS total_users,
    ( SELECT count(mem.id) AS count
           FROM public.players mem
          WHERE ((mem.principal_id IN ( SELECT ug.principal_id
                   FROM public.usergroup ug
                  WHERE (ug.group_id = ptnr.principal_id))) AND (mem.id IN ( SELECT mp.player_id
                   FROM public.association_map mp
                  WHERE (mp.association_id = am.association_id))))) AS assoc_users,
    sum(
        CASE
            WHEN (ses.closed = false) THEN 1
            ELSE 0
        END) AS open_quests,
    sum(
        CASE
            WHEN (ses.closed = true) THEN 1
            ELSE 0
        END) AS closed_quests,
    ptnr.created
   FROM (((((public.franchises ptnr
     LEFT JOIN public.association_map am ON ((ptnr.id = am.franchise_id)))
     LEFT JOIN public.associations assoc ON ((assoc.id = am.association_id)))
     LEFT JOIN public.franchise_type pt ON ((pt.id = ptnr.franchise_type)))
     LEFT JOIN public.franchise_gp gp ON (((gp.franchise_id = ptnr.id) AND (gp.id IN ( SELECT assoc_franchise_gp_map.gp_id
           FROM public.assoc_franchise_gp_map
          WHERE (assoc_franchise_gp_map.association_id = am.association_id))))))
     LEFT JOIN public.quests ses ON (((ses.franchise_id = ptnr.id) AND (ses.association_id = assoc.id))))
  GROUP BY ptnr.id, am.association_id, assoc.association_id, gp.gp_id, pt.id;


--
-- Name: vw_franchise_inventory _RETURN; Type: RULE; Schema: public; Owner: -
--

CREATE OR REPLACE VIEW public.vw_franchise_inventory AS
 SELECT ptnr.title AS franchise_title,
    ptnr.id AS ptnr_id,
    pd.product_id,
    pd.product_id AS p_product_id,
    pd.product_title AS p_product_title,
    pd.id AS p_id,
    pd.product_title,
    pd.product_version,
    pd.individual_sale,
    pd.association_id AS assoc_id,
    ( SELECT sum((orders.quantity)::integer) AS sum
           FROM public.orders
          WHERE ((orders.product_id = pd.id) AND (orders.franchise_id = ptnr.id))) AS ordered,
    ( SELECT count(players_licenses.*) AS count
           FROM public.players_licenses
          WHERE ((players_licenses.product_id = pd.id) AND (players_licenses.franchise_id = ptnr.id))) AS consumed,
    (( SELECT sum((orders.quantity)::integer) AS sum
           FROM public.orders
          WHERE ((orders.product_id = pd.id) AND (orders.franchise_id = ptnr.id))) - ( SELECT count(players_licenses.*) AS count
           FROM public.players_licenses
          WHERE ((players_licenses.product_id = pd.id) AND (players_licenses.franchise_id = ptnr.id)))) AS inventory,
    ( SELECT (product_kits.kit_id)::boolean AS kit_id
           FROM public.product_kits
          WHERE (product_kits.kit_id = pd.id)
         LIMIT 1) AS is_kit,
    ( SELECT ((count(products.id))::integer)::boolean AS count
           FROM public.products
          WHERE ((products.id IN ( SELECT product_kits.product_id
                   FROM public.product_kits
                  WHERE (product_kits.kit_id = pd.id))) AND (products.individual_sale IS TRUE))) AS has_sale_parts
   FROM ((public.products pd
     JOIN public.franchise_courses courses ON (((courses.product_id = pd.id) AND (courses.enable = true))))
     JOIN public.franchises ptnr ON ((ptnr.id = courses.franchise_id)))
  WHERE (pd.ecommerce_product <> true)
  GROUP BY ptnr.title, ptnr.id, pd.product_id, pd.id, pd.product_title, pd.individual_sale, pd.product_version, pd.association_id
  ORDER BY pd.product_order, pd.product_title;


--
-- Name: vw_product_details _RETURN; Type: RULE; Schema: public; Owner: -
--

CREATE OR REPLACE VIEW public.vw_product_details AS
 SELECT foo.id,
    foo.product_id,
    foo.active,
    foo.product_title,
    foo.description,
    foo.invite_view,
    foo.product_url,
    foo.midterm_exurl,
    foo.final_exurl,
    foo.product_version,
    foo.product_order,
    foo.exp_duration,
    foo.mapped_group,
    foo.individual_sale,
    foo.requisite_products,
    foo.require_valid_requisite,
    foo.validate_user_data,
    foo.license_extension_only,
    foo.extension_grace_period,
    foo.use_lac_url,
    foo.end_of_life,
    foo.requires_quest_enrollment,
    foo.dsf_parent_id,
    foo.learning_path_id,
    foo.association_id,
    foo.ecommerce_product,
    foo.certification_product,
    foo.association_str,
    foo.association_url,
    foo.created,
    foo.ordered,
    foo.franchises,
    foo.enabled_franchises,
    foo.quests,
    foo.open_quests,
    foo.closed_quests,
    foo.consumed,
    foo.expired,
    foo.unexpired,
    foo.activated,
    foo.invited,
    foo.ignored_orders,
    foo.total_orders,
    foo.consumed_from_franchise,
    foo.consumed_individually,
    foo.consumed_from_ecom,
    ( SELECT ((foo.total_orders - foo.ignored_orders) - foo.consumed)) AS actual_inventory
   FROM ( SELECT prd.id,
            prd.product_id,
            prd.active,
            prd.product_title,
            prd.description,
            prd.invite_view,
            prd.product_url,
            prd.midterm_exurl,
            prd.final_exurl,
            prd.product_version,
            prd.product_order,
            prd.exp_duration,
            prd.mapped_group,
            prd.individual_sale,
            prd.requisite_products,
            prd.require_valid_requisite,
            prd.validate_user_data,
            prd.license_extension_only,
            prd.extension_grace_period,
            prd.use_lac_url,
            prd.end_of_life,
            prd.requires_quest_enrollment,
            prd.dsf_parent_id,
            prd.learning_path_id,
            prd.association_id,
            prd.ecommerce_product,
            prd.certification_product,
            assoc.association_id AS association_str,
            assoc.address AS association_url,
            prd.created,
            ( SELECT sum((orders.quantity)::integer) AS sum
                   FROM public.orders
                  WHERE (orders.product_id = prd.id)) AS ordered,
            ( SELECT count(DISTINCT crs.*) AS count
                   FROM public.franchise_courses crs
                  WHERE (crs.product_id = prd.id)) AS franchises,
            ( SELECT count(crs.*) AS count
                   FROM public.franchise_courses crs
                  WHERE ((crs.product_id = prd.id) AND (crs.enable IS TRUE))) AS enabled_franchises,
            ( SELECT count(sesp.*) AS count
                   FROM public.quests_req_lics sesp
                  WHERE (sesp.product_id = prd.id)) AS quests,
            ( SELECT count(sesp.*) AS count
                   FROM (public.quests_req_lics sesp
                     JOIN public.quests ses ON (((ses.id = sesp.quest_id) AND (ses.closed IS TRUE))))
                  WHERE (sesp.product_id = prd.id)) AS closed_quests,
            ( SELECT count(sesp.*) AS count
                   FROM (public.quests_req_lics sesp
                     JOIN public.quests ses ON (((ses.id = sesp.quest_id) AND (ses.closed IS NOT TRUE))))
                  WHERE (sesp.product_id = prd.id)) AS open_quests,
            ( SELECT count(players_licenses.*) AS count
                   FROM public.players_licenses
                  WHERE (players_licenses.product_id = prd.id)) AS consumed,
            ( SELECT count(players_licenses.*) AS count
                   FROM public.players_licenses
                  WHERE ((players_licenses.product_id = prd.id) AND ((players_licenses.ecom_sku)::text <> NULL::text))) AS consumed_from_ecom,
            ( SELECT count(players_licenses.*) AS count
                   FROM public.players_licenses
                  WHERE ((players_licenses.product_id = prd.id) AND (players_licenses.franchise_id = NULL::integer))) AS consumed_individually,
            ( SELECT count(players_licenses.*) AS count
                   FROM public.players_licenses
                  WHERE ((players_licenses.product_id = prd.id) AND (players_licenses.franchise_id <> NULL::integer))) AS consumed_from_franchise,
            ( SELECT count(lics.*) AS count
                   FROM public.players_licenses lics
                  WHERE ((lics.expires < now()) AND (lics.product_id = prd.id))) AS expired,
            ( SELECT count(lics.*) AS count
                   FROM public.players_licenses lics
                  WHERE ((lics.expires >= now()) AND (lics.product_id = prd.id))) AS unexpired,
            ( SELECT count(mem.*) AS count
                   FROM (public.players mem
                     JOIN public.players_licenses lics ON (((mem.id = lics.player_id) AND ((mem.current_state)::text = 'Activated'::text))))
                  WHERE ((lics.expires >= now()) AND (lics.product_id = prd.id))) AS activated,
            ( SELECT COALESCE(count(mem.*), (0)::bigint) AS "coalesce"
                   FROM (public.players_licenses lics
                     JOIN public.players mem ON (((mem.id = lics.player_id) AND ((mem.current_state)::text = 'Invited'::text))))
                  WHERE ((lics.expires >= now()) AND (lics.product_id = prd.id))) AS invited,
            ( SELECT COALESCE(sum((orders.quantity)::integer), (0)::bigint) AS "coalesce"
                   FROM (public.orders
                     JOIN public.franchises ptnrs ON ((ptnrs.id = orders.franchise_id)))
                  WHERE (orders.product_id = prd.id)) AS total_orders,
            ( SELECT COALESCE(sum((orders.quantity)::integer), (0)::bigint) AS "coalesce"
                   FROM (public.orders
                     JOIN public.franchises ptnrs ON (((ptnrs.id = orders.franchise_id) AND (ptnrs.ignore_inventory IS TRUE))))
                  WHERE (orders.product_id = prd.id)) AS ignored_orders
           FROM (public.products prd
             LEFT JOIN public.associations assoc ON ((assoc.id = prd.association_id)))
          GROUP BY prd.id, prd.product_id, assoc.association_id, assoc.address) foo;


--
-- Name: vw_quest_details _RETURN; Type: RULE; Schema: public; Owner: -
--

CREATE OR REPLACE VIEW public.vw_quest_details AS
 SELECT sub_query.p_id AS franchise_id,
    sub_query.franchise_title,
    sub_query.ptnr_id AS str_franchise_id,
    sub_query.ptnr_description,
    sub_query.ptnr_city,
    sub_query.ptnr_state,
    sub_query.ptnr_country,
    sub_query.s_id AS id,
    sub_query.sess_id AS quest_id,
    sub_query.quest_title AS title,
    sub_query.sess_language AS language,
    sub_query.sess_crm AS crm,
    sub_query.user_count,
    sub_query.sess_principal_id AS principal_id,
    sub_query.sess_description AS description,
    sub_query.quest_type_id,
    sub_query.quest_type_title AS quest_type,
    sub_query.learning_path_id,
    sub_query.course_type_id,
    sub_query.course_type_title AS course_type,
    sub_query.ptnr_franchise_type_id AS franchise_type_id,
    sub_query.ptnr_franchise_type AS franchise_type,
    sub_query.sess_closed AS closed,
    sub_query.sess_est_player_count AS est_player_count,
    sub_query.sess_city AS city,
    sub_query.sess_state AS state,
    sub_query.sess_country AS country,
    sub_query.sess_comments AS comments,
    sub_query.start_date AS "startDate",
    sub_query.end_date AS "endDate",
    sub_query.s_group AS group_id,
    sub_query.sess_modified AS modified,
    sub_query.assoc_id,
    sub_query.required_pids,
    sub_query.required_products,
    (((COALESCE(sub_query.sess_city, ''::character varying))::text || ', '::text) || (COALESCE(sub_query.sess_state, ''::character varying))::text) AS location,
    sub_query.sess_created AS created
   FROM ( SELECT sess.id,
            sess.quest_id,
            sess.franchise_id,
            sess.title,
            sess.description,
            sess.quest_type,
            sess.course_type,
            sess.college_credit,
            sess.closed,
            sess.est_player_count,
            sess.city,
            sess.state,
            sess.country,
            sess."startDate",
            sess."endDate",
            sess.comments,
            sess.created,
            sess.modified,
            sess.group_id,
            sess.principal_id,
            sess.access_by_quest_window,
            sess.assoc_course_type,
            sess.assoc_quest_type,
            sess.max_player_count,
            sess.mid_exstart,
            sess.mid_exend,
            sess.final_exstart,
            sess.final_exend,
            sess.language,
            sess.crm,
            sess.association_id,
            ptnrs.title AS franchise_title,
            ptnrs.id AS p_id,
            ptnrs.franchise_id AS ptnr_id,
            ptnrs.description AS ptnr_description,
            ptnrs."franchiseCity" AS ptnr_city,
            ptnrs."franchiseState" AS ptnr_state,
            ptnrs."franchiseCountry" AS ptnr_country,
            sess.id AS s_id,
            sess.quest_id AS sess_id,
            sess.title AS quest_title,
            ( SELECT count(*) AS count
                   FROM public.usergroup
                  WHERE (usergroup.group_id = sess.principal_id)) AS user_count,
            sess.principal_id AS sess_principal_id,
            sess.quest_id AS sess_quest_id,
            sess.franchise_id AS sess_franchise_id,
            sess.title AS sess_title,
            sess.language AS sess_language,
            sess.crm AS sess_crm,
            sess.description AS sess_description,
            st.id AS quest_type_id,
            st.title AS quest_type_title,
            st.learning_path_id,
            ct.id AS course_type_id,
            ct.title AS course_type_title,
            pt.id AS ptnr_franchise_type_id,
            pt.title AS ptnr_franchise_type,
            sess.closed AS sess_closed,
            sess.est_player_count AS sess_est_player_count,
            sess.city AS sess_city,
            sess.state AS sess_state,
            sess.country AS sess_country,
            sess.comments AS sess_comments,
            sess."startDate" AS start_date,
            sess."endDate" AS end_date,
            sess.group_id AS s_group,
            sess.modified AS sess_modified,
            sess.association_id AS assoc_id,
            ARRAY( SELECT products.product_id
                   FROM public.products
                  WHERE (products.id IN ( SELECT quests_req_lics.product_id
                           FROM public.quests_req_lics
                          WHERE (quests_req_lics.quest_id = sess.id)))) AS required_pids,
            ARRAY( SELECT products.product_title
                   FROM public.products
                  WHERE (products.id IN ( SELECT quests_req_lics.product_id
                           FROM public.quests_req_lics
                          WHERE (quests_req_lics.quest_id = sess.id)))) AS required_products,
            sess.created AS sess_created
           FROM (((((public.quests sess
             LEFT JOIN public.franchises ptnrs ON ((ptnrs.id = sess.franchise_id)))
             LEFT JOIN public.franchise_type pt ON ((pt.id = ptnrs.franchise_type)))
             LEFT JOIN public.principals prin ON ((sess.principal_id = prin.id)))
             LEFT JOIN public.assoc_course_types ct ON ((ct.id = sess.assoc_course_type)))
             LEFT JOIN public.assoc_quest_types st ON ((st.id = sess.assoc_quest_type)))
          GROUP BY sess.id, ptnrs.franchise_id, ptnrs.id, ptnrs."franchiseCity", ptnrs."franchiseState", ptnrs."franchiseCountry", ptnrs.title, sess.quest_id, sess.franchise_id, sess.principal_id, sess.title, st.learning_path_id, sess.language, sess.crm, sess.description, st.id, st.title, ct.id, ct.title, pt.id, pt.title, sess.closed, sess.est_player_count, sess.city, sess.state, sess.country, sess.comments, sess."startDate", sess."endDate", sess.college_credit, sess.created, sess.modified, sess.group_id, ptnrs.description, sess.association_id) sub_query;


--
-- Name: vw_tmp_quest_details _RETURN; Type: RULE; Schema: public; Owner: -
--

CREATE OR REPLACE VIEW public.vw_tmp_quest_details AS
 SELECT sub_query.p_id AS franchise_id,
    sub_query.franchise_title,
    sub_query.ptnr_id AS str_franchise_id,
    sub_query.ptnr_description,
    sub_query.ptnr_city,
    sub_query.ptnr_state,
    sub_query.ptnr_country,
    sub_query.s_id AS id,
    sub_query.sess_id AS quest_id,
    sub_query.quest_title AS title,
    sub_query.sess_access_by_quest_window AS access_by_quest_window,
    sub_query.sess_language AS language,
    sub_query.sess_crm AS crm,
    sub_query.user_count,
    sub_query.sess_principal_id AS principal_id,
    sub_query.sess_description AS description,
    sub_query.quest_type_id,
    sub_query.quest_type_title AS quest_type,
    sub_query.course_type_id,
    sub_query.course_type_title AS course_type,
    sub_query.ptnr_franchise_type_id AS franchise_type_id,
    sub_query.ptnr_franchise_type AS franchise_type,
    sub_query.sess_closed AS closed,
    sub_query.sess_est_player_count AS est_player_count,
    sub_query.sess_city AS city,
    sub_query.sess_state AS state,
    sub_query.sess_country AS country,
    sub_query.sess_comments AS comments,
    sub_query.start_date AS "startDate",
    sub_query.end_date AS "endDate",
    sub_query.s_group AS group_id,
    sub_query.sess_modified AS modified,
    sub_query.assoc_id,
    sub_query.required_pids,
    sub_query.required_products,
    (((COALESCE(sub_query.sess_city, ''::character varying))::text || ', '::text) || (COALESCE(sub_query.sess_state, ''::character varying))::text) AS location
   FROM ( SELECT sess.id,
            sess.quest_id,
            sess.franchise_id,
            sess.title,
            sess.description,
            sess.quest_type,
            sess.course_type,
            sess.college_credit,
            sess.closed,
            sess.est_player_count,
            sess.city,
            sess.state,
            sess.country,
            sess."startDate",
            sess."endDate",
            sess.comments,
            sess.created,
            sess.modified,
            sess.group_id,
            sess.principal_id,
            sess.access_by_quest_window,
            sess.assoc_course_type,
            sess.assoc_quest_type,
            sess.max_player_count,
            sess.mid_exstart,
            sess.mid_exend,
            sess.final_exstart,
            sess.final_exend,
            sess.language,
            sess.crm,
            sess.association_id,
            ptnrs.title AS franchise_title,
            ptnrs.id AS p_id,
            ptnrs.franchise_id AS ptnr_id,
            ptnrs.description AS ptnr_description,
            ptnrs."franchiseCity" AS ptnr_city,
            ptnrs."franchiseState" AS ptnr_state,
            ptnrs."franchiseCountry" AS ptnr_country,
            sess.id AS s_id,
            sess.quest_id AS sess_id,
            sess.title AS quest_title,
            sess.access_by_quest_window AS sess_access_by_quest_window,
            ( SELECT count(*) AS count
                   FROM public.usergroup
                  WHERE (usergroup.group_id = sess.principal_id)) AS user_count,
            sess.principal_id AS sess_principal_id,
            sess.quest_id AS sess_quest_id,
            sess.franchise_id AS sess_franchise_id,
            sess.title AS sess_title,
            sess.language AS sess_language,
            sess.crm AS sess_crm,
            sess.description AS sess_description,
            st.id AS quest_type_id,
            st.title AS quest_type_title,
            ct.id AS course_type_id,
            ct.title AS course_type_title,
            pt.id AS ptnr_franchise_type_id,
            pt.title AS ptnr_franchise_type,
            sess.closed AS sess_closed,
            sess.est_player_count AS sess_est_player_count,
            sess.city AS sess_city,
            sess.state AS sess_state,
            sess.country AS sess_country,
            sess.comments AS sess_comments,
            sess."startDate" AS start_date,
            sess."endDate" AS end_date,
            sess.group_id AS s_group,
            sess.modified AS sess_modified,
            sess.association_id AS assoc_id,
            ARRAY( SELECT products.product_id
                   FROM public.products
                  WHERE (products.id IN ( SELECT quests_req_lics.product_id
                           FROM public.quests_req_lics
                          WHERE (quests_req_lics.quest_id = sess.id)))) AS required_pids,
            ARRAY( SELECT products.product_title
                   FROM public.products
                  WHERE (products.id IN ( SELECT quests_req_lics.product_id
                           FROM public.quests_req_lics
                          WHERE (quests_req_lics.quest_id = sess.id)))) AS required_products
           FROM (((((public.quests sess
             LEFT JOIN public.franchises ptnrs ON ((ptnrs.id = sess.franchise_id)))
             LEFT JOIN public.franchise_type pt ON ((pt.id = ptnrs.franchise_type)))
             LEFT JOIN public.principals prin ON ((sess.principal_id = prin.id)))
             LEFT JOIN public.assoc_course_types ct ON ((ct.id = sess.assoc_course_type)))
             LEFT JOIN public.assoc_quest_types st ON ((st.id = sess.assoc_quest_type)))
          GROUP BY sess.id, ptnrs.franchise_id, ptnrs.id, ptnrs."franchiseCity", ptnrs."franchiseState", ptnrs."franchiseCountry", ptnrs.title, sess.quest_id, sess.franchise_id, sess.principal_id, sess.title, sess.language, sess.crm, sess.description, st.id, st.title, ct.id, ct.title, pt.id, pt.title, sess.closed, sess.est_player_count, sess.city, sess.state, sess.country, sess.comments, sess."startDate", sess."endDate", sess.college_credit, sess.created, sess.modified, sess.group_id, ptnrs.description, sess.association_id) sub_query;


--
-- Name: content content_moddate_trigger; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER content_moddate_trigger BEFORE INSERT OR UPDATE ON public.content FOR EACH ROW EXECUTE FUNCTION public.setmoddate();


--
-- Name: usergroup tg_insert_principal_top_role; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tg_insert_principal_top_role AFTER INSERT ON public.usergroup FOR EACH ROW EXECUTE FUNCTION public.fn_insert_top_role();


--
-- Name: usergroup tg_insert_principal_top_role_on_removal; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tg_insert_principal_top_role_on_removal AFTER DELETE ON public.usergroup FOR EACH ROW EXECUTE FUNCTION public.fn_insert_top_role();


--
-- Name: activation_details tg_update_current_state; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tg_update_current_state AFTER INSERT ON public.activation_details FOR EACH ROW EXECUTE FUNCTION public.fn_update_current_state();


--
-- Name: eula tgr_autoupdate_modified; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified BEFORE UPDATE ON public.eula FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: activation_details tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.activation_details FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: activation_states tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.activation_states FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: association_map tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.association_map FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: associations tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.associations FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: course_types tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.course_types FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: ecommerce tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.ecommerce FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: global tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.global FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: gp_log tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.gp_log FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: history tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.history FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: crm_log tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.crm_log FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: crm_payload tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.crm_payload FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: player_details tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.player_details FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: player_emails_history tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.player_emails_history FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: player_login_sequence tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.player_login_sequence FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: player_franchise_contact tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.player_franchise_contact FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: player_franchise_rank tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.player_franchise_rank FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: players tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.players FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: players_licenses tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.players_licenses FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: players_licenses_duplicates tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.players_licenses_duplicates FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: orders tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.orders FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchise_courses tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchise_courses FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchise_gp tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchise_gp FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchise_product_map tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchise_product_map FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchise_type tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchise_type FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchise_type_old tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchise_type_old FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: franchises tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.franchises FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: proctor tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.proctor FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: proctor_log tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.proctor_log FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: product_code_map tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.product_code_map FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: product_kits tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.product_kits FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: product_login_sequence tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.product_login_sequence FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: product_login_sequence_step tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.product_login_sequence_step FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: product_title_translation tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.product_title_translation FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: products tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.products FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: quest_types tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.quest_types FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: quests tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.quests FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: quests_req_lics tgr_autoupdate_modified_column; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER tgr_autoupdate_modified_column BEFORE UPDATE ON public.quests_req_lics FOR EACH ROW EXECUTE FUNCTION public.fn_autoupdate_modified_column();


--
-- Name: activation_details ad_fk; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_details
    ADD CONSTRAINT ad_fk FOREIGN KEY (activation_id) REFERENCES public.activation_states(id);


--
-- Name: activation_details activation_details_activation_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_details
    ADD CONSTRAINT activation_details_activation_id_fkey FOREIGN KEY (activation_id) REFERENCES public.activation_states(id);


--
-- Name: activation_details activation_details_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.activation_details
    ADD CONSTRAINT activation_details_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: assoc_course_types assoc_course_types_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_course_types
    ADD CONSTRAINT assoc_course_types_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: assoc_franchise_gp_map assoc_franchise_gp_map_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_gp_map
    ADD CONSTRAINT assoc_franchise_gp_map_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: assoc_franchise_gp_map assoc_franchise_gp_map_gp_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_gp_map
    ADD CONSTRAINT assoc_franchise_gp_map_gp_id_fkey FOREIGN KEY (gp_id) REFERENCES public.franchise_gp(id) ON DELETE CASCADE;


--
-- Name: assoc_franchise_type_map assoc_franchise_type_map_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_type_map
    ADD CONSTRAINT assoc_franchise_type_map_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: assoc_franchise_type_map assoc_franchise_type_map_type_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_franchise_type_map
    ADD CONSTRAINT assoc_franchise_type_map_type_id_fkey FOREIGN KEY (type_id) REFERENCES public.franchise_type(id) ON DELETE CASCADE;


--
-- Name: assoc_quest_types assoc_quest_types_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.assoc_quest_types
    ADD CONSTRAINT assoc_quest_types_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: association_map association_map_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: association_map association_map_login_sequence_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_login_sequence_id_fkey FOREIGN KEY (login_sequence_id) REFERENCES public.product_login_sequence(id) ON DELETE CASCADE;


--
-- Name: association_map association_map_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: association_map association_map_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: association_map association_map_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: association_map association_map_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.association_map
    ADD CONSTRAINT association_map_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id) ON DELETE CASCADE;


--
-- Name: ceu_container ceu_container_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_container
    ADD CONSTRAINT ceu_container_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: ceu_container ceu_container_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_container
    ADD CONSTRAINT ceu_container_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: ceu ceu_parent_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu
    ADD CONSTRAINT ceu_parent_id_fkey FOREIGN KEY (parent_id) REFERENCES public.ceu_container(id) ON DELETE CASCADE;


--
-- Name: ceu_provider_assoc_map ceu_provider_assoc_map_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider_assoc_map
    ADD CONSTRAINT ceu_provider_assoc_map_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id) ON DELETE CASCADE;


--
-- Name: ceu_provider_assoc_map ceu_provider_assoc_map_provider_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu_provider_assoc_map
    ADD CONSTRAINT ceu_provider_assoc_map_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.ceu_provider(id) ON DELETE CASCADE;


--
-- Name: ceu ceu_provider_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ceu
    ADD CONSTRAINT ceu_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.ceu_provider(id) ON DELETE CASCADE;


--
-- Name: ecommerce ecommerce_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ecommerce
    ADD CONSTRAINT ecommerce_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: ecommerce ecommerce_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.ecommerce
    ADD CONSTRAINT ecommerce_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: gp_log gp_log_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.gp_log
    ADD CONSTRAINT gp_log_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: gp_log gp_log_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.gp_log
    ADD CONSTRAINT gp_log_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: gp_log gp_log_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.gp_log
    ADD CONSTRAINT gp_log_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: history history_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history
    ADD CONSTRAINT history_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: history history_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history
    ADD CONSTRAINT history_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: history history_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.history
    ADD CONSTRAINT history_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id) ON DELETE CASCADE;


--
-- Name: crm_log crm_log_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_log
    ADD CONSTRAINT crm_log_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id);


--
-- Name: crm_log crm_log_payload_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_log
    ADD CONSTRAINT crm_log_payload_id_fkey FOREIGN KEY (payload_id) REFERENCES public.crm_payload(id);


--
-- Name: crm_log crm_log_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.crm_log
    ADD CONSTRAINT crm_log_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id);


--
-- Name: marketing_tiles marketing_tiles_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.marketing_tiles
    ADD CONSTRAINT marketing_tiles_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: mceu mceu_parent_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mceu
    ADD CONSTRAINT mceu_parent_id_fkey FOREIGN KEY (parent_id) REFERENCES public.ceu_container(id) ON DELETE CASCADE;


--
-- Name: mceu mceu_provider_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mceu
    ADD CONSTRAINT mceu_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.ceu_provider(id) ON DELETE CASCADE;


--
-- Name: player_details player_details_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_details
    ADD CONSTRAINT player_details_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: player_emails_history player_emails_history_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_emails_history
    ADD CONSTRAINT player_emails_history_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: player_login_sequence player_login_sequence_login_sequence_name_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_login_sequence
    ADD CONSTRAINT player_login_sequence_login_sequence_name_fkey FOREIGN KEY (login_sequence_name) REFERENCES public.product_login_sequence_step(name) ON DELETE CASCADE;


--
-- Name: player_login_sequence player_login_sequence_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_login_sequence
    ADD CONSTRAINT player_login_sequence_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: player_login_sequence player_login_sequence_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_login_sequence
    ADD CONSTRAINT player_login_sequence_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: player_franchise_contact player_franchise_contact_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_contact
    ADD CONSTRAINT player_franchise_contact_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: player_franchise_contact player_franchise_contact_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_contact
    ADD CONSTRAINT player_franchise_contact_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: player_franchise_contact player_franchise_contact_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_contact
    ADD CONSTRAINT player_franchise_contact_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: player_franchise_rank player_franchise_rank_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_rank
    ADD CONSTRAINT player_franchise_rank_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: player_franchise_rank player_franchise_rank_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_rank
    ADD CONSTRAINT player_franchise_rank_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: player_franchise_rank player_franchise_rank_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.player_franchise_rank
    ADD CONSTRAINT player_franchise_rank_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: players_licenses players_licenses_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players_licenses
    ADD CONSTRAINT players_licenses_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: players_licenses players_licenses_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players_licenses
    ADD CONSTRAINT players_licenses_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: players_licenses players_licenses_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players_licenses
    ADD CONSTRAINT players_licenses_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: players players_pid_users_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players
    ADD CONSTRAINT players_pid_users_id_fkey FOREIGN KEY (principal_id) REFERENCES public.users(id);


--
-- Name: players players_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.players
    ADD CONSTRAINT players_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id);


--
-- Name: orders orders_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT orders_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: orders orders_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT orders_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: franchise_courses franchise_courses_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_courses
    ADD CONSTRAINT franchise_courses_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: franchise_courses franchise_courses_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_courses
    ADD CONSTRAINT franchise_courses_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: franchise_gp franchise_gp_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_gp
    ADD CONSTRAINT franchise_gp_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: franchise_product_map franchise_product_map_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_product_map
    ADD CONSTRAINT franchise_product_map_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id);


--
-- Name: franchise_product_map franchise_product_map_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_product_map
    ADD CONSTRAINT franchise_product_map_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: franchise_type franchise_type_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchise_type
    ADD CONSTRAINT franchise_type_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id);


--
-- Name: franchises franchises_franchise_type_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchises
    ADD CONSTRAINT franchises_franchise_type_fkey FOREIGN KEY (franchise_type) REFERENCES public.franchise_type(id);


--
-- Name: franchises franchises_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.franchises
    ADD CONSTRAINT franchises_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id);


--
-- Name: proctor_log proctor_log_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_log
    ADD CONSTRAINT proctor_log_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: proctor_log proctor_log_proctor_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_log
    ADD CONSTRAINT proctor_log_proctor_id_fkey FOREIGN KEY (proctor_id) REFERENCES public.proctor(id) ON DELETE CASCADE;


--
-- Name: proctor proctor_player_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor
    ADD CONSTRAINT proctor_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(id) ON DELETE CASCADE;


--
-- Name: proctor proctor_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor
    ADD CONSTRAINT proctor_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id) ON DELETE CASCADE;


--
-- Name: products product_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT product_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: product_code_map product_code_map_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_code_map
    ADD CONSTRAINT product_code_map_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: product_kits product_kits_kit_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_kits
    ADD CONSTRAINT product_kits_kit_id_fkey FOREIGN KEY (kit_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: product_kits product_kits_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_kits
    ADD CONSTRAINT product_kits_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: product_login_sequence_step product_login_sequence_step_login_sequence_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.product_login_sequence_step
    ADD CONSTRAINT product_login_sequence_step_login_sequence_id_fkey FOREIGN KEY (login_sequence_id) REFERENCES public.product_login_sequence(id) ON DELETE CASCADE;


--
-- Name: products products_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id);


--
-- Name: quests quests_course_type_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_course_type_fkey FOREIGN KEY (course_type) REFERENCES public.course_types(id);


--
-- Name: quests quests_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: quests quests_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id);


--
-- Name: quests_req_lics quests_req_lics_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics
    ADD CONSTRAINT quests_req_lics_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: quests_req_lics quests_req_lics_product_id_fkey1; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics
    ADD CONSTRAINT quests_req_lics_product_id_fkey1 FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: quests_req_lics quests_req_lics_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests_req_lics
    ADD CONSTRAINT quests_req_lics_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id);


--
-- Name: quests quests_quest_type_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT quests_quest_type_fkey FOREIGN KEY (quest_type) REFERENCES public.quest_types(id);


--
-- Name: quests association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.quests
    ADD CONSTRAINT association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: products association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: content content_container_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.content
    ADD CONSTRAINT content_container_id_fkey FOREIGN KEY (container_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: content content_translation_source_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.content
    ADD CONSTRAINT content_translation_source_fkey FOREIGN KEY (translation_source) REFERENCES public.content(content_id);


--
-- Name: credentials_assoc credentials_assoc_credentials_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.credentials_assoc
    ADD CONSTRAINT credentials_assoc_credentials_id_fkey FOREIGN KEY (credentials_id) REFERENCES public.credentials(id);


--
-- Name: credentials_assoc credentials_assoc_mailinglist_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.credentials_assoc
    ADD CONSTRAINT credentials_assoc_mailinglist_id_fkey FOREIGN KEY (mailinglist_id) REFERENCES public.mailinglist(id);


--
-- Name: customer_care_contact customer_care_contact_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_care_contact
    ADD CONSTRAINT customer_care_contact_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: customer_care_contact customer_care_contact_created_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_care_contact
    ADD CONSTRAINT customer_care_contact_created_by_fkey FOREIGN KEY (created_by) REFERENCES public.users(id);


--
-- Name: customer_care_contact customer_care_contact_modified_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_care_contact
    ADD CONSTRAINT customer_care_contact_modified_by_fkey FOREIGN KEY (modified_by) REFERENCES public.users(id);


--
-- Name: products dsf_parent_idx; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT dsf_parent_idx FOREIGN KEY (dsf_parent_id) REFERENCES public.products(id);


--
-- Name: eula_history eula_hist_id; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.eula_history
    ADD CONSTRAINT eula_hist_id FOREIGN KEY (eula_id) REFERENCES public.eula(id) ON DELETE CASCADE;


--
-- Name: files files_content_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.files
    ADD CONSTRAINT files_content_id_fkey FOREIGN KEY (content_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: mailinglist mailinglist_association_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist
    ADD CONSTRAINT mailinglist_association_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id);


--
-- Name: mailinglist_history mailinglist_history_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist_history
    ADD CONSTRAINT mailinglist_history_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id) ON DELETE CASCADE;


--
-- Name: mailinglist_history mailinglist_history_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist_history
    ADD CONSTRAINT mailinglist_history_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: mailinglist mailinglist_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.mailinglist
    ADD CONSTRAINT mailinglist_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(id) ON DELETE CASCADE;


--
-- Name: media media_content_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.media
    ADD CONSTRAINT media_content_id_fkey FOREIGN KEY (content_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: playerdata playerdata_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.playerdata
    ADD CONSTRAINT playerdata_id_fkey FOREIGN KEY (id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: proctor_provider ppasc_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.proctor_provider
    ADD CONSTRAINT ppasc_id_fkey FOREIGN KEY (association_id) REFERENCES public.associations(id) ON DELETE CASCADE;


--
-- Name: principalrole principalrole_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principalrole
    ADD CONSTRAINT principalrole_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: principalrole principalrole_role_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.principalrole
    ADD CONSTRAINT principalrole_role_id_fkey FOREIGN KEY (role_id) REFERENCES public.roles(id) ON DELETE CASCADE;


--
-- Name: relations relations_source_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.relations
    ADD CONSTRAINT relations_source_id_fkey FOREIGN KEY (source_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: relations relations_target_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.relations
    ADD CONSTRAINT relations_target_id_fkey FOREIGN KEY (target_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: usergroup usergroup_group_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.usergroup
    ADD CONSTRAINT usergroup_group_id_fkey FOREIGN KEY (group_id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: usergroup usergroup_principal_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.usergroup
    ADD CONSTRAINT usergroup_principal_id_fkey FOREIGN KEY (principal_id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: users users_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_id_fkey FOREIGN KEY (id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: vproperties vproperties_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vproperties
    ADD CONSTRAINT vproperties_id_fkey FOREIGN KEY (id) REFERENCES public.principals(id) ON DELETE CASCADE;


--
-- Name: vw_franchise_players_summary vw_franchise_players_summary_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_franchise_players_summary
    ADD CONSTRAINT vw_franchise_players_summary_id_fkey FOREIGN KEY (id) REFERENCES public.players(id);


--
-- Name: vw_franchise_players_summary vw_franchise_players_summary_franchise_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_franchise_players_summary
    ADD CONSTRAINT vw_franchise_players_summary_franchise_id_fkey FOREIGN KEY (franchise_id) REFERENCES public.franchises(id);


--
-- Name: vw_quest_avail_players vw_quest_avail_players_quest_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.vw_quest_avail_players
    ADD CONSTRAINT vw_quest_avail_players_quest_id_fkey FOREIGN KEY (quest_id) REFERENCES public.quests(id);


--
-- Name: workflow_entry workflow_entry_wf_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflow_entry
    ADD CONSTRAINT workflow_entry_wf_id_fkey FOREIGN KEY (wf_id) REFERENCES public.workflowhistory(wf_id) ON DELETE CASCADE;


--
-- Name: workflowhistory workflowhistory_content_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.workflowhistory
    ADD CONSTRAINT workflowhistory_content_id_fkey FOREIGN KEY (content_id) REFERENCES public.content(content_id) ON DELETE CASCADE;


--
-- Name: TABLE vw_code_profile; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_code_profile TO PUBLIC;


--
-- Name: TABLE vw_eula; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_eula TO PUBLIC;


--
-- Name: TABLE vw_orphan_users; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_orphan_users TO PUBLIC;


--
-- Name: TABLE vw_franchise_details; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_franchise_details TO PUBLIC;


--
-- Name: TABLE vw_franchise_inventory; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_franchise_inventory TO PUBLIC;


--
-- Name: TABLE vw_product_details; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_product_details TO PUBLIC;


--
-- Name: TABLE vw_quest_cur_players; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_quest_cur_players TO PUBLIC;


--
-- Name: TABLE vw_quest_details; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_quest_details TO PUBLIC;


--
-- Name: TABLE vw_tmp_quest_details; Type: ACL; Schema: public; Owner: -
--

GRANT SELECT ON TABLE public.vw_tmp_quest_details TO PUBLIC;


--
-- PostgreSQL database dump complete
--

