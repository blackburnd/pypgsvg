<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="3412pt" height="1178pt"
 viewBox="0.00 0.00 3412.13 1177.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow:hidden;">
<defs>
    <!-- Modern Arrowhead Markers -->
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3"
      orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 8 3, 0 6"
               style="fill: inherit; stroke: inherit; stroke-width: 0.5;
                      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));" />
    </marker>

    <marker id="arrowhead-large" markerWidth="14" markerHeight="10"
      refX="14" refY="5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 14 5, 0 10"
               style="fill: inherit; stroke: inherit; stroke-width: 0.5;
                      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));" />
    </marker>

    <!-- Enhanced Arrow with Curved Design -->
    <marker id="arrowhead-curved" markerWidth="10" markerHeight="8"
      refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M 0 0 Q 5 4 0 8 L 10 4 Z"
            style="fill: inherit; stroke: inherit; stroke-width: 0.3;
                   filter: drop-shadow(0 1px 3px rgba(0,0,0,0.15));" />
    </marker>

    <!-- Diamond Marker for Special Relationships -->
    <marker id="diamond" markerWidth="10" markerHeight="10" refX="5" refY="5"
      orient="auto" markerUnits="strokeWidth">
      <polygon points="5 0, 10 5, 5 10, 0 5"
               style="fill: #ffffff; stroke: inherit; stroke-width: 1.5;
                      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));" />
    </marker>

    <!-- Circle Marker for Self-References -->
    <marker id="circle" markerWidth="8" markerHeight="8" refX="4" refY="4"
      orient="auto" markerUnits="strokeWidth">
      <circle cx="4" cy="4" r="3"
              style="fill: #ffffff; stroke: inherit; stroke-width: 1.5;
                     filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));" />
    </marker>

    <!-- Gradient Definitions for Enhanced Visual Appeal -->
    <linearGradient id="tableGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%"
            style="stop-color: rgba(255,255,255,0.3); stop-opacity: 1" />
      <stop offset="100%"
            style="stop-color: rgba(0,0,0,0.1); stop-opacity: 1" />
    </linearGradient>

    <linearGradient id="edgeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color: inherit; stop-opacity: 0.8" />
      <stop offset="50%" style="stop-color: inherit; stop-opacity: 1" />
      <stop offset="100%" style="stop-color: inherit; stop-opacity: 0.8" />
    </linearGradient>

    <!-- Pattern Definitions for Different Edge Types -->
    <pattern id="dots" patternUnits="userSpaceOnUse" width="8" height="8">
      <circle cx="4" cy="4" r="1" fill="currentColor" opacity="0.6" />
    </pattern>

    <pattern id="dashes" patternUnits="userSpaceOnUse" width="12" height="4">
      <rect x="0" y="1" width="8" height="2" fill="currentColor"
            opacity="0.8" />
    </pattern>

    <!-- Filter Definitions for Enhanced Visual Effects -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <filter id="subtle-shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>

    <filter id="table-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="3" stdDeviation="4" flood-opacity="0.2"/>
    </filter>
    </defs>
<g id="main-erd-group" class="graph" transform="scale(1 1) rotate(0) translate(4 1173.5)" style="pointer-events: all;">
<polygon fill="white" stroke="none" points="-4,4 -4,-1173.5 3408.13,-1173.5 3408.13,4 -4,4"/>
<!-- app_log -->
<g id="app_log" class="node">
<title>app_log</title>

<polygon fill="#e8a8a8" stroke="none" points="8,-1128.5 8,-1165.5 261,-1165.5 261,-1128.5 8,-1128.5"/>
<polygon fill="none" stroke="black" points="8,-1128.5 8,-1165.5 261,-1165.5 261,-1128.5 8,-1128.5"/>
<text text-anchor="start" x="91.38" y="-1137.7" font-family="Arial" font-size="24.00">app_log</text>
<polygon fill="none" stroke="black" points="8,-1096.75 8,-1128.5 261,-1128.5 261,-1096.75 8,-1096.75"/>
<text text-anchor="start" x="13" y="-1107.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="28.75" y="-1107.4" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="8,-1065.75 8,-1096.75 261,-1096.75 261,-1065.75 8,-1065.75"/>
<text text-anchor="start" x="13" y="-1075.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="27.25" y="-1075.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="40" y="-1075.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="8,-1034.75 8,-1065.75 261,-1065.75 261,-1034.75 8,-1034.75"/>
<text text-anchor="start" x="13" y="-1043.65" font-family="Arial" font-size="18.00">timestamp (timestamptz)</text>
<polygon fill="none" stroke="black" points="8,-1003.75 8,-1034.75 261,-1034.75 261,-1003.75 8,-1003.75"/>
<text text-anchor="start" x="13" y="-1012.65" font-family="Arial" font-size="18.00">level (text)</text>
<polygon fill="none" stroke="black" points="8,-972.75 8,-1003.75 261,-1003.75 261,-972.75 8,-972.75"/>
<text text-anchor="start" x="13" y="-981.65" font-family="Arial" font-size="18.00">message (text)</text>
<polygon fill="none" stroke="black" points="8,-941.75 8,-972.75 261,-972.75 261,-941.75 8,-941.75"/>
<text text-anchor="start" x="13" y="-950.65" font-family="Arial" font-size="18.00">module (text)</text>
<polygon fill="none" stroke="black" points="8,-910.75 8,-941.75 261,-941.75 261,-910.75 8,-910.75"/>
<text text-anchor="start" x="13" y="-919.65" font-family="Arial" font-size="18.00">function (text)</text>
<polygon fill="none" stroke="black" points="8,-879.75 8,-910.75 261,-910.75 261,-879.75 8,-879.75"/>
<text text-anchor="start" x="13" y="-888.65" font-family="Arial" font-size="18.00">line (integer)</text>
<polygon fill="none" stroke="black" points="8,-848.75 8,-879.75 261,-879.75 261,-848.75 8,-848.75"/>
<text text-anchor="start" x="13" y="-857.65" font-family="Arial" font-size="18.00">user (text)</text>
<polygon fill="none" stroke="black" points="8,-817.75 8,-848.75 261,-848.75 261,-817.75 8,-817.75"/>
<text text-anchor="start" x="13" y="-826.65" font-family="Arial" font-size="18.00">extra (text)</text>
<polygon fill="none" stroke="black" points="8,-786.75 8,-817.75 261,-817.75 261,-786.75 8,-786.75"/>
<text text-anchor="start" x="13" y="-795.65" font-family="Arial" font-size="18.00">ip_address (varchar(45))</text>
<polygon fill="none" stroke="black" points="8,-755.75 8,-786.75 261,-786.75 261,-755.75 8,-755.75"/>
<text text-anchor="start" x="13" y="-764.65" font-family="Arial" font-size="18.00">user_agent (text)</text>
<polygon fill="none" stroke="black" points="8,-724.75 8,-755.75 261,-755.75 261,-724.75 8,-724.75"/>
<text text-anchor="start" x="13" y="-733.65" font-family="Arial" font-size="18.00">traceback (text)</text>
<polygon fill="none" stroke="black" points="8,-693.75 8,-724.75 261,-724.75 261,-693.75 8,-693.75"/>
<text text-anchor="start" x="13" y="-702.65" font-family="Arial" font-size="18.00">CONSTRAINT (app_log_pkey)</text>
</g>
<!-- portfolios -->
<g id="portfolios" class="node">
<title>portfolios</title>

<polygon fill="#7bb0c0" stroke="none" points="1936.62,-562.75 1936.62,-599.75 2208.38,-599.75 2208.38,-562.75 1936.62,-562.75"/>
<polygon fill="none" stroke="black" points="1936.62,-562.75 1936.62,-599.75 2208.38,-599.75 2208.38,-562.75 1936.62,-562.75"/>
<text text-anchor="start" x="2023.38" y="-571.95" font-family="Arial" font-size="24.00">portfolios</text>
<polygon fill="none" stroke="black" points="1936.62,-531 1936.62,-562.75 2208.38,-562.75 2208.38,-531 1936.62,-531"/>
<text text-anchor="start" x="1941.62" y="-541.65" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1957.38" y="-541.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1936.62,-500 1936.62,-531 2208.38,-531 2208.38,-500 1936.62,-500"/>
<text text-anchor="start" x="1941.62" y="-508.9" font-family="Arial" font-size="18.00">id (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-469 1936.62,-500 2208.38,-500 2208.38,-469 1936.62,-469"/>
<text text-anchor="start" x="1941.62" y="-477.9" font-family="Arial" font-size="18.00">name (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-438 1936.62,-469 2208.38,-469 2208.38,-438 1936.62,-438"/>
<text text-anchor="start" x="1941.62" y="-446.9" font-family="Arial" font-size="18.00">title (varchar(200))</text>
<polygon fill="none" stroke="black" points="1936.62,-407 1936.62,-438 2208.38,-438 2208.38,-407 1936.62,-407"/>
<text text-anchor="start" x="1941.62" y="-415.9" font-family="Arial" font-size="18.00">bio (text)</text>
<polygon fill="none" stroke="black" points="1936.62,-376 1936.62,-407 2208.38,-407 2208.38,-376 1936.62,-376"/>
<text text-anchor="start" x="1941.62" y="-384.9" font-family="Arial" font-size="18.00">tagline (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-345 1936.62,-376 2208.38,-376 2208.38,-345 1936.62,-345"/>
<text text-anchor="start" x="1941.62" y="-353.9" font-family="Arial" font-size="18.00">profile_image (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-314 1936.62,-345 2208.38,-345 2208.38,-314 1936.62,-314"/>
<text text-anchor="start" x="1941.62" y="-322.9" font-family="Arial" font-size="18.00">email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-283 1936.62,-314 2208.38,-314 2208.38,-283 1936.62,-283"/>
<text text-anchor="start" x="1941.62" y="-291.9" font-family="Arial" font-size="18.00">phone (varchar(20))</text>
<polygon fill="none" stroke="black" points="1936.62,-252 1936.62,-283 2208.38,-283 2208.38,-252 1936.62,-252"/>
<text text-anchor="start" x="1941.62" y="-260.9" font-family="Arial" font-size="18.00">vcard (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-221 1936.62,-252 2208.38,-252 2208.38,-221 1936.62,-221"/>
<text text-anchor="start" x="1941.62" y="-229.9" font-family="Arial" font-size="18.00">resume_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-190 1936.62,-221 2208.38,-221 2208.38,-190 1936.62,-190"/>
<text text-anchor="start" x="1941.62" y="-198.9" font-family="Arial" font-size="18.00">resume_download (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-159 1936.62,-190 2208.38,-190 2208.38,-159 1936.62,-159"/>
<text text-anchor="start" x="1941.62" y="-167.9" font-family="Arial" font-size="18.00">github (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-128 1936.62,-159 2208.38,-159 2208.38,-128 1936.62,-128"/>
<text text-anchor="start" x="1941.62" y="-136.9" font-family="Arial" font-size="18.00">twitter (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-97 1936.62,-128 2208.38,-128 2208.38,-97 1936.62,-97"/>
<text text-anchor="start" x="1941.62" y="-105.9" font-family="Arial" font-size="18.00">skills (jsonb)</text>
<polygon fill="none" stroke="black" points="1936.62,-66 1936.62,-97 2208.38,-97 2208.38,-66 1936.62,-66"/>
<text text-anchor="start" x="1941.62" y="-74.9" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1936.62,-35 1936.62,-66 2208.38,-66 2208.38,-35 1936.62,-35"/>
<text text-anchor="start" x="1941.62" y="-43.9" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1936.62,-4 1936.62,-35 2208.38,-35 2208.38,-4 1936.62,-4"/>
<text text-anchor="start" x="1941.62" y="-12.9" font-family="Arial" font-size="18.00">CONSTRAINT (portfolios_pkey)</text>
</g>
<!-- app_log&#45;&gt;portfolios -->
<g id="edge&#45;0" class="edge">
<title>app_log:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8a8a8" stroke-width="2.5" d="M262,-1080.25C304.59,-1081.39 255.06,-721.07 285.78,-689.05 412.34,-559.85 1697.37,-546.39 1922.87,-545.89"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M262,-1082.25C306.58,-1081.11 257.04,-720.8 287.22,-690.45 412.36,-561.85 1697.39,-548.39 1922.88,-547.89"/>
<polygon fill="#e8a8a8" stroke="#e8a8a8" stroke-width="2.5" points="1932.58,-546.88 1922.58,-551.39 1930.63,-547.63 1922.58,-547.64 1922.58,-546.89 1922.58,-546.14 1930.62,-546.13 1922.57,-542.39 1932.58,-546.88"/>
</g>
<!-- contact_messages -->
<g id="contact_messages" class="node">
<title>contact_messages</title>

<polygon fill="#e8b093" stroke="none" points="312.88,-1051 312.88,-1088 652.12,-1088 652.12,-1051 312.88,-1051"/>
<polygon fill="none" stroke="black" points="312.88,-1051 312.88,-1088 652.12,-1088 652.12,-1051 312.88,-1051"/>
<text text-anchor="start" x="381.62" y="-1060.2" font-family="Arial" font-size="24.00">contact_messages</text>
<polygon fill="none" stroke="black" points="312.88,-1019.25 312.88,-1051 652.12,-1051 652.12,-1019.25 312.88,-1019.25"/>
<text text-anchor="start" x="317.88" y="-1029.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="333.62" y="-1029.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="312.88,-988.25 312.88,-1019.25 652.12,-1019.25 652.12,-988.25 312.88,-988.25"/>
<text text-anchor="start" x="317.88" y="-998.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="332.12" y="-998.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="344.88" y="-998.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="312.88,-957.25 312.88,-988.25 652.12,-988.25 652.12,-957.25 312.88,-957.25"/>
<text text-anchor="start" x="317.88" y="-966.15" font-family="Arial" font-size="18.00">name (varchar(100))</text>
<polygon fill="none" stroke="black" points="312.88,-926.25 312.88,-957.25 652.12,-957.25 652.12,-926.25 312.88,-926.25"/>
<text text-anchor="start" x="317.88" y="-935.15" font-family="Arial" font-size="18.00">email (varchar(100))</text>
<polygon fill="none" stroke="black" points="312.88,-895.25 312.88,-926.25 652.12,-926.25 652.12,-895.25 312.88,-895.25"/>
<text text-anchor="start" x="317.88" y="-904.15" font-family="Arial" font-size="18.00">subject (varchar(300))</text>
<polygon fill="none" stroke="black" points="312.88,-864.25 312.88,-895.25 652.12,-895.25 652.12,-864.25 312.88,-864.25"/>
<text text-anchor="start" x="317.88" y="-873.15" font-family="Arial" font-size="18.00">message (text)</text>
<polygon fill="none" stroke="black" points="312.88,-833.25 312.88,-864.25 652.12,-864.25 652.12,-833.25 312.88,-833.25"/>
<text text-anchor="start" x="317.88" y="-842.15" font-family="Arial" font-size="18.00">is_read (boolean)</text>
<polygon fill="none" stroke="black" points="312.88,-802.25 312.88,-833.25 652.12,-833.25 652.12,-802.25 312.88,-802.25"/>
<text text-anchor="start" x="317.88" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="312.88,-771.25 312.88,-802.25 652.12,-802.25 652.12,-771.25 312.88,-771.25"/>
<text text-anchor="start" x="317.88" y="-780.15" font-family="Arial" font-size="18.00">CONSTRAINT (contact_messages_pkey)</text>
</g>
<!-- contact_messages&#45;&gt;portfolios -->
<g id="edge&#45;1" class="edge">
<title>contact_messages:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8b093" stroke-width="2.5" d="M653.12,-1002.75C687.13,-1003.87 652.21,-715.05 676.78,-689.06 772.58,-590.18 1741.76,-548.11 1922.68,-545.96"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M653.12,-1004.75C689.11,-1003.63 654.19,-714.81 678.22,-690.44 772.66,-592.18 1741.84,-550.11 1922.71,-547.96"/>
<polygon fill="#e8b093" stroke="#e8b093" stroke-width="2.5" points="1932.58,-546.9 1922.61,-551.46 1930.63,-547.66 1922.58,-547.71 1922.58,-546.96 1922.57,-546.21 1930.62,-546.16 1922.55,-542.46 1932.58,-546.9"/>
</g>
<!-- google_oauth_tokens -->
<g id="google_oauth_tokens" class="node">
<title>google_oauth_tokens</title>

<polygon fill="#e8c093" stroke="none" points="703.75,-1113 703.75,-1150 1063.25,-1150 1063.25,-1113 703.75,-1113"/>
<polygon fill="none" stroke="black" points="703.75,-1113 703.75,-1150 1063.25,-1150 1063.25,-1113 703.75,-1113"/>
<text text-anchor="start" x="767.62" y="-1122.2" font-family="Arial" font-size="24.00">google_oauth_tokens</text>
<polygon fill="none" stroke="black" points="703.75,-1081.25 703.75,-1113 1063.25,-1113 1063.25,-1081.25 703.75,-1081.25"/>
<text text-anchor="start" x="708.75" y="-1091.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="724.5" y="-1091.9" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="703.75,-1050.25 703.75,-1081.25 1063.25,-1081.25 1063.25,-1050.25 703.75,-1050.25"/>
<text text-anchor="start" x="708.75" y="-1060.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="723" y="-1060.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="735.75" y="-1060.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="703.75,-1019.25 703.75,-1050.25 1063.25,-1050.25 1063.25,-1019.25 703.75,-1019.25"/>
<text text-anchor="start" x="708.75" y="-1028.15" font-family="Arial" font-size="18.00">admin_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="703.75,-988.25 703.75,-1019.25 1063.25,-1019.25 1063.25,-988.25 703.75,-988.25"/>
<text text-anchor="start" x="708.75" y="-997.15" font-family="Arial" font-size="18.00">access_token (text)</text>
<polygon fill="none" stroke="black" points="703.75,-957.25 703.75,-988.25 1063.25,-988.25 1063.25,-957.25 703.75,-957.25"/>
<text text-anchor="start" x="708.75" y="-966.15" font-family="Arial" font-size="18.00">refresh_token (text)</text>
<polygon fill="none" stroke="black" points="703.75,-926.25 703.75,-957.25 1063.25,-957.25 1063.25,-926.25 703.75,-926.25"/>
<text text-anchor="start" x="708.75" y="-935.15" font-family="Arial" font-size="18.00">token_expires_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-895.25 703.75,-926.25 1063.25,-926.25 1063.25,-895.25 703.75,-895.25"/>
<text text-anchor="start" x="708.75" y="-904.15" font-family="Arial" font-size="18.00">granted_scopes (text)</text>
<polygon fill="none" stroke="black" points="703.75,-864.25 703.75,-895.25 1063.25,-895.25 1063.25,-864.25 703.75,-864.25"/>
<text text-anchor="start" x="708.75" y="-873.15" font-family="Arial" font-size="18.00">requested_scopes (text)</text>
<polygon fill="none" stroke="black" points="703.75,-833.25 703.75,-864.25 1063.25,-864.25 1063.25,-833.25 703.75,-833.25"/>
<text text-anchor="start" x="708.75" y="-842.15" font-family="Arial" font-size="18.00">last_used_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-802.25 703.75,-833.25 1063.25,-833.25 1063.25,-802.25 703.75,-802.25"/>
<text text-anchor="start" x="708.75" y="-811.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="703.75,-771.25 703.75,-802.25 1063.25,-802.25 1063.25,-771.25 703.75,-771.25"/>
<text text-anchor="start" x="708.75" y="-780.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-740.25 703.75,-771.25 1063.25,-771.25 1063.25,-740.25 703.75,-740.25"/>
<text text-anchor="start" x="708.75" y="-749.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-709.25 703.75,-740.25 1063.25,-740.25 1063.25,-709.25 703.75,-709.25"/>
<text text-anchor="start" x="708.75" y="-718.15" font-family="Arial" font-size="18.00">CONSTRAINT (google_oauth_tokens_pkey)</text>
</g>
<!-- google_oauth_tokens&#45;&gt;portfolios -->
<g id="edge&#45;2" class="edge">
<title>google_oauth_tokens:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8c093" stroke-width="2.5" d="M1064.25,-1064.75C1105.12,-1065.88 1059.46,-720.96 1087.76,-689.08 1213.63,-550.05 1722.19,-545.99 1922.86,-545.88"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1064.25,-1066.75C1107.11,-1065.62 1061.45,-720.7 1089.24,-690.42 1213.65,-552.05 1722.21,-547.99 1922.86,-547.88"/>
<polygon fill="#e8c093" stroke="#e8c093" stroke-width="2.5" points="1932.58,-546.88 1922.58,-551.38 1930.63,-547.63 1922.58,-547.63 1922.58,-546.88 1922.58,-546.13 1930.62,-546.13 1922.58,-542.38 1932.58,-546.88"/>
</g>
<!-- linkedin_oauth_config -->
<g id="linkedin_oauth_config" class="node">
<title>linkedin_oauth_config</title>

<polygon fill="#e8d8a8" stroke="none" points="1115,-1082 1115,-1119 1476,-1119 1476,-1082 1115,-1082"/>
<polygon fill="none" stroke="black" points="1115,-1082 1115,-1119 1476,-1119 1476,-1082 1115,-1082"/>
<text text-anchor="start" x="1178.5" y="-1091.2" font-family="Arial" font-size="24.00">linkedin_oauth_config</text>
<polygon fill="none" stroke="black" points="1115,-1050.25 1115,-1082 1476,-1082 1476,-1050.25 1115,-1050.25"/>
<text text-anchor="start" x="1120" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1135.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1115,-1019.25 1115,-1050.25 1476,-1050.25 1476,-1019.25 1115,-1019.25"/>
<text text-anchor="start" x="1120" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="1134.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="1147" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1115,-988.25 1115,-1019.25 1476,-1019.25 1476,-988.25 1115,-988.25"/>
<text text-anchor="start" x="1120" y="-997.15" font-family="Arial" font-size="18.00">app_name (varchar(200))</text>
<polygon fill="none" stroke="black" points="1115,-957.25 1115,-988.25 1476,-988.25 1476,-957.25 1115,-957.25"/>
<text text-anchor="start" x="1120" y="-966.15" font-family="Arial" font-size="18.00">client_id (varchar(200))</text>
<polygon fill="none" stroke="black" points="1115,-926.25 1115,-957.25 1476,-957.25 1476,-926.25 1115,-926.25"/>
<text text-anchor="start" x="1120" y="-935.15" font-family="Arial" font-size="18.00">client_secret (text)</text>
<polygon fill="none" stroke="black" points="1115,-895.25 1115,-926.25 1476,-926.25 1476,-895.25 1115,-895.25"/>
<text text-anchor="start" x="1120" y="-904.15" font-family="Arial" font-size="18.00">redirect_uri (varchar(500))</text>
<polygon fill="none" stroke="black" points="1115,-864.25 1115,-895.25 1476,-895.25 1476,-864.25 1115,-864.25"/>
<text text-anchor="start" x="1120" y="-873.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="1115,-833.25 1115,-864.25 1476,-864.25 1476,-833.25 1115,-833.25"/>
<text text-anchor="start" x="1120" y="-842.15" font-family="Arial" font-size="18.00">configured_by_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1115,-802.25 1115,-833.25 1476,-833.25 1476,-802.25 1115,-802.25"/>
<text text-anchor="start" x="1120" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1115,-771.25 1115,-802.25 1476,-802.25 1476,-771.25 1115,-771.25"/>
<text text-anchor="start" x="1120" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1115,-740.25 1115,-771.25 1476,-771.25 1476,-740.25 1115,-740.25"/>
<text text-anchor="start" x="1120" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_config_pkey)</text>
</g>
<!-- linkedin_oauth_config&#45;&gt;portfolios -->
<g id="edge&#45;3" class="edge">
<title>linkedin_oauth_config:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8d8a8" stroke-width="2.5" d="M1477,-1033.75C1514.44,-1034.87 1477.85,-720.16 1501.71,-689.13 1562.14,-612.1 1812.8,-550.97 1922.62,-546.18"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1477,-1035.75C1516.43,-1034.63 1479.84,-719.93 1503.29,-690.37 1562.62,-614.04 1813.27,-552.92 1922.71,-548.17"/>
<polygon fill="#e8d8a8" stroke="#e8d8a8" stroke-width="2.5" points="1932.58,-546.95 1922.69,-551.68 1930.64,-547.74 1922.6,-547.93 1922.58,-547.18 1922.57,-546.43 1930.61,-546.24 1922.48,-542.68 1932.58,-546.95"/>
</g>
<!-- linkedin_oauth_connections -->
<g id="linkedin_oauth_connections" class="node">
<title>linkedin_oauth_connections</title>

<polygon fill="#b8d1a8" stroke="none" points="1528.38,-1097.5 1528.38,-1134.5 1936.62,-1134.5 1936.62,-1097.5 1528.38,-1097.5"/>
<polygon fill="none" stroke="black" points="1528.38,-1097.5 1528.38,-1134.5 1936.62,-1134.5 1936.62,-1097.5 1528.38,-1097.5"/>
<text text-anchor="start" x="1583.25" y="-1106.7" font-family="Arial" font-size="24.00">linkedin_oauth_connections</text>
<polygon fill="none" stroke="black" points="1528.38,-1065.75 1528.38,-1097.5 1936.62,-1097.5 1936.62,-1065.75 1528.38,-1065.75"/>
<text text-anchor="start" x="1533.38" y="-1076.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1549.12" y="-1076.4" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1528.38,-1034.75 1528.38,-1065.75 1936.62,-1065.75 1936.62,-1034.75 1528.38,-1034.75"/>
<text text-anchor="start" x="1533.38" y="-1044.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="1547.62" y="-1044.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="1560.38" y="-1044.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1528.38,-1003.75 1528.38,-1034.75 1936.62,-1034.75 1936.62,-1003.75 1528.38,-1003.75"/>
<text text-anchor="start" x="1533.38" y="-1012.65" font-family="Arial" font-size="18.00">admin_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1528.38,-972.75 1528.38,-1003.75 1936.62,-1003.75 1936.62,-972.75 1528.38,-972.75"/>
<text text-anchor="start" x="1533.38" y="-981.65" font-family="Arial" font-size="18.00">access_token (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-941.75 1528.38,-972.75 1936.62,-972.75 1936.62,-941.75 1528.38,-941.75"/>
<text text-anchor="start" x="1533.38" y="-950.65" font-family="Arial" font-size="18.00">refresh_token (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-910.75 1528.38,-941.75 1936.62,-941.75 1936.62,-910.75 1528.38,-910.75"/>
<text text-anchor="start" x="1533.38" y="-919.65" font-family="Arial" font-size="18.00">token_expires_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-879.75 1528.38,-910.75 1936.62,-910.75 1936.62,-879.75 1528.38,-879.75"/>
<text text-anchor="start" x="1533.38" y="-888.65" font-family="Arial" font-size="18.00">granted_scopes (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-848.75 1528.38,-879.75 1936.62,-879.75 1936.62,-848.75 1528.38,-848.75"/>
<text text-anchor="start" x="1533.38" y="-857.65" font-family="Arial" font-size="18.00">requested_scopes (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-817.75 1528.38,-848.75 1936.62,-848.75 1936.62,-817.75 1528.38,-817.75"/>
<text text-anchor="start" x="1533.38" y="-826.65" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="1528.38,-786.75 1528.38,-817.75 1936.62,-817.75 1936.62,-786.75 1528.38,-786.75"/>
<text text-anchor="start" x="1533.38" y="-795.65" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-755.75 1528.38,-786.75 1936.62,-786.75 1936.62,-755.75 1528.38,-755.75"/>
<text text-anchor="start" x="1533.38" y="-764.65" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-724.75 1528.38,-755.75 1936.62,-755.75 1936.62,-724.75 1528.38,-724.75"/>
<text text-anchor="start" x="1533.38" y="-733.65" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_connections_pkey)</text>
</g>
<!-- linkedin_oauth_connections&#45;&gt;portfolios -->
<g id="edge&#45;4" class="edge">
<title>linkedin_oauth_connections:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#b8d1a8" stroke-width="2.5" d="M1937.62,-1049.25C1973.24,-1050.38 1935.79,-757.49 1935.63,-720.75 1935.51,-648.91 1866.99,-559.48 1922.7,-547"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1937.62,-1051.25C1975.23,-1050.12 1937.78,-757.23 1937.62,-720.75 1937.1,-647.69 1868.58,-558.27 1923.09,-548.96"/>
<polygon fill="#b8d1a8" stroke="#b8d1a8" stroke-width="2.5" points="1932.59,-547.14 1923.02,-552.49 1930.71,-548.05 1922.69,-548.75 1922.63,-548 1922.56,-547.25 1930.58,-546.56 1922.24,-543.52 1932.59,-547.14"/>
</g>
<!-- linkedin_oauth_scopes -->
<g id="linkedin_oauth_scopes" class="node">
<title>linkedin_oauth_scopes</title>

<polygon fill="#93c4b8" stroke="none" points="1988.5,-1082 1988.5,-1119 2358.5,-1119 2358.5,-1082 1988.5,-1082"/>
<polygon fill="none" stroke="black" points="1988.5,-1082 1988.5,-1119 2358.5,-1119 2358.5,-1082 1988.5,-1082"/>
<text text-anchor="start" x="2050.5" y="-1091.2" font-family="Arial" font-size="24.00">linkedin_oauth_scopes</text>
<polygon fill="none" stroke="black" points="1988.5,-1050.25 1988.5,-1082 2358.5,-1082 2358.5,-1050.25 1988.5,-1050.25"/>
<text text-anchor="start" x="1993.5" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2009.25" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1988.5,-1019.25 1988.5,-1050.25 2358.5,-1050.25 2358.5,-1019.25 1988.5,-1019.25"/>
<text text-anchor="start" x="1993.5" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2007.75" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2020.5" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1988.5,-988.25 1988.5,-1019.25 2358.5,-1019.25 2358.5,-988.25 1988.5,-988.25"/>
<text text-anchor="start" x="1993.5" y="-997.15" font-family="Arial" font-size="18.00">scope_name (varchar(100))</text>
<polygon fill="none" stroke="black" points="1988.5,-957.25 1988.5,-988.25 2358.5,-988.25 2358.5,-957.25 1988.5,-957.25"/>
<text text-anchor="start" x="1993.5" y="-966.15" font-family="Arial" font-size="18.00">display_name (varchar(200))</text>
<polygon fill="none" stroke="black" points="1988.5,-926.25 1988.5,-957.25 2358.5,-957.25 2358.5,-926.25 1988.5,-926.25"/>
<text text-anchor="start" x="1993.5" y="-935.15" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="1988.5,-895.25 1988.5,-926.25 2358.5,-926.25 2358.5,-895.25 1988.5,-895.25"/>
<text text-anchor="start" x="1993.5" y="-904.15" font-family="Arial" font-size="18.00">data_access_description (text)</text>
<polygon fill="none" stroke="black" points="1988.5,-864.25 1988.5,-895.25 2358.5,-895.25 2358.5,-864.25 1988.5,-864.25"/>
<text text-anchor="start" x="1993.5" y="-873.15" font-family="Arial" font-size="18.00">is_required (boolean)</text>
<polygon fill="none" stroke="black" points="1988.5,-833.25 1988.5,-864.25 2358.5,-864.25 2358.5,-833.25 1988.5,-833.25"/>
<text text-anchor="start" x="1993.5" y="-842.15" font-family="Arial" font-size="18.00">is_enabled (boolean)</text>
<polygon fill="none" stroke="black" points="1988.5,-802.25 1988.5,-833.25 2358.5,-833.25 2358.5,-802.25 1988.5,-802.25"/>
<text text-anchor="start" x="1993.5" y="-811.15" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="1988.5,-771.25 1988.5,-802.25 2358.5,-802.25 2358.5,-771.25 1988.5,-771.25"/>
<text text-anchor="start" x="1993.5" y="-780.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1988.5,-740.25 1988.5,-771.25 2358.5,-771.25 2358.5,-740.25 1988.5,-740.25"/>
<text text-anchor="start" x="1993.5" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_scopes_pkey)</text>
</g>
<!-- linkedin_oauth_scopes&#45;&gt;portfolios -->
<g id="edge&#45;5" class="edge">
<title>linkedin_oauth_scopes:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#93c4b8" stroke-width="2.5" d="M2359.5,-1033.75C2391.67,-1034.8 2377.17,-763.01 2357.69,-736.84 2242.63,-578.73 2055.01,-761.86 1935.82,-604.35 1923.98,-588.43 1914.66,-562.97 1922.87,-551.3"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M2359.5,-1035.75C2393.67,-1034.7 2379.17,-762.9 2359.31,-735.66 2241.24,-577.3 2053.61,-760.43 1937.43,-603.15 1925.85,-587.75 1916.54,-562.29 1924.47,-552.5"/>
<polygon fill="#93c4b8" stroke="#93c4b8" stroke-width="2.5" points="1932.82,-548.06 1925.34,-556.08 1931.31,-549.5 1923.89,-552.62 1923.6,-551.93 1923.31,-551.24 1930.73,-548.12 1921.85,-547.78 1932.82,-548.06"/>
</g>
<!-- oauth_apps -->
<g id="oauth_apps" class="node">
<title>oauth_apps</title>

<polygon fill="#9bb0c0" stroke="none" points="2411,-1082 2411,-1119 2694,-1119 2694,-1082 2411,-1082"/>
<polygon fill="none" stroke="black" points="2411,-1082 2411,-1119 2694,-1119 2694,-1082 2411,-1082"/>
<text text-anchor="start" x="2489.12" y="-1091.2" font-family="Arial" font-size="24.00">oauth_apps</text>
<polygon fill="none" stroke="black" points="2411,-1050.25 2411,-1082 2694,-1082 2694,-1050.25 2411,-1050.25"/>
<text text-anchor="start" x="2416" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2431.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="2411,-1019.25 2411,-1050.25 2694,-1050.25 2694,-1019.25 2411,-1019.25"/>
<text text-anchor="start" x="2416" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2430.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2443" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="2411,-988.25 2411,-1019.25 2694,-1019.25 2694,-988.25 2411,-988.25"/>
<text text-anchor="start" x="2416" y="-997.15" font-family="Arial" font-size="18.00">provider (varchar(50))</text>
<polygon fill="none" stroke="black" points="2411,-957.25 2411,-988.25 2694,-988.25 2694,-957.25 2411,-957.25"/>
<text text-anchor="start" x="2416" y="-966.15" font-family="Arial" font-size="18.00">client_id (text)</text>
<polygon fill="none" stroke="black" points="2411,-926.25 2411,-957.25 2694,-957.25 2694,-926.25 2411,-926.25"/>
<text text-anchor="start" x="2416" y="-935.15" font-family="Arial" font-size="18.00">client_secret (text)</text>
<polygon fill="none" stroke="black" points="2411,-895.25 2411,-926.25 2694,-926.25 2694,-895.25 2411,-895.25"/>
<text text-anchor="start" x="2416" y="-904.15" font-family="Arial" font-size="18.00">redirect_uri (text)</text>
<polygon fill="none" stroke="black" points="2411,-864.25 2411,-895.25 2694,-895.25 2694,-864.25 2411,-864.25"/>
<text text-anchor="start" x="2416" y="-873.15" font-family="Arial" font-size="18.00">scopes (text)</text>
<polygon fill="none" stroke="black" points="2411,-833.25 2411,-864.25 2694,-864.25 2694,-833.25 2411,-833.25"/>
<text text-anchor="start" x="2416" y="-842.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="2411,-802.25 2411,-833.25 2694,-833.25 2694,-802.25 2411,-802.25"/>
<text text-anchor="start" x="2416" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamp)</text>
<polygon fill="none" stroke="black" points="2411,-771.25 2411,-802.25 2694,-802.25 2694,-771.25 2411,-771.25"/>
<text text-anchor="start" x="2416" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamp)</text>
<polygon fill="none" stroke="black" points="2411,-740.25 2411,-771.25 2694,-771.25 2694,-740.25 2411,-740.25"/>
<text text-anchor="start" x="2416" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (oauth_apps_pkey)</text>
</g>
<!-- oauth_apps&#45;&gt;portfolios -->
<g id="edge&#45;6" class="edge">
<title>oauth_apps:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#9bb0c0" stroke-width="2.5" d="M2695,-1033.75C2727.17,-1034.8 2714.38,-761.65 2693.24,-736.89 2584.1,-606.59 2047.92,-734.57 1935.87,-604.4 1922.84,-589.06 1914.02,-562.79 1923,-551.06"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M2695,-1035.75C2729.17,-1034.7 2716.38,-761.56 2694.76,-735.61 2583.63,-604.65 2047.45,-732.62 1937.38,-603.1 1924.73,-588.42 1915.92,-562.15 1924.55,-552.33"/>
<polygon fill="#9bb0c0" stroke="#9bb0c0" stroke-width="2.5" points="1932.8,-548.02 1925.24,-555.96 1931.28,-549.45 1923.82,-552.49 1923.54,-551.79 1923.26,-551.1 1930.71,-548.06 1921.84,-547.62 1932.8,-548.02"/>
</g>
<!-- projects -->
<g id="projects" class="node">
<title>projects</title>

<polygon fill="#98b8b8" stroke="none" points="2746,-1082 2746,-1119 2999,-1119 2999,-1082 2746,-1082"/>
<polygon fill="none" stroke="black" points="2746,-1082 2746,-1119 2999,-1119 2999,-1082 2746,-1082"/>
<text text-anchor="start" x="2830.12" y="-1091.2" font-family="Arial" font-size="24.00">projects</text>
<polygon fill="none" stroke="black" points="2746,-1050.25 2746,-1082 2999,-1082 2999,-1050.25 2746,-1050.25"/>
<text text-anchor="start" x="2751" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2766.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="2746,-1019.25 2746,-1050.25 2999,-1050.25 2999,-1019.25 2746,-1019.25"/>
<text text-anchor="start" x="2751" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2765.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2778" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="2746,-988.25 2746,-1019.25 2999,-1019.25 2999,-988.25 2746,-988.25"/>
<text text-anchor="start" x="2751" y="-997.15" font-family="Arial" font-size="18.00">title (varchar(200))</text>
<polygon fill="none" stroke="black" points="2746,-957.25 2746,-988.25 2999,-988.25 2999,-957.25 2746,-957.25"/>
<text text-anchor="start" x="2751" y="-966.15" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="2746,-926.25 2746,-957.25 2999,-957.25 2999,-926.25 2746,-926.25"/>
<text text-anchor="start" x="2751" y="-935.15" font-family="Arial" font-size="18.00">url (varchar(300))</text>
<polygon fill="none" stroke="black" points="2746,-895.25 2746,-926.25 2999,-926.25 2999,-895.25 2746,-895.25"/>
<text text-anchor="start" x="2751" y="-904.15" font-family="Arial" font-size="18.00">image_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="2746,-864.25 2746,-895.25 2999,-895.25 2999,-864.25 2746,-864.25"/>
<text text-anchor="start" x="2751" y="-873.15" font-family="Arial" font-size="18.00">technologies (jsonb)</text>
<polygon fill="none" stroke="black" points="2746,-833.25 2746,-864.25 2999,-864.25 2999,-833.25 2746,-833.25"/>
<text text-anchor="start" x="2751" y="-842.15" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="2746,-802.25 2746,-833.25 2999,-833.25 2999,-802.25 2746,-802.25"/>
<text text-anchor="start" x="2751" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="2746,-771.25 2746,-802.25 2999,-802.25 2999,-771.25 2746,-771.25"/>
<text text-anchor="start" x="2751" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="2746,-740.25 2746,-771.25 2999,-771.25 2999,-740.25 2746,-740.25"/>
<text text-anchor="start" x="2751" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (projects_pkey)</text>
</g>
<!-- projects&#45;&gt;portfolios -->
<g id="edge&#45;7" class="edge">
<title>projects:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#98b8b8" stroke-width="2.5" d="M3000,-1033.75C3032.17,-1034.8 3019.48,-761.57 2998.24,-736.9 2918.41,-641.36 2845.48,-707.67 2720.36,-690.74 2547.05,-666.75 2054.86,-734.2 1935.89,-604.42 1922.36,-589.47 1913.81,-562.96 1922.94,-551.12"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M3000,-1035.75C3034.17,-1034.7 3021.48,-761.48 2999.76,-735.6 2917.07,-639.88 2844.14,-706.19 2720.64,-688.76 2546.78,-664.76 2054.59,-732.22 1937.36,-603.08 1924.27,-588.85 1915.71,-562.35 1924.48,-552.39"/>
<polygon fill="#98b8b8" stroke="#98b8b8" stroke-width="2.5" points="1932.81,-548.03 1925.26,-555.98 1931.28,-549.46 1923.84,-552.51 1923.55,-551.82 1923.27,-551.13 1930.71,-548.08 1921.85,-547.65 1932.81,-548.03"/>
</g>
<!-- work_experience -->
<g id="work_experience" class="node">
<title>work_experience</title>

<polygon fill="#e8b8a8" stroke="none" points="3051.38,-1128.5 3051.38,-1165.5 3375.62,-1165.5 3375.62,-1128.5 3051.38,-1128.5"/>
<polygon fill="none" stroke="black" points="3051.38,-1128.5 3051.38,-1165.5 3375.62,-1165.5 3375.62,-1128.5 3051.38,-1128.5"/>
<text text-anchor="start" x="3122" y="-1137.7" font-family="Arial" font-size="24.00">work_experience</text>
<polygon fill="none" stroke="black" points="3051.38,-1096.75 3051.38,-1128.5 3375.62,-1128.5 3375.62,-1096.75 3051.38,-1096.75"/>
<text text-anchor="start" x="3056.38" y="-1107.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="3072.12" y="-1107.4" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="3051.38,-1065.75 3051.38,-1096.75 3375.62,-1096.75 3375.62,-1065.75 3051.38,-1065.75"/>
<text text-anchor="start" x="3056.38" y="-1075.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="3070.62" y="-1075.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="3083.38" y="-1075.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="3051.38,-1034.75 3051.38,-1065.75 3375.62,-1065.75 3375.62,-1034.75 3051.38,-1034.75"/>
<text text-anchor="start" x="3056.38" y="-1043.65" font-family="Arial" font-size="18.00">company (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-1003.75 3051.38,-1034.75 3375.62,-1034.75 3375.62,-1003.75 3051.38,-1003.75"/>
<text text-anchor="start" x="3056.38" y="-1012.65" font-family="Arial" font-size="18.00">position (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-972.75 3051.38,-1003.75 3375.62,-1003.75 3375.62,-972.75 3051.38,-972.75"/>
<text text-anchor="start" x="3056.38" y="-981.65" font-family="Arial" font-size="18.00">location (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-941.75 3051.38,-972.75 3375.62,-972.75 3375.62,-941.75 3051.38,-941.75"/>
<text text-anchor="start" x="3056.38" y="-950.65" font-family="Arial" font-size="18.00">start_date (varchar(20))</text>
<polygon fill="none" stroke="black" points="3051.38,-910.75 3051.38,-941.75 3375.62,-941.75 3375.62,-910.75 3051.38,-910.75"/>
<text text-anchor="start" x="3056.38" y="-919.65" font-family="Arial" font-size="18.00">end_date (varchar(20))</text>
<polygon fill="none" stroke="black" points="3051.38,-879.75 3051.38,-910.75 3375.62,-910.75 3375.62,-879.75 3051.38,-879.75"/>
<text text-anchor="start" x="3056.38" y="-888.65" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="3051.38,-848.75 3051.38,-879.75 3375.62,-879.75 3375.62,-848.75 3051.38,-848.75"/>
<text text-anchor="start" x="3056.38" y="-857.65" font-family="Arial" font-size="18.00">is_current (boolean)</text>
<polygon fill="none" stroke="black" points="3051.38,-817.75 3051.38,-848.75 3375.62,-848.75 3375.62,-817.75 3051.38,-817.75"/>
<text text-anchor="start" x="3056.38" y="-826.65" font-family="Arial" font-size="18.00">company_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="3051.38,-786.75 3051.38,-817.75 3375.62,-817.75 3375.62,-786.75 3051.38,-786.75"/>
<text text-anchor="start" x="3056.38" y="-795.65" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="3051.38,-755.75 3051.38,-786.75 3375.62,-786.75 3375.62,-755.75 3051.38,-755.75"/>
<text text-anchor="start" x="3056.38" y="-764.65" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="3051.38,-724.75 3051.38,-755.75 3375.62,-755.75 3375.62,-724.75 3051.38,-724.75"/>
<text text-anchor="start" x="3056.38" y="-733.65" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="3051.38,-693.75 3051.38,-724.75 3375.62,-724.75 3375.62,-693.75 3051.38,-693.75"/>
<text text-anchor="start" x="3056.38" y="-702.65" font-family="Arial" font-size="18.00">CONSTRAINT (work_experience_pkey)</text>
</g>
<!-- work_experience&#45;&gt;portfolios -->
<g id="edge&#45;8" class="edge">
<title>work_experience:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8b8a8" stroke-width="2.5" d="M3376.62,-1080.25C3419.13,-1081.29 3404.49,-721.42 3374.9,-690.44 3156.02,-457.79 2158.68,-835.92 1935.9,-604.44 1922,-589.79 1913.65,-563.1 1922.89,-551.17"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M3376.62,-1082.25C3421.12,-1081.21 3406.49,-721.33 3376.35,-689.06 3155.31,-455.92 2157.97,-834.05 1937.35,-603.06 1923.91,-589.19 1915.56,-562.5 1924.43,-552.44"/>
<polygon fill="#e8b8a8" stroke="#e8b8a8" stroke-width="2.5" points="1932.81,-548.03 1925.28,-556 1931.29,-549.47 1923.85,-552.54 1923.56,-551.84 1923.28,-551.15 1930.72,-548.09 1921.85,-547.68 1932.81,-548.03"/>
</g>
</g>
<script id="graph-data" type="application/json">{"tables": {"app_log": {"defaultColor": "#E8A8A8", "highlightColor": "#fe9191", "desaturatedColor": "#cbc4c4", "triggers": [], "constraints": [], "edges": ["edge-0"]}, "contact_messages": {"defaultColor": "#E8B093", "highlightColor": "#ffa87c", "desaturatedColor": "#c1bcb9", "triggers": [], "constraints": [], "edges": ["edge-1"]}, "google_oauth_tokens": {"defaultColor": "#E8C093", "highlightColor": "#ffc17c", "desaturatedColor": "#c1bdb9", "triggers": [], "constraints": [], "edges": ["edge-2"]}, "linkedin_oauth_config": {"defaultColor": "#E8D8A8", "highlightColor": "#fee391", "desaturatedColor": "#cbc9c4", "triggers": [], "constraints": [], "edges": ["edge-3"]}, "linkedin_oauth_connections": {"defaultColor": "#B8D1A8", "highlightColor": "#adff7a", "desaturatedColor": "#bcbeba", "triggers": [], "constraints": [], "edges": ["edge-4"]}, "linkedin_oauth_scopes": {"defaultColor": "#93C4B8", "highlightColor": "#58ffd6", "desaturatedColor": "#a9adac", "triggers": [], "constraints": [], "edges": ["edge-5"]}, "oauth_apps": {"defaultColor": "#9BB0C0", "highlightColor": "#63b7f7", "desaturatedColor": "#abadaf", "triggers": [], "constraints": [], "edges": ["edge-6"]}, "portfolios": {"defaultColor": "#7BB0C0", "highlightColor": "#3cd1ff", "desaturatedColor": "#9a9fa0", "triggers": [], "constraints": [], "edges": ["edge-0", "edge-1", "edge-2", "edge-3", "edge-4", "edge-5", "edge-6", "edge-7", "edge-8"]}, "projects": {"defaultColor": "#98B8B8", "highlightColor": "#67e8e8", "desaturatedColor": "#a6a9a9", "triggers": [], "constraints": [], "edges": ["edge-7"]}, "work_experience": {"defaultColor": "#E8B8A8", "highlightColor": "#feac91", "desaturatedColor": "#cbc6c4", "triggers": [], "constraints": [], "edges": ["edge-8"]}}, "edges": {"edge-0": {"tables": ["app_log", "portfolios"], "defaultColor": "#E8A8A8", "highlightColor": "#fe9191", "desaturatedColor": "#d8b7b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE app_log \n    ADD CONSTRAINT app_log_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-1": {"tables": ["contact_messages", "portfolios"], "defaultColor": "#E8B093", "highlightColor": "#ffa87c", "desaturatedColor": "#d2b6a8", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE contact_messages \n    ADD CONSTRAINT contact_messages_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-2": {"tables": ["google_oauth_tokens", "portfolios"], "defaultColor": "#E8C093", "highlightColor": "#ffc17c", "desaturatedColor": "#d2bea8", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE google_oauth_tokens \n    ADD CONSTRAINT google_oauth_tokens_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-3": {"tables": ["linkedin_oauth_config", "portfolios"], "defaultColor": "#E8D8A8", "highlightColor": "#fee391", "desaturatedColor": "#d8d0b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_config \n    ADD CONSTRAINT linkedin_oauth_config_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-4": {"tables": ["linkedin_oauth_connections", "portfolios"], "defaultColor": "#B8D1A8", "highlightColor": "#b3e593", "desaturatedColor": "#bac6b2", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_connections \n    ADD CONSTRAINT linkedin_oauth_connections_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-5": {"tables": ["linkedin_oauth_scopes", "portfolios"], "defaultColor": "#93C4B8", "highlightColor": "#7adcc4", "desaturatedColor": "#9fb7b1", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_scopes \n    ADD CONSTRAINT linkedin_oauth_scopes_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-6": {"tables": ["oauth_apps", "portfolios"], "defaultColor": "#9BB0C0", "highlightColor": "#88b2d2", "desaturatedColor": "#a4aeb6", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE oauth_apps \n    ADD CONSTRAINT oauth_apps_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-7": {"tables": ["projects", "portfolios"], "defaultColor": "#98B8B8", "highlightColor": "#87c8c8", "desaturatedColor": "#a0b0b0", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE projects \n    ADD CONSTRAINT projects_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-8": {"tables": ["work_experience", "portfolios"], "defaultColor": "#E8B8A8", "highlightColor": "#feac91", "desaturatedColor": "#d8c0b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE work_experience \n    ADD CONSTRAINT work_experience_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}}, "defaultColor": "#cccccc", "highlightColor": "#ff0000"}</script>
<style type="text/css"><![CDATA[
/* General SVG Styling */
#main-svg {
    overflow: contain;
    display: block;
    /* Performance optimizations */
    will-change: transform;
    transform: translateZ(0);
}

#main-svg.grabbing {
    cursor: grabbing;
}

/* Overlay Container */
#overlay-container-div {
    position: fixed !important;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    font-family: system-ui, -apple-system, sans-serif;
    z-index: 10000;
}

/* Metadata and Miniature Containers */
.metadata-container {
    position: fixed;
    display: block;
    z-index: 10000;
    background: rgba(248, 249, 250, 0.98);
    border: 2px solid #27ae60;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    padding: 0;
    border-radius: 8px;
    pointer-events: auto;
    min-width: 320px;
    max-width: 400px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    overflow: hidden;
    box-sizing: border-box;
}

.metadata-container .header {
    background: linear-gradient(135deg, #27ae60, #229954);
    color: white;
    padding: 12px 15px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 6px 6px 0 0;
    margin: 0;
    min-height: 20px;
    display: flex;
    align-items: center;
    cursor: grab;
    user-select: none;
}

.metadata-container .header:active {
    cursor: grabbing;
}

.metadata-container .container-content {
    padding: 15px;
    max-height: 70vh;
    overflow-y: auto;
    font-size: 0.9rem;
}

.miniature-container {
    position: fixed;
    background: rgba(248, 249, 250, 0.98);
    border: 2px solid #8e44ad;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    padding: 0;
    border-radius: 8px;
    cursor: default;
    width: auto;
    height: auto;
    overflow: hidden;
    display: block;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    z-index: 10000;
    pointer-events: auto;
}

.miniature-container .header {
    background: linear-gradient(135deg, #8e44ad, #7d3c98);
    color: white;
    padding: 10px 12px;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 6px 6px 0 0;
    margin: 0;
    min-height: 18px;
    display: flex;
    align-items: center;
    cursor: grab;
    user-select: none;
    z-index: 10002; /* Higher than SVG z-index */
    position: relative;
    pointer-events: auto;
}

.miniature-container .header:active {
    cursor: grabbing;
}

.miniature-inner-container {
    pointer-events: none;
    position: relative;
}

.miniature-inner-container svg {
    pointer-events: auto;
    cursor: crosshair;
    position: relative;
    z-index: 10000; /* Lower than header z-index */
}

.miniature-container.minimized,
.metadata-container.minimized,
.selection-box.minimized {
    height: auto !important;
    min-height: 0 !important;
    min-width: 0 !important;
    overflow: contain !important;
}

/* Dragging Feedback */
.miniature-container.dragging,
.metadata-container.dragging {
    cursor: grabbing !important;
}

#miniature-header,
.metadata-container {
    cursor: grab;
}

/* Miniature Title */
.miniature-title {
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 5px;
    text-align: center;
    color: #333;
}

.miniature-container img {
    width: 100%;
    height: 100%;
    display: block;
}

/* Viewport Indicator */
.viewport-indicator {
    position: absolute !important;
    display: block !important;
    border: 2px solid #ff4081 !important;
    background-color: rgba(255, 64, 129, 0.05) !important;
    opacity: 1 !important;
    pointer-events: all !important;
    z-index: 10001 !important;
    min-width: 10px !important;
    min-height: 10px !important;
    transition: all 0.1s ease;
    box-sizing: border-box;
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.viewport-indicator.dragging {
    cursor: grabbing;
}

/* Instructions */
.instructions {
    bottom: 10px;
    right: 20px;
    font-size: 11px;
    color: #666;
    background-color: rgba(255, 255, 255, 0.7);
    padding: 3px 6px;
}

/* Nodes and Edges */
.node,
.edge {
    pointer-events: auto;
    cursor: pointer;
}

/* Add hover effects to make nodes and edges more visible when selectable */
/* Disabled to prevent unwanted mouseover events */
/* 
.edge:hover {
    filter: drop-shadow(0 0 2px rgba(255, 0, 0, 0.5));
}

.node:hover {
    filter: drop-shadow(0 0 3px rgba(0, 0, 255, 0.3));
}
*/

/* Metadata Minimap Row */
.metadata-minimap-row {
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    gap: 16px;
    z-index: 10000;
}

/* Selection Container */
#selection-container {
    position: fixed !important;
    top: 30px;
    left: auto;
    bottom: auto;
    z-index: 999999 !important;
    pointer-events: auto !important;
    cursor: grab;
    background: rgba(248, 249, 250, 0.98) !important;
    border: 2px solid #2c3e50 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
    padding: 0;
    border-radius: 8px;
    box-sizing: border-box;
    overflow: hidden;
    max-height: 80vh;
    min-width: 300px;
    max-width: min(500px, 30vw);
    width: auto;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    transform: none !important;
    margin: 0 !important;
}

.selection-container .header {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    padding: 12px 15px;
    font-size: 1.2rem;
    font-weight: 600;
    border-radius: 6px 6px 0 0;
    margin: 0;
    display: flex;
    align-items: center;
    cursor: grab;
    user-select: none;
}

.selection-container .header:active {
    cursor: grabbing;
}

#selection-container .container-content{
    position: relative;
    font-size: 0.9rem;
    opacity: 1;
    cursor: grab;
    pointer-events: auto;
    padding: 15px;
    max-height: calc(80vh - 60px);
    overflow-y: auto;
}

#selection-container.dragging {
    cursor: grabbing !important;
    background-color: rgba(200, 220, 240, 0.98);
}

.selection-box {
    font-size: 10px;
    background: rgba(168, 188, 220, 0.98);
    border: 1px solid #000;
    user-select: text;
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
}

/* Resize Handle */
.resize-handle {
    position: absolute;
    right: 0;
    bottom: 0;
    width: 16px;
    height: 16px;
    cursor: nwse-resize;
    z-index: 10001;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 0 0 4px 0;
}

/* Add this CSS to make the resize handles visible and functional */
.resize-handle {
    position: absolute;
    width: 14px;
    height: 14px;
    background-color: rgba(200, 200, 200, 0.5);
    border: 1px solid rgba(100, 100, 100, 0.5);
    z-index: 10000;
}

.resize-handle.nw {
    top: 0;
    left: 0;
    cursor:nw-resize;
}

.resize-handle.ne {
    top: 0;
    right: 0;
    cursor:ne-resize;
}

.resize-handle.sw {
    bottom: 0;
    left: 0;
    cursor:sw-resize;
}

.resize-handle.se {
    bottom: 0;
    right: 0;
    cursor:se-resize;
}

.resizing {
    user-select: none;
    pointer-events: none;
}

.resizing * {
    pointer-events: none;
}

/* Window Controls */
.window-controls {
    display: flex;
    gap: 2px;
    margin-left: auto; /* Pushes the buttons to the far right */
}

.window-controls button {
    background: #eee;
    border: 1px solid #aaa;
    border-radius: 2px;
    width: 18px;
    height: 18px;
    font-size: 14px;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    pointer-events: auto;
    z-index: 10099;
}

.trigger-icon {
    display: inline-block;
    width: 16px;
    height: 16px;
    margin-right: 2px;
    vertical-align: middle;
    cursor: pointer;
    z-index: 10004;
}
.trigger-icon:hover {
    filter: drop-shadow(0 0 2px #FFD700);
}

/* Add these to your existing CSS */
#selection-inner-container {
    overflow-y: auto;  /* Enable vertical scrolling for inner content */
    overflow-x: hidden; /* Prevent horizontal scrolling */
    width: 100%;      /* Ensures it fills the container */
    height: 100%;     /* Ensures it fills the container */
    box-sizing: border-box;
    word-wrap: break-word;  /* Breaks long words to prevent horizontal overflow */
    max-height: inherit; /* Inherit max-height from parent */
}

/* Make pre tags wrap text to prevent code blocks from overflowing */
#selection-inner-container pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: inherit;  /* Inherit the dynamic font size */
}

/* Style for table names in selection window */
.table-name {
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s;
    display: inline-block;
    background: rgba(52, 152, 219, 0.1);
    border: 1px solid rgba(52, 152, 219, 0.3);
    margin: 2px 4px 2px 0;
    font-weight: 500;
    color: #2c3e50;
}

.table-name:hover {
    background-color: rgba(52, 152, 219, 0.2);
    border-color: rgba(52, 152, 219, 0.5);
}

/* Style for edge names in selection window */
.edge-name {
    cursor: pointer;
    transition: background-color 0.2s;
    padding: 2px 4px;
    border-radius: 3px;
    margin: 2px 0;
}

.edge-name:hover {
    background-color: rgba(231, 76, 60, 0.1);
}

.edge-name pre {
    margin: 2px 0;
    font-size: 0.8rem;
    line-height: 1.3;
    background: rgba(0, 0, 0, 0.05);
    padding: 6px 8px;
    border-radius: 3px;
    border-left: 3px solid #e74c3c;
}

/* Selection window content sections */
.selection-section {
    margin-bottom: 20px;
}

.selection-section h3 {
    font-size: 1rem;
    font-weight: 600;
    color: #2c3e50;
    margin: 0 0 8px 0;
    padding-bottom: 4px;
    border-bottom: 1px solid #ecf0f1;
}

.selection-section h4 {
    font-size: 0.9rem;
    font-weight: 500;
    color: #34495e;
    margin: 12px 0 6px 0;
}

.trigger-info {
    background: rgba(241, 196, 15, 0.1);
    border: 1px solid rgba(241, 196, 15, 0.3);
    border-radius: 4px;
    padding: 8px;
    margin: 4px 0;
    font-size: 0.85rem;
}

.trigger-info .trigger-name {
    font-weight: 600;
    color: #d68910;
}

.trigger-info .trigger-event {
    color: #7d6608;
    margin-left: 8px;
}

.column-info {
    background: rgba(0, 0, 0, 0.02);
    border-radius: 3px;
    padding: 4px 6px;
    margin: 2px 0;
    font-size: 0.85rem;
    border-left: 2px solid #95a5a6;
}

/* Metadata content organization */
.metadata-section {
    margin-bottom: 18px;
}

.metadata-section h3 {
    font-size: 1rem;
    font-weight: 600;
    color: #2c3e50;
    margin: 0 0 10px 0;
    padding-bottom: 4px;
    border-bottom: 1px solid #ecf0f1;
    display: flex;
    align-items: center;
    gap: 8px;
}

.metadata-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-bottom: 12px;
}

.metadata-item {
    background: rgba(39, 174, 96, 0.08);
    border: 1px solid rgba(39, 174, 96, 0.2);
    border-radius: 4px;
    padding: 8px 10px;
    font-size: 0.85rem;
}

.metadata-item .label {
    font-weight: 600;
    color: #27ae60;
    display: block;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 2px;
}

.metadata-item .value {
    color: #2c3e50;
    font-weight: 500;
}

/* Table selector specific styles */
.table-selector-item {
    position: relative;
}

.table-selector-container {
    margin-top: 4px;
}

.table-selector {
    width: 100%;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(39, 174, 96, 0.3);
    border-radius: 3px;
    padding: 4px 6px;
    font-size: 0.8rem;
    color: #2c3e50;
    cursor: pointer;
    outline: none;
    transition: all 0.2s ease;
}

.table-selector:hover {
    background: rgba(255, 255, 255, 1);
    border-color: rgba(39, 174, 96, 0.5);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.table-selector:focus {
    border-color: #27ae60;
    box-shadow: 0 0 0 2px rgba(39, 174, 96, 0.2);
}

.table-selector option {
    padding: 4px 6px;
    font-size: 0.8rem;
    background: white;
    color: #2c3e50;
}

.table-selector option:hover {
    background: rgba(39, 174, 96, 0.1);
}

.metadata-single {
    background: rgba(52, 152, 219, 0.08);
    border: 1px solid rgba(52, 152, 219, 0.2);
    border-radius: 4px;
    padding: 8px 10px;
    margin: 4px 0;
    font-size: 0.85rem;
}

.metadata-single .label {
    font-weight: 600;
    color: #3498db;
    margin-right: 8px;
}

.metadata-single .value {
    color: #2c3e50;
}

.metadata-params {
    background: rgba(0, 0, 0, 0.03);
    border-radius: 4px;
    padding: 8px;
    margin-top: 8px;
}

.metadata-params .param-row {
    display: flex;
    justify-content: space-between;
    padding: 2px 0;
    font-size: 0.8rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.metadata-params .param-row:last-child {
    border-bottom: none;
}

.metadata-params .param-label {
    font-weight: 500;
    color: #7f8c8d;
}

.metadata-params .param-value {
    color: #2c3e50;
    font-weight: 600;
}

/* Add to your CSS for the copy button */
.copy-btn {
    background: #eee;
    border: 1px solid #aaa;
    border-radius: 2px;
    width: 18px;
    height: 18px;
    font-size: 14px;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    pointer-events: auto;
    z-index: 10099;
}

.copy-btn:hover {
    background: #ddd;
}

/* Add to your CSS for the edit button */
.edit-btn {
    background: #eee;
    border: 1px solid #aaa;
    border-radius: 2px;
    width: 18px;
    height: 18px;
    font-size: 14px;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    pointer-events: auto;
    z-index: 10099;
}

.edit-btn:hover {
    background: #ddd;
}

/* Make table-name and edge-name more obviously clickable */
.table-name, .edge-name {
    cursor: pointer;
    padding: 2px 5px;
    border-radius: 3px;
    transition: background-color 0.2s;
}

.table-name:hover, .edge-name:hover {
    background-color: rgba(200, 200, 200, 0.5); /* More visible hover effect */
    text-decoration: underline;
}

/* ===============================
   MODERN SVG TABLE STYLING
   =============================== */

/* Enhanced table styling for main ERD - NO hover effects */
#main-erd-group .node {
    filter: none;
    transition: none;
    will-change: auto;
}

/* Table border styling - make borders much more visible */
#main-erd-group .node polygon[stroke="black"] {
    stroke: #000000 !important;
    stroke-width: 1 !important;
    stroke-opacity: 1 !important;
}

/* Enhanced table cell styling with better spacing */
#main-erd-group .node polygon {
    stroke-linejoin: round;
    stroke-linecap: round;
    shape-rendering: crispEdges;
}

/* Table row polygons - stronger internal borders for better separation */
#main-erd-group .node polygon[fill="none"] {
    stroke: #333333 !important;
    stroke-width: 1.5 !important;
    stroke-opacity: 1 !important;
}

/* Header row styling - make headers more prominent */
#main-erd-group .node polygon[fill*="#"] + polygon[fill="none"][stroke="black"] {
    stroke: #000000 !important;
    stroke-width: 1 !important;
    stroke-opacity: 1 !important;
}

/* Table header text styling - remove effects that cause fuzziness */
#main-erd-group .node text[font-size="24"] {
    font-weight: 700 !important;
    letter-spacing: 0.5px;
    fill: #000000 !important;
    stroke: none !important;
    /* Better positioning for headers */
    dominant-baseline: middle;
    text-anchor: start;
    transform: translateX(12px);
}

/* Column text styling - remove effects that cause fuzziness */
#main-erd-group .node text[font-size="18"] {
    font-weight: 500 !important;
    letter-spacing: 0.3px;
    fill: #222222 !important;
    stroke: none !important;
}

/* Remove all text effects that cause fuzziness */
#main-erd-group .node text {
    text-anchor: start !important;
    dominant-baseline: central;
    text-rendering: optimizeLegibility;
    shape-rendering: crispEdges;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', monospace !important;
}

/* Add proper text positioning and spacing for table content */
#main-erd-group .node text {
    alignment-baseline: middle;
    baseline-shift: 0;
}

/* Ensure adequate spacing between text and table borders */
#main-erd-group .node text[x] {
    /* Add left margin by adjusting x position */
    transform: translateX(8px);
}

/* Table cell text positioning - prevent overlap with borders */
#main-erd-group .node text[font-size="18"] {
    font-weight: 500 !important;
    letter-spacing: 0.3px;
    fill: #222222 !important;
    stroke: none !important;
    /* Add vertical centering and horizontal margin */
    dominant-baseline: middle;
    text-anchor: start;
}

/* Create visual breathing room around table cells - clean borders */
#main-erd-group .node polygon[fill="none"] {
    stroke: #555555 !important;
    stroke-width: 1.2 !important;
    stroke-opacity: 1 !important;
}



/* ===============================
   MODERN SVG EDGE STYLING
   =============================== */



/* Hover effects disabled to prevent unwanted mouseover events */
/*
#main-erd-group .edge:hover {
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.2));
}
*/

/* Enhanced path styling for edges - NO hover effects */
#main-erd-group .edge path {
    stroke-width: 5 !important;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: none;
    will-change: auto;
}

/* Hover effects disabled to prevent unwanted mouseover events */
/*
#main-erd-group .edge:hover path {
    stroke-width: 4 !important;
    filter: brightness(1.2);
}
*/



/* Hover effects disabled to prevent unwanted mouseover events */
/*
#main-erd-group .edge:hover polygon {
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.25));
}
*/

/* Parallel edge enhancement - make multiple edges between same tables with equal thickness */
#main-erd-group .edge path[stroke-width="3"] {
    stroke-width: 5 !important;
    stroke-dasharray: none;
    opacity: 0.9;
}

/* Enhanced parallel edge styling - different widths for equal visual distribution */
#main-erd-group .edge:nth-child(even) path {
    stroke-dasharray: none;
    opacity: 0.95;
    stroke-width: 6 !important;
    /* Make even edges (background) slightly thicker */
}

#main-erd-group .edge:nth-child(odd) path {
    opacity: 1;
    stroke-width: 3.5 !important;
    /* Make odd edges (foreground) thinner so they sit on top */
}

/* Third and subsequent parallel edges use medium thickness */
#main-erd-group .edge:nth-child(3n) path {
    stroke-dasharray: 8,4,2,4;
    opacity: 0.9;
    stroke-width: 4.5 !important;
}

/* Special styling for highlighted edges - doubled thickness */
#main-erd-group .edge path[stroke-width="16"],
#main-erd-group .edge path[stroke-width="12"],
#main-erd-group .edge path[stroke-width="10"] {
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 1 !important;
}

/* ===============================
   MINIATURE ERD STYLING
   =============================== */

/* Enhanced miniature container styling */
.miniature-container svg {
    border-radius: 4px;
    background: #f8f9fa;
}

/* Miniature edge styling - NO hover effects */
.miniature-container .edge path {
    stroke-width: 3 !important;
    opacity: 0.8;
}

/* Miniature text scaling */
.miniature-container text {
    font-size: 0.8em !important;
}

]]></style>
    <foreignObject id="overlay-container" x="0" y="0" width="100%" height="100%" pointer-events="none">
        <div xmlns="http://www.w3.org/1999/xhtml" id="overlay-container-div" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; font-family: system-ui, -apple-system, sans-serif; z-index: 9999;">
            
        
    <div class="instructions">
        💡 Drag to pan • Scroll to zoom • Click map to navigate • Click tables/edges to highlight • ESC/R to reset
    </div>
    
        
<div class='metadata-container container' id='metadata-container'>
    <div class='header'>📊 Database Metadata</div>
    <div class="window-controls" style="position:absolute;right:2px;top:2px;z-index:10010;"></div>
    <div class='metadata-inner-container container-content'>
        
        <div class="metadata-section">
            <h3>📁 Source Information</h3>
            <div class="metadata-single">
                <span class="label">File:</span>
                <span class="value">data.sql</span>
            </div>
            <div class="metadata-single">
                <span class="label">Size:</span>
                <span class="value">9,154 bytes</span>
            </div>
            <div class="metadata-single">
                <span class="label">Generated:</span>
                <span class="value">2025-09-09 11:08:52</span>
            </div>
        </div>

        <div class="metadata-section">
            <h3>🗃️ Schema Statistics</h3>
            <div class="metadata-grid">
                <div class="metadata-item table-selector-item">
                    <span class="label">Tables</span>
                    <div class="table-selector-container">
                        <select id="table-selector" class="table-selector">
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="metadata-item">
                    <span class="label">Columns</span>
                    <span class="value">124</span>
                </div>
                <div class="metadata-item">
                    <span class="label">Foreign Keys</span>
                    <span class="value">9</span>
                </div>
                <div class="metadata-item">
                    <span class="label">Connections</span>
                    <span class="value">9</span>
                </div>
                <div class="metadata-item">
                    <span class="label">Triggers</span>
                    <span class="value">0</span>
                </div>
                <div class="metadata-item">
                    <span class="label">Standalone</span>
                    <span class="value">Yes</span>
                </div>
            </div>
        </div>

        <div class="metadata-section">
            <h3>⚙️ Graphviz Diagraph Parameters</h3>
            <div class="metadata-params">
                <div class="param-row">
                    <span class="param-label">Rank Direction:</span>
                    <span class="param-value">TB</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Pack Mode:</span>
                    <span class="param-value">array</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Edge Separation:</span>
                    <span class="param-value">8</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Font Family:</span>
                    <span class="param-value">Arial</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Font Size:</span>
                    <span class="param-value">18pt</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Node Font:</span>
                    <span class="param-value">14pt</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Edge Font:</span>
                    <span class="param-value">12pt</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Node Style:</span>
                    <span class="param-value">rounded,filled</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Node Shape:</span>
                    <span class="param-value">rect</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Node Separation:</span>
                    <span class="param-value">0.5</span>
                </div>
                <div class="param-row">
                    <span class="param-label">Rank Separation:</span>
                    <span class="param-value">1.2</span>
                </div>
            </div>
        </div>
    </div>
</div>

        <div class='metadata-minimap-row'>
            
<div id="miniature-container" class="miniature-container container" style="z-index:10000;" >
  <div class="header" id="miniature-header">Directed GraphOverview
  </div>
    <div class="window-controls" style="position:absolute;right:2px;top:2px;z-index:10010;"></div>
  <div class="miniature-inner-container container-content" id="miniature-inner-container">
    <!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg id="miniature-svg"
 viewBox="0.00 0.00 3412.13 1177.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow:hidden;" width="500" height="172">
<g id="mini-main-erd-group" class="graph" transform="scale(1 1) rotate(0) translate(4 1173.5)" style="pointer-events: all;">
<polygon fill="white" stroke="none" points="-4,4 -4,-1173.5 3408.13,-1173.5 3408.13,4 -4,4"/>
<!-- app_log -->
<g id="mini-app_log" class="node">
<title>app_log</title>

<polygon fill="#e8a8a8" stroke="none" points="8,-1128.5 8,-1165.5 261,-1165.5 261,-1128.5 8,-1128.5"/>
<polygon fill="none" stroke="black" points="8,-1128.5 8,-1165.5 261,-1165.5 261,-1128.5 8,-1128.5"/>
<text text-anchor="start" x="91.38" y="-1137.7" font-family="Arial" font-size="24.00">app_log</text>
<polygon fill="none" stroke="black" points="8,-1096.75 8,-1128.5 261,-1128.5 261,-1096.75 8,-1096.75"/>
<text text-anchor="start" x="13" y="-1107.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="28.75" y="-1107.4" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="8,-1065.75 8,-1096.75 261,-1096.75 261,-1065.75 8,-1065.75"/>
<text text-anchor="start" x="13" y="-1075.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="27.25" y="-1075.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="40" y="-1075.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="8,-1034.75 8,-1065.75 261,-1065.75 261,-1034.75 8,-1034.75"/>
<text text-anchor="start" x="13" y="-1043.65" font-family="Arial" font-size="18.00">timestamp (timestamptz)</text>
<polygon fill="none" stroke="black" points="8,-1003.75 8,-1034.75 261,-1034.75 261,-1003.75 8,-1003.75"/>
<text text-anchor="start" x="13" y="-1012.65" font-family="Arial" font-size="18.00">level (text)</text>
<polygon fill="none" stroke="black" points="8,-972.75 8,-1003.75 261,-1003.75 261,-972.75 8,-972.75"/>
<text text-anchor="start" x="13" y="-981.65" font-family="Arial" font-size="18.00">message (text)</text>
<polygon fill="none" stroke="black" points="8,-941.75 8,-972.75 261,-972.75 261,-941.75 8,-941.75"/>
<text text-anchor="start" x="13" y="-950.65" font-family="Arial" font-size="18.00">module (text)</text>
<polygon fill="none" stroke="black" points="8,-910.75 8,-941.75 261,-941.75 261,-910.75 8,-910.75"/>
<text text-anchor="start" x="13" y="-919.65" font-family="Arial" font-size="18.00">function (text)</text>
<polygon fill="none" stroke="black" points="8,-879.75 8,-910.75 261,-910.75 261,-879.75 8,-879.75"/>
<text text-anchor="start" x="13" y="-888.65" font-family="Arial" font-size="18.00">line (integer)</text>
<polygon fill="none" stroke="black" points="8,-848.75 8,-879.75 261,-879.75 261,-848.75 8,-848.75"/>
<text text-anchor="start" x="13" y="-857.65" font-family="Arial" font-size="18.00">user (text)</text>
<polygon fill="none" stroke="black" points="8,-817.75 8,-848.75 261,-848.75 261,-817.75 8,-817.75"/>
<text text-anchor="start" x="13" y="-826.65" font-family="Arial" font-size="18.00">extra (text)</text>
<polygon fill="none" stroke="black" points="8,-786.75 8,-817.75 261,-817.75 261,-786.75 8,-786.75"/>
<text text-anchor="start" x="13" y="-795.65" font-family="Arial" font-size="18.00">ip_address (varchar(45))</text>
<polygon fill="none" stroke="black" points="8,-755.75 8,-786.75 261,-786.75 261,-755.75 8,-755.75"/>
<text text-anchor="start" x="13" y="-764.65" font-family="Arial" font-size="18.00">user_agent (text)</text>
<polygon fill="none" stroke="black" points="8,-724.75 8,-755.75 261,-755.75 261,-724.75 8,-724.75"/>
<text text-anchor="start" x="13" y="-733.65" font-family="Arial" font-size="18.00">traceback (text)</text>
<polygon fill="none" stroke="black" points="8,-693.75 8,-724.75 261,-724.75 261,-693.75 8,-693.75"/>
<text text-anchor="start" x="13" y="-702.65" font-family="Arial" font-size="18.00">CONSTRAINT (app_log_pkey)</text>
</g>
<!-- portfolios -->
<g id="mini-portfolios" class="node">
<title>portfolios</title>

<polygon fill="#7bb0c0" stroke="none" points="1936.62,-562.75 1936.62,-599.75 2208.38,-599.75 2208.38,-562.75 1936.62,-562.75"/>
<polygon fill="none" stroke="black" points="1936.62,-562.75 1936.62,-599.75 2208.38,-599.75 2208.38,-562.75 1936.62,-562.75"/>
<text text-anchor="start" x="2023.38" y="-571.95" font-family="Arial" font-size="24.00">portfolios</text>
<polygon fill="none" stroke="black" points="1936.62,-531 1936.62,-562.75 2208.38,-562.75 2208.38,-531 1936.62,-531"/>
<text text-anchor="start" x="1941.62" y="-541.65" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1957.38" y="-541.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1936.62,-500 1936.62,-531 2208.38,-531 2208.38,-500 1936.62,-500"/>
<text text-anchor="start" x="1941.62" y="-508.9" font-family="Arial" font-size="18.00">id (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-469 1936.62,-500 2208.38,-500 2208.38,-469 1936.62,-469"/>
<text text-anchor="start" x="1941.62" y="-477.9" font-family="Arial" font-size="18.00">name (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-438 1936.62,-469 2208.38,-469 2208.38,-438 1936.62,-438"/>
<text text-anchor="start" x="1941.62" y="-446.9" font-family="Arial" font-size="18.00">title (varchar(200))</text>
<polygon fill="none" stroke="black" points="1936.62,-407 1936.62,-438 2208.38,-438 2208.38,-407 1936.62,-407"/>
<text text-anchor="start" x="1941.62" y="-415.9" font-family="Arial" font-size="18.00">bio (text)</text>
<polygon fill="none" stroke="black" points="1936.62,-376 1936.62,-407 2208.38,-407 2208.38,-376 1936.62,-376"/>
<text text-anchor="start" x="1941.62" y="-384.9" font-family="Arial" font-size="18.00">tagline (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-345 1936.62,-376 2208.38,-376 2208.38,-345 1936.62,-345"/>
<text text-anchor="start" x="1941.62" y="-353.9" font-family="Arial" font-size="18.00">profile_image (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-314 1936.62,-345 2208.38,-345 2208.38,-314 1936.62,-314"/>
<text text-anchor="start" x="1941.62" y="-322.9" font-family="Arial" font-size="18.00">email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-283 1936.62,-314 2208.38,-314 2208.38,-283 1936.62,-283"/>
<text text-anchor="start" x="1941.62" y="-291.9" font-family="Arial" font-size="18.00">phone (varchar(20))</text>
<polygon fill="none" stroke="black" points="1936.62,-252 1936.62,-283 2208.38,-283 2208.38,-252 1936.62,-252"/>
<text text-anchor="start" x="1941.62" y="-260.9" font-family="Arial" font-size="18.00">vcard (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-221 1936.62,-252 2208.38,-252 2208.38,-221 1936.62,-221"/>
<text text-anchor="start" x="1941.62" y="-229.9" font-family="Arial" font-size="18.00">resume_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-190 1936.62,-221 2208.38,-221 2208.38,-190 1936.62,-190"/>
<text text-anchor="start" x="1941.62" y="-198.9" font-family="Arial" font-size="18.00">resume_download (varchar(300))</text>
<polygon fill="none" stroke="black" points="1936.62,-159 1936.62,-190 2208.38,-190 2208.38,-159 1936.62,-159"/>
<text text-anchor="start" x="1941.62" y="-167.9" font-family="Arial" font-size="18.00">github (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-128 1936.62,-159 2208.38,-159 2208.38,-128 1936.62,-128"/>
<text text-anchor="start" x="1941.62" y="-136.9" font-family="Arial" font-size="18.00">twitter (varchar(100))</text>
<polygon fill="none" stroke="black" points="1936.62,-97 1936.62,-128 2208.38,-128 2208.38,-97 1936.62,-97"/>
<text text-anchor="start" x="1941.62" y="-105.9" font-family="Arial" font-size="18.00">skills (jsonb)</text>
<polygon fill="none" stroke="black" points="1936.62,-66 1936.62,-97 2208.38,-97 2208.38,-66 1936.62,-66"/>
<text text-anchor="start" x="1941.62" y="-74.9" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1936.62,-35 1936.62,-66 2208.38,-66 2208.38,-35 1936.62,-35"/>
<text text-anchor="start" x="1941.62" y="-43.9" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1936.62,-4 1936.62,-35 2208.38,-35 2208.38,-4 1936.62,-4"/>
<text text-anchor="start" x="1941.62" y="-12.9" font-family="Arial" font-size="18.00">CONSTRAINT (portfolios_pkey)</text>
</g>
<!-- app_log&#45;&gt;portfolios -->
<g id="mini-edge&#45;0" class="edge">
<title>app_log:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8a8a8" stroke-width="2.5" d="M262,-1080.25C304.59,-1081.39 255.06,-721.07 285.78,-689.05 412.34,-559.85 1697.37,-546.39 1922.87,-545.89"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M262,-1082.25C306.58,-1081.11 257.04,-720.8 287.22,-690.45 412.36,-561.85 1697.39,-548.39 1922.88,-547.89"/>
<polygon fill="#e8a8a8" stroke="#e8a8a8" stroke-width="2.5" points="1932.58,-546.88 1922.58,-551.39 1930.63,-547.63 1922.58,-547.64 1922.58,-546.89 1922.58,-546.14 1930.62,-546.13 1922.57,-542.39 1932.58,-546.88"/>
</g>
<!-- contact_messages -->
<g id="mini-contact_messages" class="node">
<title>contact_messages</title>

<polygon fill="#e8b093" stroke="none" points="312.88,-1051 312.88,-1088 652.12,-1088 652.12,-1051 312.88,-1051"/>
<polygon fill="none" stroke="black" points="312.88,-1051 312.88,-1088 652.12,-1088 652.12,-1051 312.88,-1051"/>
<text text-anchor="start" x="381.62" y="-1060.2" font-family="Arial" font-size="24.00">contact_messages</text>
<polygon fill="none" stroke="black" points="312.88,-1019.25 312.88,-1051 652.12,-1051 652.12,-1019.25 312.88,-1019.25"/>
<text text-anchor="start" x="317.88" y="-1029.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="333.62" y="-1029.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="312.88,-988.25 312.88,-1019.25 652.12,-1019.25 652.12,-988.25 312.88,-988.25"/>
<text text-anchor="start" x="317.88" y="-998.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="332.12" y="-998.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="344.88" y="-998.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="312.88,-957.25 312.88,-988.25 652.12,-988.25 652.12,-957.25 312.88,-957.25"/>
<text text-anchor="start" x="317.88" y="-966.15" font-family="Arial" font-size="18.00">name (varchar(100))</text>
<polygon fill="none" stroke="black" points="312.88,-926.25 312.88,-957.25 652.12,-957.25 652.12,-926.25 312.88,-926.25"/>
<text text-anchor="start" x="317.88" y="-935.15" font-family="Arial" font-size="18.00">email (varchar(100))</text>
<polygon fill="none" stroke="black" points="312.88,-895.25 312.88,-926.25 652.12,-926.25 652.12,-895.25 312.88,-895.25"/>
<text text-anchor="start" x="317.88" y="-904.15" font-family="Arial" font-size="18.00">subject (varchar(300))</text>
<polygon fill="none" stroke="black" points="312.88,-864.25 312.88,-895.25 652.12,-895.25 652.12,-864.25 312.88,-864.25"/>
<text text-anchor="start" x="317.88" y="-873.15" font-family="Arial" font-size="18.00">message (text)</text>
<polygon fill="none" stroke="black" points="312.88,-833.25 312.88,-864.25 652.12,-864.25 652.12,-833.25 312.88,-833.25"/>
<text text-anchor="start" x="317.88" y="-842.15" font-family="Arial" font-size="18.00">is_read (boolean)</text>
<polygon fill="none" stroke="black" points="312.88,-802.25 312.88,-833.25 652.12,-833.25 652.12,-802.25 312.88,-802.25"/>
<text text-anchor="start" x="317.88" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="312.88,-771.25 312.88,-802.25 652.12,-802.25 652.12,-771.25 312.88,-771.25"/>
<text text-anchor="start" x="317.88" y="-780.15" font-family="Arial" font-size="18.00">CONSTRAINT (contact_messages_pkey)</text>
</g>
<!-- contact_messages&#45;&gt;portfolios -->
<g id="mini-edge&#45;1" class="edge">
<title>contact_messages:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8b093" stroke-width="2.5" d="M653.12,-1002.75C687.13,-1003.87 652.21,-715.05 676.78,-689.06 772.58,-590.18 1741.76,-548.11 1922.68,-545.96"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M653.12,-1004.75C689.11,-1003.63 654.19,-714.81 678.22,-690.44 772.66,-592.18 1741.84,-550.11 1922.71,-547.96"/>
<polygon fill="#e8b093" stroke="#e8b093" stroke-width="2.5" points="1932.58,-546.9 1922.61,-551.46 1930.63,-547.66 1922.58,-547.71 1922.58,-546.96 1922.57,-546.21 1930.62,-546.16 1922.55,-542.46 1932.58,-546.9"/>
</g>
<!-- google_oauth_tokens -->
<g id="mini-google_oauth_tokens" class="node">
<title>google_oauth_tokens</title>

<polygon fill="#e8c093" stroke="none" points="703.75,-1113 703.75,-1150 1063.25,-1150 1063.25,-1113 703.75,-1113"/>
<polygon fill="none" stroke="black" points="703.75,-1113 703.75,-1150 1063.25,-1150 1063.25,-1113 703.75,-1113"/>
<text text-anchor="start" x="767.62" y="-1122.2" font-family="Arial" font-size="24.00">google_oauth_tokens</text>
<polygon fill="none" stroke="black" points="703.75,-1081.25 703.75,-1113 1063.25,-1113 1063.25,-1081.25 703.75,-1081.25"/>
<text text-anchor="start" x="708.75" y="-1091.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="724.5" y="-1091.9" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="703.75,-1050.25 703.75,-1081.25 1063.25,-1081.25 1063.25,-1050.25 703.75,-1050.25"/>
<text text-anchor="start" x="708.75" y="-1060.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="723" y="-1060.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="735.75" y="-1060.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="703.75,-1019.25 703.75,-1050.25 1063.25,-1050.25 1063.25,-1019.25 703.75,-1019.25"/>
<text text-anchor="start" x="708.75" y="-1028.15" font-family="Arial" font-size="18.00">admin_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="703.75,-988.25 703.75,-1019.25 1063.25,-1019.25 1063.25,-988.25 703.75,-988.25"/>
<text text-anchor="start" x="708.75" y="-997.15" font-family="Arial" font-size="18.00">access_token (text)</text>
<polygon fill="none" stroke="black" points="703.75,-957.25 703.75,-988.25 1063.25,-988.25 1063.25,-957.25 703.75,-957.25"/>
<text text-anchor="start" x="708.75" y="-966.15" font-family="Arial" font-size="18.00">refresh_token (text)</text>
<polygon fill="none" stroke="black" points="703.75,-926.25 703.75,-957.25 1063.25,-957.25 1063.25,-926.25 703.75,-926.25"/>
<text text-anchor="start" x="708.75" y="-935.15" font-family="Arial" font-size="18.00">token_expires_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-895.25 703.75,-926.25 1063.25,-926.25 1063.25,-895.25 703.75,-895.25"/>
<text text-anchor="start" x="708.75" y="-904.15" font-family="Arial" font-size="18.00">granted_scopes (text)</text>
<polygon fill="none" stroke="black" points="703.75,-864.25 703.75,-895.25 1063.25,-895.25 1063.25,-864.25 703.75,-864.25"/>
<text text-anchor="start" x="708.75" y="-873.15" font-family="Arial" font-size="18.00">requested_scopes (text)</text>
<polygon fill="none" stroke="black" points="703.75,-833.25 703.75,-864.25 1063.25,-864.25 1063.25,-833.25 703.75,-833.25"/>
<text text-anchor="start" x="708.75" y="-842.15" font-family="Arial" font-size="18.00">last_used_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-802.25 703.75,-833.25 1063.25,-833.25 1063.25,-802.25 703.75,-802.25"/>
<text text-anchor="start" x="708.75" y="-811.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="703.75,-771.25 703.75,-802.25 1063.25,-802.25 1063.25,-771.25 703.75,-771.25"/>
<text text-anchor="start" x="708.75" y="-780.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-740.25 703.75,-771.25 1063.25,-771.25 1063.25,-740.25 703.75,-740.25"/>
<text text-anchor="start" x="708.75" y="-749.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="703.75,-709.25 703.75,-740.25 1063.25,-740.25 1063.25,-709.25 703.75,-709.25"/>
<text text-anchor="start" x="708.75" y="-718.15" font-family="Arial" font-size="18.00">CONSTRAINT (google_oauth_tokens_pkey)</text>
</g>
<!-- google_oauth_tokens&#45;&gt;portfolios -->
<g id="mini-edge&#45;2" class="edge">
<title>google_oauth_tokens:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8c093" stroke-width="2.5" d="M1064.25,-1064.75C1105.12,-1065.88 1059.46,-720.96 1087.76,-689.08 1213.63,-550.05 1722.19,-545.99 1922.86,-545.88"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1064.25,-1066.75C1107.11,-1065.62 1061.45,-720.7 1089.24,-690.42 1213.65,-552.05 1722.21,-547.99 1922.86,-547.88"/>
<polygon fill="#e8c093" stroke="#e8c093" stroke-width="2.5" points="1932.58,-546.88 1922.58,-551.38 1930.63,-547.63 1922.58,-547.63 1922.58,-546.88 1922.58,-546.13 1930.62,-546.13 1922.58,-542.38 1932.58,-546.88"/>
</g>
<!-- linkedin_oauth_config -->
<g id="mini-linkedin_oauth_config" class="node">
<title>linkedin_oauth_config</title>

<polygon fill="#e8d8a8" stroke="none" points="1115,-1082 1115,-1119 1476,-1119 1476,-1082 1115,-1082"/>
<polygon fill="none" stroke="black" points="1115,-1082 1115,-1119 1476,-1119 1476,-1082 1115,-1082"/>
<text text-anchor="start" x="1178.5" y="-1091.2" font-family="Arial" font-size="24.00">linkedin_oauth_config</text>
<polygon fill="none" stroke="black" points="1115,-1050.25 1115,-1082 1476,-1082 1476,-1050.25 1115,-1050.25"/>
<text text-anchor="start" x="1120" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1135.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1115,-1019.25 1115,-1050.25 1476,-1050.25 1476,-1019.25 1115,-1019.25"/>
<text text-anchor="start" x="1120" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="1134.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="1147" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1115,-988.25 1115,-1019.25 1476,-1019.25 1476,-988.25 1115,-988.25"/>
<text text-anchor="start" x="1120" y="-997.15" font-family="Arial" font-size="18.00">app_name (varchar(200))</text>
<polygon fill="none" stroke="black" points="1115,-957.25 1115,-988.25 1476,-988.25 1476,-957.25 1115,-957.25"/>
<text text-anchor="start" x="1120" y="-966.15" font-family="Arial" font-size="18.00">client_id (varchar(200))</text>
<polygon fill="none" stroke="black" points="1115,-926.25 1115,-957.25 1476,-957.25 1476,-926.25 1115,-926.25"/>
<text text-anchor="start" x="1120" y="-935.15" font-family="Arial" font-size="18.00">client_secret (text)</text>
<polygon fill="none" stroke="black" points="1115,-895.25 1115,-926.25 1476,-926.25 1476,-895.25 1115,-895.25"/>
<text text-anchor="start" x="1120" y="-904.15" font-family="Arial" font-size="18.00">redirect_uri (varchar(500))</text>
<polygon fill="none" stroke="black" points="1115,-864.25 1115,-895.25 1476,-895.25 1476,-864.25 1115,-864.25"/>
<text text-anchor="start" x="1120" y="-873.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="1115,-833.25 1115,-864.25 1476,-864.25 1476,-833.25 1115,-833.25"/>
<text text-anchor="start" x="1120" y="-842.15" font-family="Arial" font-size="18.00">configured_by_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1115,-802.25 1115,-833.25 1476,-833.25 1476,-802.25 1115,-802.25"/>
<text text-anchor="start" x="1120" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1115,-771.25 1115,-802.25 1476,-802.25 1476,-771.25 1115,-771.25"/>
<text text-anchor="start" x="1120" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1115,-740.25 1115,-771.25 1476,-771.25 1476,-740.25 1115,-740.25"/>
<text text-anchor="start" x="1120" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_config_pkey)</text>
</g>
<!-- linkedin_oauth_config&#45;&gt;portfolios -->
<g id="mini-edge&#45;3" class="edge">
<title>linkedin_oauth_config:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8d8a8" stroke-width="2.5" d="M1477,-1033.75C1514.44,-1034.87 1477.85,-720.16 1501.71,-689.13 1562.14,-612.1 1812.8,-550.97 1922.62,-546.18"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1477,-1035.75C1516.43,-1034.63 1479.84,-719.93 1503.29,-690.37 1562.62,-614.04 1813.27,-552.92 1922.71,-548.17"/>
<polygon fill="#e8d8a8" stroke="#e8d8a8" stroke-width="2.5" points="1932.58,-546.95 1922.69,-551.68 1930.64,-547.74 1922.6,-547.93 1922.58,-547.18 1922.57,-546.43 1930.61,-546.24 1922.48,-542.68 1932.58,-546.95"/>
</g>
<!-- linkedin_oauth_connections -->
<g id="mini-linkedin_oauth_connections" class="node">
<title>linkedin_oauth_connections</title>

<polygon fill="#b8d1a8" stroke="none" points="1528.38,-1097.5 1528.38,-1134.5 1936.62,-1134.5 1936.62,-1097.5 1528.38,-1097.5"/>
<polygon fill="none" stroke="black" points="1528.38,-1097.5 1528.38,-1134.5 1936.62,-1134.5 1936.62,-1097.5 1528.38,-1097.5"/>
<text text-anchor="start" x="1583.25" y="-1106.7" font-family="Arial" font-size="24.00">linkedin_oauth_connections</text>
<polygon fill="none" stroke="black" points="1528.38,-1065.75 1528.38,-1097.5 1936.62,-1097.5 1936.62,-1065.75 1528.38,-1065.75"/>
<text text-anchor="start" x="1533.38" y="-1076.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="1549.12" y="-1076.4" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1528.38,-1034.75 1528.38,-1065.75 1936.62,-1065.75 1936.62,-1034.75 1528.38,-1034.75"/>
<text text-anchor="start" x="1533.38" y="-1044.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="1547.62" y="-1044.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="1560.38" y="-1044.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1528.38,-1003.75 1528.38,-1034.75 1936.62,-1034.75 1936.62,-1003.75 1528.38,-1003.75"/>
<text text-anchor="start" x="1533.38" y="-1012.65" font-family="Arial" font-size="18.00">admin_email (varchar(100))</text>
<polygon fill="none" stroke="black" points="1528.38,-972.75 1528.38,-1003.75 1936.62,-1003.75 1936.62,-972.75 1528.38,-972.75"/>
<text text-anchor="start" x="1533.38" y="-981.65" font-family="Arial" font-size="18.00">access_token (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-941.75 1528.38,-972.75 1936.62,-972.75 1936.62,-941.75 1528.38,-941.75"/>
<text text-anchor="start" x="1533.38" y="-950.65" font-family="Arial" font-size="18.00">refresh_token (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-910.75 1528.38,-941.75 1936.62,-941.75 1936.62,-910.75 1528.38,-910.75"/>
<text text-anchor="start" x="1533.38" y="-919.65" font-family="Arial" font-size="18.00">token_expires_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-879.75 1528.38,-910.75 1936.62,-910.75 1936.62,-879.75 1528.38,-879.75"/>
<text text-anchor="start" x="1533.38" y="-888.65" font-family="Arial" font-size="18.00">granted_scopes (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-848.75 1528.38,-879.75 1936.62,-879.75 1936.62,-848.75 1528.38,-848.75"/>
<text text-anchor="start" x="1533.38" y="-857.65" font-family="Arial" font-size="18.00">requested_scopes (text)</text>
<polygon fill="none" stroke="black" points="1528.38,-817.75 1528.38,-848.75 1936.62,-848.75 1936.62,-817.75 1528.38,-817.75"/>
<text text-anchor="start" x="1533.38" y="-826.65" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="1528.38,-786.75 1528.38,-817.75 1936.62,-817.75 1936.62,-786.75 1528.38,-786.75"/>
<text text-anchor="start" x="1533.38" y="-795.65" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-755.75 1528.38,-786.75 1936.62,-786.75 1936.62,-755.75 1528.38,-755.75"/>
<text text-anchor="start" x="1533.38" y="-764.65" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1528.38,-724.75 1528.38,-755.75 1936.62,-755.75 1936.62,-724.75 1528.38,-724.75"/>
<text text-anchor="start" x="1533.38" y="-733.65" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_connections_pkey)</text>
</g>
<!-- linkedin_oauth_connections&#45;&gt;portfolios -->
<g id="mini-edge&#45;4" class="edge">
<title>linkedin_oauth_connections:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#b8d1a8" stroke-width="2.5" d="M1937.62,-1049.25C1973.24,-1050.38 1935.79,-757.49 1935.63,-720.75 1935.51,-648.91 1866.99,-559.48 1922.7,-547"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M1937.62,-1051.25C1975.23,-1050.12 1937.78,-757.23 1937.62,-720.75 1937.1,-647.69 1868.58,-558.27 1923.09,-548.96"/>
<polygon fill="#b8d1a8" stroke="#b8d1a8" stroke-width="2.5" points="1932.59,-547.14 1923.02,-552.49 1930.71,-548.05 1922.69,-548.75 1922.63,-548 1922.56,-547.25 1930.58,-546.56 1922.24,-543.52 1932.59,-547.14"/>
</g>
<!-- linkedin_oauth_scopes -->
<g id="mini-linkedin_oauth_scopes" class="node">
<title>linkedin_oauth_scopes</title>

<polygon fill="#93c4b8" stroke="none" points="1988.5,-1082 1988.5,-1119 2358.5,-1119 2358.5,-1082 1988.5,-1082"/>
<polygon fill="none" stroke="black" points="1988.5,-1082 1988.5,-1119 2358.5,-1119 2358.5,-1082 1988.5,-1082"/>
<text text-anchor="start" x="2050.5" y="-1091.2" font-family="Arial" font-size="24.00">linkedin_oauth_scopes</text>
<polygon fill="none" stroke="black" points="1988.5,-1050.25 1988.5,-1082 2358.5,-1082 2358.5,-1050.25 1988.5,-1050.25"/>
<text text-anchor="start" x="1993.5" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2009.25" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="1988.5,-1019.25 1988.5,-1050.25 2358.5,-1050.25 2358.5,-1019.25 1988.5,-1019.25"/>
<text text-anchor="start" x="1993.5" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2007.75" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2020.5" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="1988.5,-988.25 1988.5,-1019.25 2358.5,-1019.25 2358.5,-988.25 1988.5,-988.25"/>
<text text-anchor="start" x="1993.5" y="-997.15" font-family="Arial" font-size="18.00">scope_name (varchar(100))</text>
<polygon fill="none" stroke="black" points="1988.5,-957.25 1988.5,-988.25 2358.5,-988.25 2358.5,-957.25 1988.5,-957.25"/>
<text text-anchor="start" x="1993.5" y="-966.15" font-family="Arial" font-size="18.00">display_name (varchar(200))</text>
<polygon fill="none" stroke="black" points="1988.5,-926.25 1988.5,-957.25 2358.5,-957.25 2358.5,-926.25 1988.5,-926.25"/>
<text text-anchor="start" x="1993.5" y="-935.15" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="1988.5,-895.25 1988.5,-926.25 2358.5,-926.25 2358.5,-895.25 1988.5,-895.25"/>
<text text-anchor="start" x="1993.5" y="-904.15" font-family="Arial" font-size="18.00">data_access_description (text)</text>
<polygon fill="none" stroke="black" points="1988.5,-864.25 1988.5,-895.25 2358.5,-895.25 2358.5,-864.25 1988.5,-864.25"/>
<text text-anchor="start" x="1993.5" y="-873.15" font-family="Arial" font-size="18.00">is_required (boolean)</text>
<polygon fill="none" stroke="black" points="1988.5,-833.25 1988.5,-864.25 2358.5,-864.25 2358.5,-833.25 1988.5,-833.25"/>
<text text-anchor="start" x="1993.5" y="-842.15" font-family="Arial" font-size="18.00">is_enabled (boolean)</text>
<polygon fill="none" stroke="black" points="1988.5,-802.25 1988.5,-833.25 2358.5,-833.25 2358.5,-802.25 1988.5,-802.25"/>
<text text-anchor="start" x="1993.5" y="-811.15" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="1988.5,-771.25 1988.5,-802.25 2358.5,-802.25 2358.5,-771.25 1988.5,-771.25"/>
<text text-anchor="start" x="1993.5" y="-780.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="1988.5,-740.25 1988.5,-771.25 2358.5,-771.25 2358.5,-740.25 1988.5,-740.25"/>
<text text-anchor="start" x="1993.5" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (linkedin_oauth_scopes_pkey)</text>
</g>
<!-- linkedin_oauth_scopes&#45;&gt;portfolios -->
<g id="mini-edge&#45;5" class="edge">
<title>linkedin_oauth_scopes:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#93c4b8" stroke-width="2.5" d="M2359.5,-1033.75C2391.67,-1034.8 2377.17,-763.01 2357.69,-736.84 2242.63,-578.73 2055.01,-761.86 1935.82,-604.35 1923.98,-588.43 1914.66,-562.97 1922.87,-551.3"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M2359.5,-1035.75C2393.67,-1034.7 2379.17,-762.9 2359.31,-735.66 2241.24,-577.3 2053.61,-760.43 1937.43,-603.15 1925.85,-587.75 1916.54,-562.29 1924.47,-552.5"/>
<polygon fill="#93c4b8" stroke="#93c4b8" stroke-width="2.5" points="1932.82,-548.06 1925.34,-556.08 1931.31,-549.5 1923.89,-552.62 1923.6,-551.93 1923.31,-551.24 1930.73,-548.12 1921.85,-547.78 1932.82,-548.06"/>
</g>
<!-- oauth_apps -->
<g id="mini-oauth_apps" class="node">
<title>oauth_apps</title>

<polygon fill="#9bb0c0" stroke="none" points="2411,-1082 2411,-1119 2694,-1119 2694,-1082 2411,-1082"/>
<polygon fill="none" stroke="black" points="2411,-1082 2411,-1119 2694,-1119 2694,-1082 2411,-1082"/>
<text text-anchor="start" x="2489.12" y="-1091.2" font-family="Arial" font-size="24.00">oauth_apps</text>
<polygon fill="none" stroke="black" points="2411,-1050.25 2411,-1082 2694,-1082 2694,-1050.25 2411,-1050.25"/>
<text text-anchor="start" x="2416" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2431.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (integer)</text>
<polygon fill="none" stroke="black" points="2411,-1019.25 2411,-1050.25 2694,-1050.25 2694,-1019.25 2411,-1019.25"/>
<text text-anchor="start" x="2416" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2430.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2443" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="2411,-988.25 2411,-1019.25 2694,-1019.25 2694,-988.25 2411,-988.25"/>
<text text-anchor="start" x="2416" y="-997.15" font-family="Arial" font-size="18.00">provider (varchar(50))</text>
<polygon fill="none" stroke="black" points="2411,-957.25 2411,-988.25 2694,-988.25 2694,-957.25 2411,-957.25"/>
<text text-anchor="start" x="2416" y="-966.15" font-family="Arial" font-size="18.00">client_id (text)</text>
<polygon fill="none" stroke="black" points="2411,-926.25 2411,-957.25 2694,-957.25 2694,-926.25 2411,-926.25"/>
<text text-anchor="start" x="2416" y="-935.15" font-family="Arial" font-size="18.00">client_secret (text)</text>
<polygon fill="none" stroke="black" points="2411,-895.25 2411,-926.25 2694,-926.25 2694,-895.25 2411,-895.25"/>
<text text-anchor="start" x="2416" y="-904.15" font-family="Arial" font-size="18.00">redirect_uri (text)</text>
<polygon fill="none" stroke="black" points="2411,-864.25 2411,-895.25 2694,-895.25 2694,-864.25 2411,-864.25"/>
<text text-anchor="start" x="2416" y="-873.15" font-family="Arial" font-size="18.00">scopes (text)</text>
<polygon fill="none" stroke="black" points="2411,-833.25 2411,-864.25 2694,-864.25 2694,-833.25 2411,-833.25"/>
<text text-anchor="start" x="2416" y="-842.15" font-family="Arial" font-size="18.00">is_active (boolean)</text>
<polygon fill="none" stroke="black" points="2411,-802.25 2411,-833.25 2694,-833.25 2694,-802.25 2411,-802.25"/>
<text text-anchor="start" x="2416" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamp)</text>
<polygon fill="none" stroke="black" points="2411,-771.25 2411,-802.25 2694,-802.25 2694,-771.25 2411,-771.25"/>
<text text-anchor="start" x="2416" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamp)</text>
<polygon fill="none" stroke="black" points="2411,-740.25 2411,-771.25 2694,-771.25 2694,-740.25 2411,-740.25"/>
<text text-anchor="start" x="2416" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (oauth_apps_pkey)</text>
</g>
<!-- oauth_apps&#45;&gt;portfolios -->
<g id="mini-edge&#45;6" class="edge">
<title>oauth_apps:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#9bb0c0" stroke-width="2.5" d="M2695,-1033.75C2727.17,-1034.8 2714.38,-761.65 2693.24,-736.89 2584.1,-606.59 2047.92,-734.57 1935.87,-604.4 1922.84,-589.06 1914.02,-562.79 1923,-551.06"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M2695,-1035.75C2729.17,-1034.7 2716.38,-761.56 2694.76,-735.61 2583.63,-604.65 2047.45,-732.62 1937.38,-603.1 1924.73,-588.42 1915.92,-562.15 1924.55,-552.33"/>
<polygon fill="#9bb0c0" stroke="#9bb0c0" stroke-width="2.5" points="1932.8,-548.02 1925.24,-555.96 1931.28,-549.45 1923.82,-552.49 1923.54,-551.79 1923.26,-551.1 1930.71,-548.06 1921.84,-547.62 1932.8,-548.02"/>
</g>
<!-- projects -->
<g id="mini-projects" class="node">
<title>projects</title>

<polygon fill="#98b8b8" stroke="none" points="2746,-1082 2746,-1119 2999,-1119 2999,-1082 2746,-1082"/>
<polygon fill="none" stroke="black" points="2746,-1082 2746,-1119 2999,-1119 2999,-1082 2746,-1082"/>
<text text-anchor="start" x="2830.12" y="-1091.2" font-family="Arial" font-size="24.00">projects</text>
<polygon fill="none" stroke="black" points="2746,-1050.25 2746,-1082 2999,-1082 2999,-1050.25 2746,-1050.25"/>
<text text-anchor="start" x="2751" y="-1060.9" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="2766.75" y="-1060.9" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="2746,-1019.25 2746,-1050.25 2999,-1050.25 2999,-1019.25 2746,-1019.25"/>
<text text-anchor="start" x="2751" y="-1029.15" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="2765.25" y="-1029.15" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="2778" y="-1029.15" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="2746,-988.25 2746,-1019.25 2999,-1019.25 2999,-988.25 2746,-988.25"/>
<text text-anchor="start" x="2751" y="-997.15" font-family="Arial" font-size="18.00">title (varchar(200))</text>
<polygon fill="none" stroke="black" points="2746,-957.25 2746,-988.25 2999,-988.25 2999,-957.25 2746,-957.25"/>
<text text-anchor="start" x="2751" y="-966.15" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="2746,-926.25 2746,-957.25 2999,-957.25 2999,-926.25 2746,-926.25"/>
<text text-anchor="start" x="2751" y="-935.15" font-family="Arial" font-size="18.00">url (varchar(300))</text>
<polygon fill="none" stroke="black" points="2746,-895.25 2746,-926.25 2999,-926.25 2999,-895.25 2746,-895.25"/>
<text text-anchor="start" x="2751" y="-904.15" font-family="Arial" font-size="18.00">image_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="2746,-864.25 2746,-895.25 2999,-895.25 2999,-864.25 2746,-864.25"/>
<text text-anchor="start" x="2751" y="-873.15" font-family="Arial" font-size="18.00">technologies (jsonb)</text>
<polygon fill="none" stroke="black" points="2746,-833.25 2746,-864.25 2999,-864.25 2999,-833.25 2746,-833.25"/>
<text text-anchor="start" x="2751" y="-842.15" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="2746,-802.25 2746,-833.25 2999,-833.25 2999,-802.25 2746,-802.25"/>
<text text-anchor="start" x="2751" y="-811.15" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="2746,-771.25 2746,-802.25 2999,-802.25 2999,-771.25 2746,-771.25"/>
<text text-anchor="start" x="2751" y="-780.15" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="2746,-740.25 2746,-771.25 2999,-771.25 2999,-740.25 2746,-740.25"/>
<text text-anchor="start" x="2751" y="-749.15" font-family="Arial" font-size="18.00">CONSTRAINT (projects_pkey)</text>
</g>
<!-- projects&#45;&gt;portfolios -->
<g id="mini-edge&#45;7" class="edge">
<title>projects:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#98b8b8" stroke-width="2.5" d="M3000,-1033.75C3032.17,-1034.8 3019.48,-761.57 2998.24,-736.9 2918.41,-641.36 2845.48,-707.67 2720.36,-690.74 2547.05,-666.75 2054.86,-734.2 1935.89,-604.42 1922.36,-589.47 1913.81,-562.96 1922.94,-551.12"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M3000,-1035.75C3034.17,-1034.7 3021.48,-761.48 2999.76,-735.6 2917.07,-639.88 2844.14,-706.19 2720.64,-688.76 2546.78,-664.76 2054.59,-732.22 1937.36,-603.08 1924.27,-588.85 1915.71,-562.35 1924.48,-552.39"/>
<polygon fill="#98b8b8" stroke="#98b8b8" stroke-width="2.5" points="1932.81,-548.03 1925.26,-555.98 1931.28,-549.46 1923.84,-552.51 1923.55,-551.82 1923.27,-551.13 1930.71,-548.08 1921.85,-547.65 1932.81,-548.03"/>
</g>
<!-- work_experience -->
<g id="mini-work_experience" class="node">
<title>work_experience</title>

<polygon fill="#e8b8a8" stroke="none" points="3051.38,-1128.5 3051.38,-1165.5 3375.62,-1165.5 3375.62,-1128.5 3051.38,-1128.5"/>
<polygon fill="none" stroke="black" points="3051.38,-1128.5 3051.38,-1165.5 3375.62,-1165.5 3375.62,-1128.5 3051.38,-1128.5"/>
<text text-anchor="start" x="3122" y="-1137.7" font-family="Arial" font-size="24.00">work_experience</text>
<polygon fill="none" stroke="black" points="3051.38,-1096.75 3051.38,-1128.5 3375.62,-1128.5 3375.62,-1096.75 3051.38,-1096.75"/>
<text text-anchor="start" x="3056.38" y="-1107.4" font-family="Arial" font-size="16.00" fill="#ffd700">🔑</text>
<text text-anchor="start" x="3072.12" y="-1107.4" font-family="Arial" font-size="18.00"> id (uuid)</text>
<polygon fill="none" stroke="black" points="3051.38,-1065.75 3051.38,-1096.75 3375.62,-1096.75 3375.62,-1065.75 3051.38,-1065.75"/>
<text text-anchor="start" x="3056.38" y="-1075.65" font-family="Arial" font-size="14.00" fill="#4169e1">🔑</text>
<text text-anchor="start" x="3070.62" y="-1075.65" font-family="Arial" font-size="10.00" fill="#4169e1">FK</text>
<text text-anchor="start" x="3083.38" y="-1075.65" font-family="Arial" font-size="18.00"> portfolio_id (uuid)</text>
<polygon fill="none" stroke="black" points="3051.38,-1034.75 3051.38,-1065.75 3375.62,-1065.75 3375.62,-1034.75 3051.38,-1034.75"/>
<text text-anchor="start" x="3056.38" y="-1043.65" font-family="Arial" font-size="18.00">company (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-1003.75 3051.38,-1034.75 3375.62,-1034.75 3375.62,-1003.75 3051.38,-1003.75"/>
<text text-anchor="start" x="3056.38" y="-1012.65" font-family="Arial" font-size="18.00">position (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-972.75 3051.38,-1003.75 3375.62,-1003.75 3375.62,-972.75 3051.38,-972.75"/>
<text text-anchor="start" x="3056.38" y="-981.65" font-family="Arial" font-size="18.00">location (varchar(200))</text>
<polygon fill="none" stroke="black" points="3051.38,-941.75 3051.38,-972.75 3375.62,-972.75 3375.62,-941.75 3051.38,-941.75"/>
<text text-anchor="start" x="3056.38" y="-950.65" font-family="Arial" font-size="18.00">start_date (varchar(20))</text>
<polygon fill="none" stroke="black" points="3051.38,-910.75 3051.38,-941.75 3375.62,-941.75 3375.62,-910.75 3051.38,-910.75"/>
<text text-anchor="start" x="3056.38" y="-919.65" font-family="Arial" font-size="18.00">end_date (varchar(20))</text>
<polygon fill="none" stroke="black" points="3051.38,-879.75 3051.38,-910.75 3375.62,-910.75 3375.62,-879.75 3051.38,-879.75"/>
<text text-anchor="start" x="3056.38" y="-888.65" font-family="Arial" font-size="18.00">description (text)</text>
<polygon fill="none" stroke="black" points="3051.38,-848.75 3051.38,-879.75 3375.62,-879.75 3375.62,-848.75 3051.38,-848.75"/>
<text text-anchor="start" x="3056.38" y="-857.65" font-family="Arial" font-size="18.00">is_current (boolean)</text>
<polygon fill="none" stroke="black" points="3051.38,-817.75 3051.38,-848.75 3375.62,-848.75 3375.62,-817.75 3051.38,-817.75"/>
<text text-anchor="start" x="3056.38" y="-826.65" font-family="Arial" font-size="18.00">company_url (varchar(300))</text>
<polygon fill="none" stroke="black" points="3051.38,-786.75 3051.38,-817.75 3375.62,-817.75 3375.62,-786.75 3051.38,-786.75"/>
<text text-anchor="start" x="3056.38" y="-795.65" font-family="Arial" font-size="18.00">sort_order (integer)</text>
<polygon fill="none" stroke="black" points="3051.38,-755.75 3051.38,-786.75 3375.62,-786.75 3375.62,-755.75 3051.38,-755.75"/>
<text text-anchor="start" x="3056.38" y="-764.65" font-family="Arial" font-size="18.00">created_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="3051.38,-724.75 3051.38,-755.75 3375.62,-755.75 3375.62,-724.75 3051.38,-724.75"/>
<text text-anchor="start" x="3056.38" y="-733.65" font-family="Arial" font-size="18.00">updated_at (timestamptz)</text>
<polygon fill="none" stroke="black" points="3051.38,-693.75 3051.38,-724.75 3375.62,-724.75 3375.62,-693.75 3051.38,-693.75"/>
<text text-anchor="start" x="3056.38" y="-702.65" font-family="Arial" font-size="18.00">CONSTRAINT (work_experience_pkey)</text>
</g>
<!-- work_experience&#45;&gt;portfolios -->
<g id="mini-edge&#45;8" class="edge">
<title>work_experience:e&#45;&gt;portfolios:w</title>
<path fill="none" stroke="#e8b8a8" stroke-width="2.5" d="M3376.62,-1080.25C3419.13,-1081.29 3404.49,-721.42 3374.9,-690.44 3156.02,-457.79 2158.68,-835.92 1935.9,-604.44 1922,-589.79 1913.65,-563.1 1922.89,-551.17"/>
<path fill="none" stroke="#7bb0c0" stroke-width="2.5" d="M3376.62,-1082.25C3421.12,-1081.21 3406.49,-721.33 3376.35,-689.06 3155.31,-455.92 2157.97,-834.05 1937.35,-603.06 1923.91,-589.19 1915.56,-562.5 1924.43,-552.44"/>
<polygon fill="#e8b8a8" stroke="#e8b8a8" stroke-width="2.5" points="1932.81,-548.03 1925.28,-556 1931.29,-549.47 1923.85,-552.54 1923.56,-551.84 1923.28,-551.15 1930.72,-548.09 1921.85,-547.68 1932.81,-548.03"/>
</g>
</g>
<script id="mini-graph-data" type="application/json">{"tables": {"app_log": {"defaultColor": "#E8A8A8", "highlightColor": "#fe9191", "desaturatedColor": "#cbc4c4", "triggers": [], "constraints": [], "edges": ["edge-0"]}, "contact_messages": {"defaultColor": "#E8B093", "highlightColor": "#ffa87c", "desaturatedColor": "#c1bcb9", "triggers": [], "constraints": [], "edges": ["edge-1"]}, "google_oauth_tokens": {"defaultColor": "#E8C093", "highlightColor": "#ffc17c", "desaturatedColor": "#c1bdb9", "triggers": [], "constraints": [], "edges": ["edge-2"]}, "linkedin_oauth_config": {"defaultColor": "#E8D8A8", "highlightColor": "#fee391", "desaturatedColor": "#cbc9c4", "triggers": [], "constraints": [], "edges": ["edge-3"]}, "linkedin_oauth_connections": {"defaultColor": "#B8D1A8", "highlightColor": "#adff7a", "desaturatedColor": "#bcbeba", "triggers": [], "constraints": [], "edges": ["edge-4"]}, "linkedin_oauth_scopes": {"defaultColor": "#93C4B8", "highlightColor": "#58ffd6", "desaturatedColor": "#a9adac", "triggers": [], "constraints": [], "edges": ["edge-5"]}, "oauth_apps": {"defaultColor": "#9BB0C0", "highlightColor": "#63b7f7", "desaturatedColor": "#abadaf", "triggers": [], "constraints": [], "edges": ["edge-6"]}, "portfolios": {"defaultColor": "#7BB0C0", "highlightColor": "#3cd1ff", "desaturatedColor": "#9a9fa0", "triggers": [], "constraints": [], "edges": ["edge-0", "edge-1", "edge-2", "edge-3", "edge-4", "edge-5", "edge-6", "edge-7", "edge-8"]}, "projects": {"defaultColor": "#98B8B8", "highlightColor": "#67e8e8", "desaturatedColor": "#a6a9a9", "triggers": [], "constraints": [], "edges": ["edge-7"]}, "work_experience": {"defaultColor": "#E8B8A8", "highlightColor": "#feac91", "desaturatedColor": "#cbc6c4", "triggers": [], "constraints": [], "edges": ["edge-8"]}}, "edges": {"edge-0": {"tables": ["app_log", "portfolios"], "defaultColor": "#E8A8A8", "highlightColor": "#fe9191", "desaturatedColor": "#d8b7b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE app_log \n    ADD CONSTRAINT app_log_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-1": {"tables": ["contact_messages", "portfolios"], "defaultColor": "#E8B093", "highlightColor": "#ffa87c", "desaturatedColor": "#d2b6a8", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE contact_messages \n    ADD CONSTRAINT contact_messages_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-2": {"tables": ["google_oauth_tokens", "portfolios"], "defaultColor": "#E8C093", "highlightColor": "#ffc17c", "desaturatedColor": "#d2bea8", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE google_oauth_tokens \n    ADD CONSTRAINT google_oauth_tokens_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-3": {"tables": ["linkedin_oauth_config", "portfolios"], "defaultColor": "#E8D8A8", "highlightColor": "#fee391", "desaturatedColor": "#d8d0b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_config \n    ADD CONSTRAINT linkedin_oauth_config_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-4": {"tables": ["linkedin_oauth_connections", "portfolios"], "defaultColor": "#B8D1A8", "highlightColor": "#b3e593", "desaturatedColor": "#bac6b2", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_connections \n    ADD CONSTRAINT linkedin_oauth_connections_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-5": {"tables": ["linkedin_oauth_scopes", "portfolios"], "defaultColor": "#93C4B8", "highlightColor": "#7adcc4", "desaturatedColor": "#9fb7b1", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE linkedin_oauth_scopes \n    ADD CONSTRAINT linkedin_oauth_scopes_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-6": {"tables": ["oauth_apps", "portfolios"], "defaultColor": "#9BB0C0", "highlightColor": "#88b2d2", "desaturatedColor": "#a4aeb6", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE oauth_apps \n    ADD CONSTRAINT oauth_apps_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-7": {"tables": ["projects", "portfolios"], "defaultColor": "#98B8B8", "highlightColor": "#87c8c8", "desaturatedColor": "#a0b0b0", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE projects \n    ADD CONSTRAINT projects_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}, "edge-8": {"tables": ["work_experience", "portfolios"], "defaultColor": "#E8B8A8", "highlightColor": "#feac91", "desaturatedColor": "#d8c0b7", "triggers": {}, "constraints": {}, "fkText": "ALTER TABLE work_experience \n    ADD CONSTRAINT work_experience_portfolio_id_fkey \n    FOREIGN KEY (portfolio_id) \n    REFERENCES portfolios(portfolio_id) ON DELETE CASCADE;", "fromColumn": "portfolio_id", "toColumn": "portfolio_id"}}, "defaultColor": "#cccccc", "highlightColor": "#ff0000"}</script>
</svg>

    <div id="viewport-indicator" class="viewport-indicator"></div>
  </div>
  <div class="resize-handle nw" id="resize_handle_nw" style="position:absolute;left:2px;top:24px;width:16px;height:16px;cursor:nw-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle ne" id="resize_handle_ne" style="position:absolute;right:2px;top:24px;width:16px;height:16px;cursor:ne-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle sw" id="resize_handle_sw" style="position:absolute;left:2px;bottom:2px;width:16px;height:16px;cursor:sw-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle se" id="resize_handle_se" style="position:absolute;right:2px;bottom:2px;width:16px;height:16px;cursor:se-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
</div>

        </div>
        
<div id="selection-container" class="selection-container container" 
     style="display:none">
  <div class="header" id="selection-header"></div>
      <div class="window-controls" style="position:absolute;right:2px;top:2px;z-index:10010;"></div>
  <div class="selection-container container-content" id="selection-inner-container">
    <div id="viewport-indicator" class="viewport-indicator"></div>
  </div>
  <div class="resize-handle nw" id="resize_handle_nw" style="position:absolute;left:2px;top:24px;width:16px;height:16px;cursor:nw-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle ne" id="resize_handle_ne" style="position:absolute;right:2px;top:24px;width:16px;height:16px;cursor:ne-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle sw" id="resize_handle_sw" style="position:absolute;left:2px;bottom:2px;width:16px;height:16px;cursor:sw-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
  <div class="resize-handle se" id="resize_handle_se" style="position:absolute;right:2px;bottom:2px;width:16px;height:16px;cursor:se-resize;background:rgba(0,0,0,0.1);border-radius:3px;"></div>
</div>

    
        </div>
    </foreignObject>
    <script type="text/javascript"><![CDATA[
document.addEventListener('DOMContentLoaded', () => {
    const svg = document.children[0];
    const mainGroup = document.getElementById('main-erd-group');
    const miniatureContainer = document.getElementById('miniature-container');
    const viewportIndicator = document.getElementById('viewport-indicator');
    const overlayContainer = document.getElementById('overlay-container');
    const graphDataElement = document.getElementById('graph-data');
    const graphData = JSON.parse(graphDataElement.textContent);
    const { tables, edges } = graphData;

    // --- State variables ---
    let initialTx = 0, initialTy = 0, initialS = 1;
    let userTx = 0, userTy = 0, userS = 1;
    let isPanning = false;
    let startX = 0, startY = 0;
    let dragThreshold = 5;
    let highlightedElementId = null;
    let dragState = { type: null, startX: 0, startY: 0, offsetX: 0, offsetY: 0, target: null, handle: null };
    let selectionContainerManuallyPositioned = false; // Flag to track if user has manually positioned selection container

    // --- Utility Functions ---

    // Get reliable viewport dimensions
    function getViewportDimensions() {
        return {
            width: document.documentElement.clientWidth || document.body.clientWidth || window.innerWidth,
            height: document.documentElement.clientHeight || document.body.clientHeight || window.innerHeight
        };
    }

    function fallbackCopyTextToClipboard(text, button) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.top = "0";
        textArea.style.left = "0";
        textArea.style.position = "fixed";
        textArea.style.opacity = "0";

        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
            const successful = document.execCommand('copy');
            if (successful) {
                button.innerHTML = '✓';
                button.title = 'Copied!';
                setTimeout(() => {
                    button.innerHTML = '📋';
                    button.title = 'Copy to clipboard';
                }, 2000);
            } else {
                console.error('Fallback: Oops, unable to copy');
            }
        } catch (err) {
            console.error('Fallback: Oops, unable to copy', err);
        }

        document.body.removeChild(textArea);
    }

    function downloadTextAsFile(text, filename) {
        const blob = new Blob([text], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);

        // Create HTML anchor element explicitly
        const a = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
        a.style.display = 'none';
        a.href = url;
        a.download = filename;

        // Find a suitable parent element (body, html, or documentElement)
        let parentElement = document.body;
        if (!parentElement) {
            parentElement = document.documentElement;
        }
        if (!parentElement) {
            parentElement = document.querySelector('html');
        }
        if (!parentElement) {
            // Fallback: try to find any element we can append to
            parentElement = document.querySelector('svg') || document.firstElementChild;
        }

        if (parentElement) {
            parentElement.appendChild(a);
            a.click();
            parentElement.removeChild(a);
        } else {
            // Last resort: try direct click without appending
            a.click();
        }

        // Clean up
        window.URL.revokeObjectURL(url);
    }

    // --- Window Controls ---
    // Update the addWindowControls function to take a buttons config parameter
    function addWindowControls(windowElem, options = {}) {
        // Helper function to remove emojis from text
        function removeEmojis(text) {
            // Remove common emojis used in the interface
            return text
                .replace(/📊|⚡|🔗|🔑|→|•/g, '')  // Remove specific emojis
                .replace(/\s+/g, ' ')  // Normalize whitespace
                .trim();
        }

        if (!windowElem) return;
        let controls = windowElem.querySelector('.window-controls');
        if (!controls) {
            controls = document.createElement('div');
            controls.className = 'window-controls';
            controls.style.position = 'absolute';
            controls.style.left = 'auto';
            controls.style.top = '2px';
            controls.style.right = '2px';
            controls.style.zIndex = '10001';
            windowElem.appendChild(controls);
        }

        const btnConfig = options.buttons || {};
        const allControls = {};

        // Only add copy button if specified in options
        if (btnConfig.copy) {
            let copyBtn = controls.querySelector('.copy-btn');
            if (!copyBtn) {
                copyBtn = document.createElement('button');
                copyBtn.className = 'copy-btn';
                copyBtn.title = 'Copy to clipboard';
                copyBtn.innerHTML = '📋';
                controls.appendChild(copyBtn);
            }
            allControls.copyBtn = copyBtn;
        }

        // Only add download button if specified in options
        if (btnConfig.download) {
            let downloadBtn = controls.querySelector('.download-btn');
            if (!downloadBtn) {
                downloadBtn = document.createElement('button');
                downloadBtn.className = 'download-btn';
                downloadBtn.title = 'Download as file';
                downloadBtn.innerHTML = '💾';
                controls.appendChild(downloadBtn);
            }
            allControls.downloadBtn = downloadBtn;
        }

        // Always add minimize button
        let minBtn = controls.querySelector('.minimize-btn');
        if (!minBtn) {
            minBtn = document.createElement('button');
            minBtn.className = 'minimize-btn';
            minBtn.title = 'Minimize';
            minBtn.innerHTML = '–';
            controls.appendChild(minBtn);
        }

        monclick = (container) => {
            container.classList.toggle('minimized');

            // Find all elements with container-content class within this container
            let elementsToToggle = container.querySelectorAll('.container-content');

            if (container.classList.contains('minimized')) {
                elementsToToggle.forEach(element => {
                    // Store the original display value before hiding
                    const currentDisplay = window.getComputedStyle(element).display;
                    element.setAttribute('data-original-display', currentDisplay);
                    element.style.display = 'none';
                });
                minBtn.innerHTML = '+';
                minBtn.title = 'Restore';
            } else {
                elementsToToggle.forEach(element => {
                    // Restore the original display value
                    const originalDisplay = element.getAttribute('data-original-display');
                    if (originalDisplay && originalDisplay !== 'none') {
                        element.style.display = originalDisplay;
                    } else {
                        // Fallback to empty string to use CSS default
                        element.style.display = '';
                    }
                    element.removeAttribute('data-original-display');
                });
                minBtn.innerHTML = '–';
                minBtn.title = 'Minimize';
            }
            if (options.onMinimize) options.onMinimize(container.classList.contains('minimized'));
        };

        // Also add event listener as backup
        minBtn.addEventListener('click', (e) => {
            let target = e.target.parentElement.parentElement;
            e.preventDefault();
            e.stopPropagation();
            monclick(target);
        });
        allControls.minBtn = minBtn;

        // Always add close button
        let closeBtn = controls.querySelector('.close-btn');
        if (!closeBtn) {
            closeBtn = document.createElement('button');
            closeBtn.className = 'close-btn';
            closeBtn.title = 'Close';
            closeBtn.innerHTML = '×';
            controls.appendChild(closeBtn);
        }

        closeBtn.addEventListener('click', (e) => {
            windowElem.style.display = 'none';
        });

        allControls.closeBtn = closeBtn;

        if (allControls.copyBtn) {
            allControls.copyBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();

                let copyText = '';
                const containerId = windowElem.id;

                if (containerId === 'metadata-container') {
                    // For metadata container, copy the structured content
                    const sections = windowElem.querySelectorAll('.metadata-section');
                    sections.forEach(section => {
                        const title = section.querySelector('h3')?.textContent || '';
                        if (title) {
                            copyText += `${title}\n${'='.repeat(title.length)}\n`;
                        }

                        // Extract metadata items
                        const items = section.querySelectorAll('.metadata-item');
                        items.forEach(item => {
                            const label = item.querySelector('.label')?.textContent || '';
                            const value = item.querySelector('.value')?.textContent || '';
                            if (label && value) {
                                copyText += `${label}: ${value}\n`;
                            }
                        });

                        // Extract single metadata items
                        const singleItems = section.querySelectorAll('.metadata-single');
                        singleItems.forEach(item => {
                            const label = item.querySelector('.label')?.textContent || '';
                            const value = item.querySelector('.value')?.textContent || '';
                            if (label && value) {
                                copyText += `${label}: ${value}\n`;
                            }
                        });

                        // Extract parameter rows
                        const paramRows = section.querySelectorAll('.param-row');
                        paramRows.forEach(row => {
                            const label = row.querySelector('.param-label')?.textContent || '';
                            const value = row.querySelector('.param-value')?.textContent || '';
                            if (label && value) {
                                copyText += `${label} ${value}\n`;
                            }
                        });

                        copyText += '\n';
                    });
                } else if (containerId === 'selection-container') {
                    // For selection container, copy the organized content
                    const innerContainer = windowElem.querySelector('#selection-inner-container');
                    if (innerContainer) {
                        const sections = innerContainer.querySelectorAll('.selection-section');
                        sections.forEach(section => {
                            const title = section.querySelector('h3')?.textContent || '';
                            if (title) {
                                const cleanTitle = removeEmojis(title);
                                copyText += `${cleanTitle}\n${'='.repeat(cleanTitle.length)}\n`;
                            }

                            // Extract table names
                            const tableNames = section.querySelectorAll('.table-name');
                            tableNames.forEach(tableName => {
                                copyText += `${tableName.textContent}\n`;
                            });

                            // Extract edge information
                            const edgeNames = section.querySelectorAll('.edge-name');
                            edgeNames.forEach(edgeName => {
                                const h4 = edgeName.querySelector('h4');
                                const pre = edgeName.querySelector('pre');
                                if (h4) {
                                    const cleanH4 = removeEmojis(h4.textContent);
                                    copyText += `${cleanH4}\n`;
                                }
                                if (pre) {
                                    copyText += `${pre.textContent}\n`;
                                }
                            });

                            // Extract trigger information
                            const triggerInfos = section.querySelectorAll('.trigger-info');
                            triggerInfos.forEach(triggerInfo => {
                                const triggerName = triggerInfo.querySelector('.trigger-name')?.textContent || '';
                                const triggerEvent = triggerInfo.querySelector('.trigger-event')?.textContent || '';
                                if (triggerName && triggerEvent) {
                                    copyText += `${triggerName}: ${triggerEvent}\n`;
                                }
                                // Also get any additional function info
                                const functionDiv = triggerInfo.querySelector('div[style*="font-size: 0.8rem"]');
                                if (functionDiv) {
                                    const cleanFunction = removeEmojis(functionDiv.textContent);
                                    copyText += `  ${cleanFunction}\n`;
                                }
                            });

                            copyText += '\n';
                        });
                    }
                } else {
                    // Fallback: copy all text content
                    const textContent = windowElem.textContent || windowElem.innerText || '';
                    copyText = textContent.trim();
                }

                // Copy to clipboard
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(copyText).then(() => {
                        // Visual feedback
                        allControls.copyBtn.innerHTML = '✓';
                        allControls.copyBtn.title = 'Copied!';
                        setTimeout(() => {
                            allControls.copyBtn.innerHTML = '📋';
                            allControls.copyBtn.title = 'Copy to clipboard';
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy to clipboard:', err);
                        // Fallback for older browsers
                        fallbackCopyTextToClipboard(copyText, allControls.copyBtn);
                    });
                } else {
                    // Fallback for older browsers
                    fallbackCopyTextToClipboard(copyText, allControls.copyBtn);
                }
            });
        }

        // Download button handler (for metadata/selection)
        if (allControls.downloadBtn) {
            allControls.downloadBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();

                let downloadText = '';
                let filename = 'container-content.txt';
                const containerId = windowElem.id;

                if (containerId === 'metadata-container') {
                    filename = 'database-metadata.txt';
                    // For metadata container, copy the structured content
                    const sections = windowElem.querySelectorAll('.metadata-section');
                    sections.forEach(section => {
                        const title = section.querySelector('h3')?.textContent || '';
                        if (title) {
                            downloadText += `${title}\n${'='.repeat(title.length)}\n`;
                        }

                        // Extract metadata items
                        const items = section.querySelectorAll('.metadata-item');
                        items.forEach(item => {
                            const label = item.querySelector('.label')?.textContent || '';
                            const value = item.querySelector('.value')?.textContent || '';
                            if (label && value) {
                                downloadText += `${label}: ${value}\n`;
                            }
                        });

                        // Extract single metadata items
                        const singleItems = section.querySelectorAll('.metadata-single');
                        singleItems.forEach(item => {
                            const label = item.querySelector('.label')?.textContent || '';
                            const value = item.querySelector('.value')?.textContent || '';
                            if (label && value) {
                                downloadText += `${label}: ${value}\n`;
                            }
                        });

                        // Extract parameter rows
                        const paramRows = section.querySelectorAll('.param-row');
                        paramRows.forEach(row => {
                            const label = row.querySelector('.param-label')?.textContent || '';
                            const value = row.querySelector('.param-value')?.textContent || '';
                            if (label && value) {
                                downloadText += `${label} ${value}\n`;
                            }
                        });

                        downloadText += '\n';
                    });
                } else if (containerId === 'selection-container') {
                    filename = 'selection-details.txt';
                    // For selection container, copy the organized content
                    const innerContainer = windowElem.querySelector('#selection-inner-container');
                    if (innerContainer) {
                        const sections = innerContainer.querySelectorAll('.selection-section');
                        sections.forEach(section => {
                            const title = section.querySelector('h3')?.textContent || '';
                            if (title) {
                                const cleanTitle = removeEmojis(title);
                                downloadText += `${cleanTitle}\n${'='.repeat(cleanTitle.length)}\n`;
                            }

                            // Extract table names
                            const tableNames = section.querySelectorAll('.table-name');
                            tableNames.forEach(tableName => {
                                downloadText += `${tableName.textContent}\n`;
                            });

                            // Extract edge information
                            const edgeNames = section.querySelectorAll('.edge-name');
                            edgeNames.forEach(edgeName => {
                                const h4 = edgeName.querySelector('h4');
                                const pre = edgeName.querySelector('pre');
                                if (h4) {
                                    const cleanH4 = removeEmojis(h4.textContent);
                                    downloadText += `${cleanH4}\n`;
                                }
                                if (pre) {
                                    downloadText += `${pre.textContent}\n`;
                                }
                            });

                            // Extract trigger information
                            const triggerInfos = section.querySelectorAll('.trigger-info');
                            triggerInfos.forEach(triggerInfo => {
                                const triggerName = triggerInfo.querySelector('.trigger-name')?.textContent || '';
                                const triggerEvent = triggerInfo.querySelector('.trigger-event')?.textContent || '';
                                if (triggerName && triggerEvent) {
                                    downloadText += `${triggerName}: ${triggerEvent}\n`;
                                }
                                // Also get any additional function info
                                const functionDiv = triggerInfo.querySelector('div[style*="font-size: 0.8rem"]');
                                if (functionDiv) {
                                    const cleanFunction = removeEmojis(functionDiv.textContent);
                                    downloadText += `  ${cleanFunction}\n`;
                                }
                            });

                            downloadText += '\n';
                        });
                    }
                } else {
                    // Fallback: copy all text content
                    const textContent = windowElem.textContent || windowElem.innerText || '';
                    downloadText = textContent.trim();
                }

                // Download the file
                downloadTextAsFile(downloadText, filename);

                // Visual feedback
                allControls.downloadBtn.innerHTML = '✓';
                allControls.downloadBtn.title = 'Downloaded!';
                setTimeout(() => {
                    allControls.downloadBtn.innerHTML = '💾';
                    allControls.downloadBtn.title = 'Download as file';
                }, 2000);
            });
        }

        controls.addEventListener('mousedown', e => e.stopPropagation());
        controls.addEventListener('click', e => e.stopPropagation());

        return allControls;
    }

    function makeResizable(windowElem) {
        // Get both handles
        const nwHandle = windowElem.querySelector('#resize_handle_nw');
        const seHandle = windowElem.querySelector('#resize_handle_se');

        if (nwHandle) {
            nwHandle.addEventListener('mousedown', function(event) {
                dragState.type = 'resize';
                const rect = windowElem.getBoundingClientRect();

                // Ensure we have inline styles set for consistent positioning
                if (!windowElem.style.left) {
                    windowElem.style.left = `${rect.left}px`;
                }
                if (!windowElem.style.top) {
                    windowElem.style.top = `${rect.top}px`;
                }
                if (!windowElem.style.width) {
                    windowElem.style.width = `${windowElem.offsetWidth}px`;
                }
                if (!windowElem.style.height) {
                    windowElem.style.height = `${windowElem.offsetHeight}px`;
                }

                dragState.target = windowElem; // The target is the window, not the handle
                dragState.handle = 'nw'; // Mark which handle we're using
                dragState.startX = event.clientX;
                dragState.startY = event.clientY;
                // Use consistent CSS dimensions instead of getBoundingClientRect
                dragState.startWidth = parseFloat(windowElem.style.width);
                dragState.startHeight = parseFloat(windowElem.style.height);
                // Now we can safely use the inline style values
                dragState.startLeft = parseFloat(windowElem.style.left);
                dragState.startTop = parseFloat(windowElem.style.top);
                windowElem.classList.add('resizing');
                event.preventDefault();
                event.stopPropagation();
            });

            // Prevent click events on resize handle
            nwHandle.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
            });
        }

        if (seHandle) {
            seHandle.addEventListener('mousedown', function(event) {
                dragState.type = 'resize';
                const rect = windowElem.getBoundingClientRect();

                // Ensure we have inline styles and use consistent CSS dimensions
                if (!windowElem.style.width) {
                    windowElem.style.width = `${windowElem.offsetWidth}px`;
                }
                if (!windowElem.style.height) {
                    windowElem.style.height = `${windowElem.offsetHeight}px`;
                }

                dragState.target = windowElem; // The target is the window, not the handle
                dragState.handle = 'se'; // Mark which handle we're using
                dragState.startX = event.clientX;
                dragState.startY = event.clientY;
                // Use the CSS dimensions instead of getBoundingClientRect
                dragState.startWidth = parseFloat(windowElem.style.width);
                dragState.startHeight = parseFloat(windowElem.style.height);
                windowElem.classList.add('resizing');
                event.preventDefault();
                event.stopPropagation();
            });

            // Prevent click events on resize handle
            seHandle.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
            });
        }
    }

    // --- Initialization ---
    const parseTransform = (transform) => {
        const result = { tx: 0, ty: 0, s: 1 };
        if (!transform) return result;
        const translateMatch = transform.match(/translate\(([^,)]+),([^,)]+)\)/);
        if (translateMatch) {
            result.tx = parseFloat(translateMatch[1]);
            result.ty = parseFloat(translateMatch[2]);
        }
        const scaleMatch = transform.match(/scale\(([^)]+)\)/);
        if (scaleMatch) {
            result.s = parseFloat(scaleMatch[1]);
        }
        return result;
    };
    const initialTransform = parseTransform(mainGroup ? mainGroup.getAttribute('transform') : '');
    initialTx = isNaN(initialTransform.tx) ? 0 : initialTransform.tx;
    initialTy = isNaN(initialTransform.ty) ? 0 : initialTransform.ty;
    initialS = isNaN(initialTransform.s) ? 1 : initialTransform.s;

    // --- Core Functions ---
    const getMainERDBounds = () => mainGroup.getBBox();
    const applyTransform = () => {
        const finalS = userS * initialS;
        const finalTx = (userTx * initialS) + initialTx;
        const finalTy = (userTy * initialS) + initialTy;
        mainGroup.setAttribute('transform', `translate(${finalTx} ${finalTy}) scale(${finalS})`);
        requestAnimationFrame(updateViewportIndicator);
    };

    const updateViewportIndicator = () => {
        if (!viewportIndicator) return;
        const mainBounds = getMainERDBounds();
        if (mainBounds.width === 0 || mainBounds.height === 0) return;
        const ctm = mainGroup.getScreenCTM();
        if (!ctm) return;
        const invCtm = ctm.inverse();
        const pt1 = svg.createSVGPoint();
        pt1.x = 0; pt1.y = 0;
        const svgPt1 = pt1.matrixTransform(invCtm);
        const pt2 = svg.createSVGPoint();
        const viewport = getViewportDimensions();
        pt2.x = viewport.width; pt2.y = viewport.height;
        const svgPt2 = pt2.matrixTransform(invCtm);
        const visibleWidth = svgPt2.x - svgPt1.x;
        const visibleHeight = svgPt2.y - svgPt1.y;
        const relLeft = (svgPt1.x - mainBounds.x) / mainBounds.width;
        const relTop = (svgPt1.y - mainBounds.y) / mainBounds.height;
        const relWidth = visibleWidth / mainBounds.width;
        const relHeight = visibleHeight / mainBounds.height;
        viewportIndicator.style.left = `${Math.max(0, Math.min(1, relLeft)) * 100}%`;
        viewportIndicator.style.top = `${Math.max(0, Math.min(1, relTop)) * 100}%`;
        viewportIndicator.style.width = `${Math.max(0, Math.min(1, relWidth)) * 100}%`;
        viewportIndicator.style.height = `${Math.max(0, Math.min(1, relHeight)) * 100}%`;
    };

    const updateSelectionContainerPosition = () => {
        const selectionContainer = document.getElementById('selection-container');
        const metadataContainer = document.getElementById('metadata-container');
        const miniatureContainer = document.getElementById('miniature-container');

        console.log('updateSelectionContainerPosition called', {
            selectionContainer: !!selectionContainer,
            metadataContainer: !!metadataContainer,
            miniatureContainer: !!miniatureContainer,
            manuallyPositioned: selectionContainerManuallyPositioned
        });

        // Don't auto-position if user has manually moved the selection container
        if (selectionContainerManuallyPositioned) {
            console.log('Selection container manually positioned, skipping auto-positioning');
            return;
        }

        if (selectionContainer && metadataContainer && miniatureContainer) {
            const miniatureRect = miniatureContainer.getBoundingClientRect();
            const metadataRect = metadataContainer.getBoundingClientRect();
            const margin = 16; // Same margin as other containers

            // Set width to be similar to metadata container
            const selectionWidth = metadataRect.width * 1.5;

            // Calculate max height (75% of viewport height)
            const viewport = getViewportDimensions();
            const maxHeight = Math.floor(viewport.height * 0.75);

            const leftPos = miniatureRect.right + margin;
            const topPos = miniatureRect.top;

            console.log(`Selection container positioning:`, {
                viewport: `${viewport.width}x${viewport.height}`,
                miniatureRect: miniatureRect,
                leftPos,
                topPos,
                selectionWidth,
                maxHeight
            });

            selectionContainer.style.position = 'fixed';
            selectionContainer.style.width = `${selectionWidth}px`;
            selectionContainer.style.maxHeight = `${maxHeight}px`;
            selectionContainer.style.left = `${leftPos}px`;
            selectionContainer.style.top = `${topPos}px`;
            selectionContainer.style.zIndex = '10001';

            console.log(`Selection container positioned at left: ${leftPos}px, top: ${topPos}px`);
        }
    };

    const onViewportChange = () => {
        requestAnimationFrame(updateViewportIndicator);
    };

    // --- Highlighting ---
    const GREY_COLOR = "#cccccc"; // color for non-highlighted elements

    // Helper function to convert hex color to rgba with specified opacity
    const hexToRgba = (hex, alpha = 1.0) => {
        // Remove # if present
        hex = hex.replace('#', '');

        // Handle 3-digit hex
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }

        // Extract RGB values
        const r = parseInt(hex.substring(0, 2), 16);
        const g = parseInt(hex.substring(2, 4), 16);
        const b = parseInt(hex.substring(4, 6), 16);

        return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    };

    // Helper function to convert RGB to HLS
    const rgbToHls = (r, g, b) => {
        r /= 255; g /= 255; b /= 255;
        const max = Math.max(r, g, b);
        const min = Math.min(r, g, b);
        let h, s, l = (max + min) / 2;

        if (max === min) {
            h = s = 0; // achromatic
        } else {
            const d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch (max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return [h, l, s];
    };

    // Helper function to convert HLS to RGB
    const hlsToRgb = (h, l, s) => {
        const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1/6) return p + (q - p) * 6 * t;
            if (t < 1/2) return q;
            if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        };

        let r, g, b;
        if (s === 0) {
            r = g = b = l; // achromatic
        } else {
            const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            const p = 2 * l - q;
            r = hue2rgb(p, q, h + 1/3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1/3);
        }
        return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
    };

    // Helper function to saturate a hex color
    const saturateColor = (hexColor, saturationFactor = 2.0) => {
        // Validate input
        if (!hexColor || typeof hexColor !== 'string') {
            console.warn('Invalid hex color:', hexColor);
            return '#cccccc';
        }

        // Remove # if present
        let hex = hexColor.replace('#', '');

        // Handle 3-digit hex
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }

        // Validate hex format
        if (hex.length !== 6 || !/^[0-9A-Fa-f]+$/.test(hex)) {
            console.warn('Invalid hex format:', hexColor, 'processed as:', hex);
            return hexColor; // Return original if invalid
        }

        // Convert hex to RGB
        const r = parseInt(hex.substring(0, 2), 16);
        const g = parseInt(hex.substring(2, 4), 16);
        const b = parseInt(hex.substring(4, 6), 16);

        // Validate RGB values
        if (isNaN(r) || isNaN(g) || isNaN(b)) {
            console.warn('Invalid RGB values:', r, g, b, 'from hex:', hexColor);
            return hexColor;
        }

        // Convert RGB to HLS
        const [h, l, s] = rgbToHls(r, g, b);

        // Increase saturation, clamping to valid range
        const newS = Math.min(1, Math.max(0, s * saturationFactor));

        // Convert back to RGB
        const [newR, newG, newB] = hlsToRgb(h, l, newS);

        // Validate final RGB values
        if (isNaN(newR) || isNaN(newG) || isNaN(newB)) {
            console.warn('Invalid final RGB values:', newR, newG, newB);
            return hexColor;
        }

        // Clamp to valid range
        const clampedR = Math.max(0, Math.min(255, Math.round(newR)));
        const clampedG = Math.max(0, Math.min(255, Math.round(newG)));
        const clampedB = Math.max(0, Math.min(255, Math.round(newB)));

        // Convert back to hex
        const finalHex = `#${clampedR.toString(16).padStart(2, '0')}${clampedG.toString(16).padStart(2, '0')}${clampedB.toString(16).padStart(2, '0')}`;

        return finalHex;
    };

    const getElementColor = (elem) => {
        if (!elem || !elem.id) return '#cccccc';

        const nodeId = elem.id.replace('mini-', '');

        if (elem.classList && elem.classList.contains('node')) {
            return tables[nodeId]?.defaultColor || '#cccccc';
        }

        if (elem.classList && elem.classList.contains('edge')) {
            return edges[nodeId]?.defaultColor || '#cccccc';
        }

        return '#cccccc';
    };

    // Function to apply visual emphasis effects for selection container hovers
    const setSaturationEffect = (elem, saturationFactor = 2.0, restore = false) => {
        if (!elem) return;
        let miniElem = null;
        const nodeId = elem.id;
        let isMini = nodeId.indexOf('mini-') != -1;

        if (!isMini) {
            const miniNodeId = 'mini-' + nodeId;
            miniElem = document.getElementById(miniNodeId);
            if (miniElem) {
                setSaturationEffect(miniElem, saturationFactor, restore);
            }
        }

        if (elem.classList && elem.classList.contains('node')) {
            if (restore) {
                // Remove visual emphasis
                elem.style.removeProperty('filter');
                elem.removeAttribute('transform');
                // Clear any stored original transform
                if (elem.dataset.originalTransform) {
                    elem.setAttribute('transform', elem.dataset.originalTransform);
                    delete elem.dataset.originalTransform;
                }
            } else {
                // Add visual emphasis - make the table more obvious
                elem.style.filter = 'brightness(1.3) contrast(1.2) drop-shadow(0px 0px 8px rgba(255,255,0,0.5))';

                // Store original transform if it exists
                const originalTransform = elem.getAttribute('transform');
                if (originalTransform) {
                    elem.dataset.originalTransform = originalTransform;
                }

                // For SVG elements, use SVG transform attribute for scaling
                const bbox = elem.getBBox();
                const centerX = bbox.x + bbox.width / 2;
                const centerY = bbox.y + bbox.height / 2;

                const scaleTransform = `translate(${centerX}, ${centerY}) scale(1.1) translate(${-centerX}, ${-centerY})`;
                const newTransform = originalTransform ? `${originalTransform} ${scaleTransform}` : scaleTransform;
                elem.setAttribute('transform', newTransform);
            }
        }

        if (elem.classList && elem.classList.contains('edge')) {
            if (restore) {
                // Remove edge emphasis
                const paths = elem.querySelectorAll('path');
                paths.forEach(path => {
                    path.style.removeProperty('filter');
                    path.style.removeProperty('stroke-width');
                });
            } else {
                // Add edge emphasis
                const paths = elem.querySelectorAll('path');
                paths.forEach(path => {
                    path.style.filter = 'brightness(1.6) contrast(1.9)';
                    const currentWidth = path.getAttribute('stroke-width') || '3';
                    path.style.strokeWidth = (parseFloat(currentWidth) * 1.5) + 'px';
                    path.style.transition = 'all 0.2s ease';
                });
            }
        }
    };

    // Function to apply saturation effects specifically for edges
    const setEdgeSaturationEffect = (edgeElement, saturationFactor = 2.0, restore = false) => {
        if (!edgeElement) return;

        const baseColor = getElementColor(edgeElement);
        const paths = edgeElement.querySelectorAll('path');

        paths.forEach((path) => {
            // Store original styles if not already stored
            if (!path.dataset.originalStroke) {
                path.dataset.originalStroke = path.getAttribute('stroke') || baseColor;
            }
            if (!path.dataset.originalStrokeWidth) {
                path.dataset.originalStrokeWidth = path.getAttribute('stroke-width') || '3';
            }

            if (restore) {
                // Restore original stroke color and width
                path.setAttribute('stroke', path.dataset.originalStroke);
                path.setAttribute('stroke-width', path.dataset.originalStrokeWidth);
            } else {
                // Apply saturated stroke color and slightly increased width
                const saturatedColor = saturateColor(baseColor, saturationFactor);
                path.setAttribute('stroke', saturatedColor);

                // Slightly increase stroke width for better visibility
                const originalWidth = parseFloat(path.dataset.originalStrokeWidth);
                path.setAttribute('stroke-width', (originalWidth * 1.5).toString());
            }
        });
    };

    const setElementColor = (elem, color, isHighlighted = false, isInActiveSelection = false) => {
        if (!elem) return;
        let miniElem = null;
        const nodeId = elem.id;
        let isMini = nodeId.indexOf('mini-') != -1;

        if (!isMini) {
            const miniNodeId = 'mini-' + nodeId;
            miniElem = document.getElementById(miniNodeId);
            if (miniElem) {
                setElementColor(miniElem, color, isHighlighted, isInActiveSelection)
            }
        }
        if (elem.classList && elem.classList.contains('node')) {
            // Set opacity based on selection state
            let opacity = '1';
            if (highlightedElementId !== null) {
                // Something is highlighted
                if (isHighlighted || isInActiveSelection) {
                    opacity = '1'; // Full opacity for highlighted elements
                } else {
                    opacity = '0.2'; // Reduced opacity for non-highlighted elements
                }
            } else {
                opacity = '1'; // Full opacity when nothing is highlighted
            }
            elem.setAttribute('opacity', opacity);

            const polygons = elem.querySelectorAll('polygon');

            // Get the table's header color for background with reduced opacity
            const tableColor = tables[nodeId.replace('mini-', '')]?.defaultColor || color;
            const backgroundColorWithOpacity = hexToRgba(tableColor, 0.1);

            polygons.forEach((polygon, index) => {
                const currentFill = polygon.getAttribute('fill');

                // Store original fill if not already stored
                if (!polygon.dataset.originalFill) {
                    polygon.dataset.originalFill = currentFill || 'white';
                }

                // Only modify white/transparent polygons (content areas)
                // NEVER touch any colored polygons (headers) - leave them completely alone
                const isContentPolygon = currentFill === 'white' || currentFill === 'none' || currentFill === 'transparent' || !currentFill;

                if (isContentPolygon && isHighlighted) {
                    // Only change content polygons when highlighting
                    polygon.setAttribute('fill', backgroundColorWithOpacity);
                } else if (isContentPolygon && !isHighlighted) {
                    // Restore content polygons to their original color instead of forcing to white
                    polygon.setAttribute('fill', polygon.dataset.originalFill || 'white');
                }
                // If it's a colored polygon (header), we NEVER touch it at all
            })
        }

        if (elem.classList && elem.classList.contains('edge')) {
            // Set opacity based on selection state
            let opacity = '1';
            if (highlightedElementId !== null) {
                // Something is highlighted
                if (isHighlighted || isInActiveSelection) {
                    opacity = '1'; // Full opacity for highlighted elements
                } else {
                    opacity = '0.2'; // Reduced opacity for non-highlighted elements
                }
            } else {
                opacity = '1'; // Full opacity when nothing is highlighted
            }
            elem.setAttribute('opacity', opacity);

            const polygons = elem.querySelectorAll('polygon');
            polygons.forEach(polygon => {
                polygon.setAttribute('stroke-width', isHighlighted ? '10' : '3');
                if (isMini) {
                    polygon.setAttribute('fill', isHighlighted ? color : GREY_COLOR);
                }
            })

            const edgeId = elem.id;
            const connectedTables = edges[edgeId]?.tables || [];

            const paths = elem.querySelectorAll('path');

            // Enhanced parallel edge handling - double width for all paths when highlighted
            if (paths.length > 1) {
                // Multiple parallel edges between same tables
                if (isHighlighted) {
                    // When highlighted, make both edges more prominent with doubled width
                    paths[0].setAttribute('stroke-width', '16'); // Primary edge: doubled from 8
                    paths[1].setAttribute('stroke-width', '12'); // Secondary edge: doubled from 6
                } else {
                    // Normal state for parallel edges
                    paths[0].setAttribute('stroke-width', '8');
                    paths[1].setAttribute('stroke-width', '6');
                }
                paths.forEach(path => path.setAttribute('opacity', '1'));
            } else if (paths.length === 1) {
                // Single edge
                if (isHighlighted) {
                    paths[0].setAttribute('stroke-width', '10'); // Doubled from 5
                } else {
                    paths[0].setAttribute('stroke-width', '5');
                }
                paths[0].setAttribute('opacity', '1');
            }
        }
    };


    const highlightElements = (tableIds, edgeIds, event) => {
        // Set the highlighted element ID
        if (tableIds.length > 0) {
            highlightedElementId = tableIds[0];
        } else if (edgeIds.length > 0) {
            highlightedElementId = edgeIds[0];
        }

        // First, reduce opacity of ALL elements
        Object.keys(tables).forEach(id => {
            const tableElement = document.getElementById(id);
            const miniTableElement = document.getElementById('mini-' + id);
            const isInSelection = tableIds.includes(id);

            if (tableElement) {
                setElementColor(tableElement, tables[id].defaultColor, false, isInSelection);
                if (isInSelection) {
                    tableElement.classList.add('highlighted');
                } else {
                    tableElement.classList.remove('highlighted');
                }
            }
            if (miniTableElement) {
                setElementColor(miniTableElement, tables[id].defaultColor, false, isInSelection);
                if (isInSelection) {
                    miniTableElement.classList.add('highlighted');
                } else {
                    miniTableElement.classList.remove('highlighted');
                }
            }
        });

        Object.keys(edges).forEach(id => {
            const edgeElement = document.getElementById(id);
            const miniEdgeElement = document.getElementById('mini-' + id);
            const isInSelection = edgeIds.includes(id);

            if (edgeElement) {
                setElementColor(edgeElement, getElementColor(edgeElement), false, isInSelection);
                if (isInSelection) {
                    edgeElement.classList.add('highlighted');
                } else {
                    edgeElement.classList.remove('highlighted');
                }
            }
            if (miniEdgeElement) {
                setElementColor(miniEdgeElement, getElementColor(miniEdgeElement), false, isInSelection);
                if (isInSelection) {
                    miniEdgeElement.classList.add('highlighted');
                } else {
                    miniEdgeElement.classList.remove('highlighted');
                }
            }
        });

        // Then, highlight the selected elements with full intensity
        tableIds.forEach(id => {
            const tableElement = document.getElementById(id);
            const miniTableElement = document.getElementById('mini-' + id);
            if (!tableElement) return;

            // Get the table's default color for highlighting
            const tableColor = tables[id].defaultColor || '#712e2eff';

            // Highlight with full intensity
            setElementColor(tableElement, tableColor, true, true);
            if (miniTableElement) {
                setElementColor(miniTableElement, tableColor, true, true);
            }
        });

        edgeIds.forEach(id => {
            let edgeElement = document.getElementById(id);
            let miniEdgeElement = document.getElementById('mini-' + id);
            if (!edgeElement) return;

            // Highlight with full intensity
            setElementColor(edgeElement, getElementColor(edgeElement), true, true);
            if (miniEdgeElement) {
                setElementColor(miniEdgeElement, getElementColor(edgeElement), true, true);
            }
        });

        showSelectionWindow(tableIds, edgeIds, event);
        
        // Update table selector to reflect current highlights
        if (window.updateTableSelector) {
            window.updateTableSelector();
        }
    };


    function showSelectionWindow(selectedTables, selectedEdges, event) {
        const selectionContainer = document.getElementById('selection-container');
        if (!selectionContainer) return;

        // Check if the selection window was previously hidden
        const wasHidden = selectionContainer.style.display === 'none' ||
                         window.getComputedStyle(selectionContainer).display === 'none';

        // Force visibility with strong inline styles
        selectionContainer.style.display = 'block';
        selectionContainer.style.position = 'fixed';
        selectionContainer.style.zIndex = '10001';

        // Reset manual positioning flag only if window was previously hidden
        // This allows auto-positioning on first show but preserves manual positioning during interactions
        if (wasHidden) {
            selectionContainerManuallyPositioned = false;
        }

        const inner = selectionContainer.querySelector('#selection-inner-container');
        const selection_header = document.getElementById('selection-header');
        if (!inner || !selection_header) return;

        let html = '';

        if (selectedTables.length) {
            let primaryTable = selectedTables[0];
            selection_header.innerHTML = `📋 ${primaryTable}`;

            // Table Information Section
            html += '<div class="selection-section">';
            html += '<h3>📊 Selected Tables</h3>';
            selectedTables.forEach((tableId, index) => {
                const tableData = graphData.tables[tableId];
                if (index === 0) {
                    html += `<div style="margin-bottom: 12px;">`;
                    html += `<span class="table-name" data-table-id="${tableId}" style="font-size: 1.1rem; font-weight: 600;">${tableId}</span>`;
                } else {
                    html += `<span class="table-name" data-table-id="${tableId}">${tableId}</span>`;
                }
                if (index === 0) html += `</div>`;
            });
            html += '</div>';

            // Add table details for the primary table
            const primaryTableData = graphData.tables[primaryTable];
            if (primaryTableData && primaryTableData.triggers && primaryTableData.triggers.length > 0) {
                html += '<div class="selection-section">';
                html += '<h3>⚡ Triggers</h3>';
                primaryTableData.triggers.forEach(trigger => {
                    html += '<div class="trigger-info">';
                    html += `<span class="trigger-name">${trigger.trigger_name}</span>`;
                    html += `<span class="trigger-event">${trigger.event}</span>`;
                    if (trigger.function) {
                        html += `<div style="font-size: 0.8rem; color: #7f8c8d; margin-top: 2px;">→ ${trigger.function}${trigger.function_args ? '(' + trigger.function_args + ')' : '()'}</div>`;
                    }
                    html += '</div>';
                });
                html += '</div>';
            }
        }

        // Foreign Keys Section
        if (selectedEdges.length) {
            html += '<div class="selection-section">';
            html += '<h3>🔗 Foreign Key Relationships</h3>';
            for (const edgeId of selectedEdges) {
                const edge = graphData.edges[edgeId];
                if (edge && edge.fkText) {
                    html += `<div class="edge-name" data-edge-id="${edgeId}">`;
                    html += `<h4>🔑 ${edge.fromColumn} → ${edge.toColumn}</h4>`;
                    html += `<pre>${edge.fkText}</pre>`;
                    html += '</div>';
                } else {
                    html += `<div class="edge-name" data-edge-id="${edgeId}">${edgeId}</div>`;
                }
            }
            html += '</div>';
        }

        inner.innerHTML = html;

        // Add click event listeners to table names (mouseover effects removed for performance)
        const tableNames = inner.querySelectorAll('.table-name');
        tableNames.forEach(tableNameSpan => {
            const tableId = tableNameSpan.getAttribute('data-table-id');

            // Mouseover event - apply saturation effect instead of highlighting
            tableNameSpan.addEventListener('mouseover', () => {
                // Get the table element in the SVG
                const tableElement = document.getElementById(tableId);
                const miniTableElement = document.getElementById('mini-' + tableId);

                if (tableElement) {
                    // Apply saturation effect with double saturation (2.0 factor)
                    setSaturationEffect(tableElement, 2.0, false);
                }

                // Also apply to the miniature version
                if (miniTableElement) {
                    setSaturationEffect(miniTableElement, 2.0, false);
                }
            });

            // Mouseout event - restore original appearance
            tableNameSpan.addEventListener('mouseout', (e) => {
                e.preventDefault();
                e.stopPropagation();

                const tableElement = document.getElementById(tableId);
                const miniTableElement = document.getElementById('mini-' + tableId);

                if (tableElement) {
                    setSaturationEffect(tableElement, 2.0, true);

                    // If this table should still be highlighted, ensure highlighting is maintained
                    if (highlightedElementId &&
                        (highlightedElementId === tableId ||
                         (tables[highlightedElementId] && tables[highlightedElementId].edges.some(edgeId =>
                             edges[edgeId] && edges[edgeId].tables.includes(tableId))))) {
                        // Re-apply highlighting to maintain background colors
                        tableElement.classList.add('highlighted');
                        setElementColor(tableElement, tables[tableId].defaultColor, true, true);
                    }
                }

                // Also restore the miniature version
                if (miniTableElement) {
                    setSaturationEffect(miniTableElement, 2.0, true);

                    // Maintain highlighting for mini version too
                    if (highlightedElementId &&
                        (highlightedElementId === tableId ||
                         (tables[highlightedElementId] && tables[highlightedElementId].edges.some(edgeId =>
                             edges[edgeId] && edges[edgeId].tables.includes(tableId))))) {
                        miniTableElement.classList.add('highlighted');
                        setElementColor(miniTableElement, tables[tableId].defaultColor, true, true);
                    }
                }
            });

            // ADD THE NEW CLICK HANDLER HERE
            tableNameSpan.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent scrolling
                e.stopPropagation();

                // Clear any existing highlights
                clearAllHighlights();

                // Set this table as the highlighted element
                highlightedElementId = tableId;

                // Get connected edges and tables (same logic as SVG click handler)
                const connectedEdges = tables[tableId].edges;
                const connectedTables = [tableId, ...connectedEdges.map(edgeId => edges[edgeId].tables).flat()];
                const uniqueTables = [...new Set(connectedTables)];

                // Highlight everything
                highlightElements(uniqueTables, connectedEdges);

                // Center view on the selected table
                const tableElement = document.getElementById(tableId);
                if (tableElement) {
                    // Get the bounding box of the table element
                    const bbox = tableElement.getBBox();
                    // Center coordinates of the table
                    const centerX = bbox.x + bbox.width / 2;
                    const centerY = bbox.y + bbox.height / 2;
                    // Center the view on the table, maintaining current zoom level
                    zoomToPoint(centerX, centerY, userS);
                }

                // No need to call showSelectionWindow again since we're already in it
            });
        });

        // Add click event listeners to edge names (mouseover effects removed for performance)
        const edgeNames = inner.querySelectorAll('.edge-name');
        edgeNames.forEach(edgeNameLi => {
            const edgeId = edgeNameLi.getAttribute('data-edge-id');

            // Mouseover event - apply saturation effect to the edge
            edgeNameLi.addEventListener('mouseover', () => {
                const edgeElement = document.getElementById(edgeId);
                const miniEdgeElement = document.getElementById('mini-' + edgeId);

                if (edgeElement) {
                    setEdgeSaturationEffect(edgeElement, 2.0, false);
                }

                if (miniEdgeElement) {
                    setEdgeSaturationEffect(miniEdgeElement, 2.0, false);
                }
            });

            // Mouseout event - restore original edge appearance
            edgeNameLi.addEventListener('mouseout', (e) => {
                e.preventDefault();
                e.stopPropagation();

                const edgeElement = document.getElementById(edgeId);
                const miniEdgeElement = document.getElementById('mini-' + edgeId);

                if (edgeElement) {
                    setEdgeSaturationEffect(edgeElement, 2.0, true);
                }

                if (miniEdgeElement) {
                    setEdgeSaturationEffect(miniEdgeElement, 2.0, true);
                }
            });
        });
    }

    function hideSelectionWindow() {
        const selectionContainer = document.getElementById('selection-container');
        if (selectionContainer) {
            selectionContainer.style.display = 'none';
            const inner = selectionContainer.querySelector('#selection-inner-container');
            if (inner) inner.innerHTML = '';
        }
    }

    const clearAllHighlights = () => {
        // Don't clear highlights during drag operations
        if (dragState.type !== null) {
            return;
        }

        // Also check if selection-container is being dragged (it has its own drag system)
        const selectionContainer = document.getElementById('selection-container');
        if (selectionContainer && selectionContainer._dragState) {
            return;
        }

        highlightedElementId = null; // Clear the highlighted element ID first

        Object.keys(tables).forEach(id => {
            const tableElement = document.getElementById(id);
            const miniTableElement = document.getElementById('mini-' + id);
            if (tableElement) {
                tableElement.classList.remove('highlighted');
                setElementColor(tableElement, tables[id].defaultColor, false, false);
            }
            if (miniTableElement) {
                miniTableElement.classList.remove('highlighted');
                setElementColor(miniTableElement, tables[id].defaultColor, false, false);
            }
        });
        Object.keys(edges).forEach(id => {
            const edgeElement = document.getElementById(id);
            const miniEdgeElement = document.getElementById('mini-' + id);
            if (edgeElement) {
                edgeElement.classList.remove('highlighted');
                setElementColor(edgeElement, edges[id].defaultColor, false, false);
            }
            if (miniEdgeElement) {
                miniEdgeElement.classList.remove('highlighted');
                setElementColor(miniEdgeElement, edges[id].defaultColor, false, false);
            }
        });
        hideSelectionWindow();
        
        // Update table selector to show all tables when highlights are cleared
        if (window.updateTableSelector) {
            window.updateTableSelector();
        }
    };

    // Reset pan and zoom to the initial state
    const resetZoom = () => {
        userTx = 0;
        userTy = 0;
        userS = 1;
        clearAllHighlights(); // Also clear highlights on reset
        applyTransform();
    };

    const zoomToPoint = (targetX, targetY, zoomLevel = userS) => {
        userS = zoomLevel;
        const finalS = userS * initialS;
        const pt = svg.createSVGPoint();
        const viewport = getViewportDimensions();
        pt.x = viewport.width / 2;
        pt.y = viewport.height / 2;
        const svgCenterPt = pt.matrixTransform(svg.getScreenCTM().inverse());
        const finalTx = svgCenterPt.x - targetX * finalS;
        const finalTy = svgCenterPt.y - targetY * finalS;
        userTx = (finalTx - initialTx) / initialS;
        userTy = (finalTy - initialTy) / initialS;
        applyTransform();
    };


    // --- EVENT LISTENERS ---

    // --- DRAG HANDLERS ---
    // Miniature drag
    const miniatureHeader = document.getElementById('miniature-header');
    if (miniatureHeader) {
        miniatureHeader.addEventListener('mousedown', (event) => {
            // Prevent drag if clicking on controls/buttons
            if (
                event.target.closest('.window-controls') ||
                event.target.tagName === 'BUTTON'
            ) {
                return;
            }

            const rect = miniatureContainer.getBoundingClientRect();

            // Ensure we have inline styles set for consistent positioning
            if (!miniatureContainer.style.left) {
                miniatureContainer.style.left = `${rect.left}px`;
            }
            if (!miniatureContainer.style.top) {
                miniatureContainer.style.top = `${rect.top}px`;
            }

            // Use the same isolated approach as selection container
            const miniatureDragState = {
                type: 'miniature-window',
                target: miniatureContainer,
                startX: event.clientX,
                startY: event.clientY,
                offsetX: parseFloat(miniatureContainer.style.left),
                offsetY: parseFloat(miniatureContainer.style.top)
            };

            miniatureContainer.classList.add('dragging');

            // Create miniature-specific mousemove handler
            const handleMouseMove = (moveEvent) => {
                moveEvent.preventDefault();
                moveEvent.stopPropagation();

                const dx = moveEvent.clientX - miniatureDragState.startX;
                const dy = moveEvent.clientY - miniatureDragState.startY;

                const newX = miniatureDragState.offsetX + dx;
                const newY = miniatureDragState.offsetY + dy;

                miniatureContainer.style.left = `${newX}px`;
                miniatureContainer.style.top = `${newY}px`;
            };

            // Create miniature-specific mouseup handler
            const handleMouseUp = (upEvent) => {
                upEvent.preventDefault();
                upEvent.stopPropagation();
                miniatureContainer.classList.remove('dragging');
                window.removeEventListener('mousemove', handleMouseMove);
                window.removeEventListener('mouseup', handleMouseUp);
            };

            // Add temporary event listeners for this drag operation only
            window.addEventListener('mousemove', handleMouseMove);
            window.addEventListener('mouseup', handleMouseUp);

            event.preventDefault();
            event.stopPropagation();
        });
        makeResizable(miniatureContainer);
    }
    // Viewport indicator drag
    if (viewportIndicator) {
        viewportIndicator.addEventListener('mousedown', (event) => {
            dragState.type = 'indicator';
            dragState.target = viewportIndicator;
            dragState.startX = event.clientX;
            dragState.startY = event.clientY;
            dragState.offsetX = event.target.left;
            dragState.offsetY = event.target.top;
            const style = window.getComputedStyle(viewportIndicator);
            dragState.indicatorStartLeft = parseFloat(style.left);
            dragState.indicatorStartTop = parseFloat(style.top);
            viewportIndicator.classList.add('dragging');
            event.preventDefault();
            event.stopPropagation();
        });
    }

    // Metadata box drag (whole container)
    const metadataContainer = document.getElementById('metadata-container');
    if (metadataContainer) {
        makeResizable(metadataContainer);
        metadataContainer.addEventListener('mousedown', (event) => {
            // Prevent drag if clicking on controls/buttons/interactive elements
            if (
                event.target.closest('.window-controls') ||
                event.target.tagName === 'BUTTON' ||
                event.target.tagName === 'SELECT' ||
                event.target.id === 'table-selector' ||
                event.target.closest('#table-selector')
            ) return;

            const rect = metadataContainer.getBoundingClientRect();

            // Ensure we have inline styles set for consistent positioning
            if (!metadataContainer.style.left) {
                metadataContainer.style.left = `${rect.left}px`;
            }
            if (!metadataContainer.style.top) {
                metadataContainer.style.top = `${rect.top}px`;
            }

            dragState.type = 'metadata';
            dragState.target = metadataContainer;
            dragState.startX = event.clientX;
            dragState.startY = event.clientY;
            // Now we can safely use the inline style values
            dragState.offsetX = parseFloat(metadataContainer.style.left);
            dragState.offsetY = parseFloat(metadataContainer.style.top);
            metadataContainer.classList.add('dragging');
            event.preventDefault();
            event.stopPropagation();
        });
    }

    // Selection window drag (whole container)
    const selectionContainer = document.getElementById('selection-container');
    const selectionInner = document.getElementById('selection-inner-container');
    if (selectionContainer) {
        makeResizable(selectionContainer);
        // Modified selection window mousedown handler
        selectionContainer.addEventListener('mousedown', (event) => {
            // Prevent drag if clicking on controls/buttons
            if (
                event.target.closest('.window-controls') ||
                event.target.tagName === 'BUTTON'
            ) return;

            // Stop event from reaching the SVG
            event.preventDefault();
            event.stopPropagation();

            // Get the container's current position
            const rect = selectionContainer.getBoundingClientRect();

            // Ensure we have inline styles set for consistent positioning
            if (!selectionContainer.style.left) {
                selectionContainer.style.left = `${rect.left}px`;
            }
            if (!selectionContainer.style.top) {
                selectionContainer.style.top = `${rect.top}px`;
            }

            // Use the global dragState (same as other containers)
            dragState.type = 'selection';
            dragState.target = selectionContainer;
            dragState.startX = event.clientX;
            dragState.startY = event.clientY;
            dragState.offsetX = parseFloat(selectionContainer.style.left);
            dragState.offsetY = parseFloat(selectionContainer.style.top);

            // Mark that user has manually positioned the selection container
            selectionContainerManuallyPositioned = true;

            selectionContainer.classList.add('dragging');
        });
    }



    // SVG panning (background drag)
    svg.addEventListener('mousedown', (event) => {
        // Check if we're inside any of the overlay containers or their children
        if (event.target.closest('#selection-container') ||
            event.target.closest('#miniature-container') ||
            event.target.closest('#metadata-container')) {
            return; // Don't initiate pan if we're in these containers
        }

        event.preventDefault();
        dragState.handle = event;
        event.stopPropagation();
        let rect = event.target.getBoundingClientRect();
        dragState.target = event.target;
        dragState.startX = event.clientX;
        dragState.startY = event.clientY;
        dragState.offsetX = rect.left;
        dragState.offsetY = rect.top;
        dragState.startHeight = rect.height;
        dragState.startWidth = rect.width;
        dragState.handle = event.target;
        if (event.target.id === 'resize_handle_se' || event.target.id === 'resize_handle_nw') {
            // Don't do anything here - the dedicated event listeners will handle it
            return;
        }
        dragState.type = 'pan';
        dragState.startX = event.clientX;
        dragState.startY = event.clientY;

        dragState.offsetX = rect.left;
        dragState.offsetY = rect.top;

    });

    // --- MOUSE MOVE HANDLER ---
    window.addEventListener('mousemove', (event) => {
        let target, enclosing_container, dx, dy;
        target = event.target;
        enclosing_container = target.getBoundingClientRect();
        startX = dragState.startX;
        startY = dragState.startY;

        if (!dragState.type) return;

        // Track that we moved during drag (for any drag type)
        if (startX !== undefined && startY !== undefined) {
            const dx = Math.abs(event.clientX - startX);
            const dy = Math.abs(event.clientY - startY);
            if (dx > dragThreshold || dy > dragThreshold) {
                dragDidMove = true;
            }
        }

        if (dragState.type === 'pan') {
            if (!isPanning && startX !== undefined && startY !== undefined) {
                dx = Math.abs(event.clientX - startX);
                dy = Math.abs(event.clientY - startY);
                if (dx > dragThreshold || dy > dragThreshold) {
                    isPanning = true;
                    svg.classList.add('grabbing');
                }
            }
            if (isPanning) {
                let panX = 0.03
                event.preventDefault();
                event.stopPropagation();
                dx = event.clientX - startX;
                dy = event.clientY - startY;
                userTx += (dx * panX) / (userS * initialS);
                userTy += (dy * panX) / (userS * initialS);
                applyTransform();
            }
        } else if (['miniature', 'metadata', 'selection'].includes(dragState.type)) {
            // Calculate movement delta and apply to original position
            dx = event.clientX - dragState.startX;
            dy = event.clientY - dragState.startY;

            const newX = dragState.offsetX + dx;
            const newY = dragState.offsetY + dy;

            dragState.target.style.left = `${newX}px`;
            dragState.target.style.top = `${newY}px`;

        } else if (dragState.type === 'indicator') {
            event.preventDefault();
            event.stopPropagation();

            const miniRect = miniatureContainer.getBoundingClientRect();

            // Clamp mouse position to miniature container bounds
            const clampedX = Math.max(miniRect.left, Math.min(miniRect.right, event.clientX));
            const clampedY = Math.max(miniRect.top, Math.min(miniRect.bottom, event.clientY));

            // Calculate relative position within the clamped bounds
            const relX = (clampedX - miniRect.left) / miniRect.width;
            const relY = (clampedY - miniRect.top) / miniRect.height;

            // Additional safety clamping to ensure we stay within 0-1 range
            const safeRelX = Math.max(0, Math.min(1, relX));
            const safeRelY = Math.max(0, Math.min(1, relY));

            // Get main SVG bounds
            const mainBounds = getMainERDBounds();
            const targetX = mainBounds.x + safeRelX * mainBounds.width;
            const targetY = mainBounds.y + safeRelY * mainBounds.height;

            // Zoom to the calculated point
            zoomToPoint(targetX, targetY, userS);

        } else if (dragState.type === 'resize') {
            event.preventDefault();
            event.stopPropagation();

            // Calculate how much the mouse has moved
            const dx = event.clientX - dragState.startX;
            const dy = event.clientY - dragState.startY;

            // Get the SVG element inside the container
            const container = dragState.target;
            const svgImage = container.querySelector('svg');

            // Calculate new dimensions based on which handle is being dragged
            let newWidth, newHeight, newLeft, newTop;

            if (dragState.handle === 'nw') {
                // Northwest handle: resize and reposition
                newWidth = Math.max(100, dragState.startWidth - dx);
                newHeight = Math.max(80, dragState.startHeight - dy);
                newLeft = dragState.startLeft + (dragState.startWidth - newWidth);
                newTop = dragState.startTop + (dragState.startHeight - newHeight);

                // Update position
                container.style.left = `${newLeft}px`;
                container.style.top = `${newTop}px`;
            }
            else if (dragState.handle === 'se') {
                // Southeast handle: just resize
                newWidth = Math.max(100, dragState.startWidth + dx);
                newHeight = Math.max(80, dragState.startHeight + dy);
            }

            // Update dimensions for both container and SVG
            container.style.width = `${newWidth}px`;
            container.style.height = `${newHeight}px`;

            if (svgImage) {
                svgImage.setAttribute('width', `${newWidth}px`);
                svgImage.setAttribute('height', `${newHeight}px`);
            }
        }
    });

    // Track if we actually moved during drag (to distinguish from simple clicks)
    let dragDidMove = false;

    // --- MOUSE UP HANDLER ---
    window.addEventListener('mouseup', (event) => {
        if (!dragState.type) return;

        // Prevent click events after drag operations
        event.preventDefault();
        event.stopPropagation();

        if (dragState.target) {
            dragState.target.classList.remove('dragging');
            dragState.target.classList.remove('resizing');
        }
        if (dragState.type === 'pan') {
            svg.classList.remove('grabbing');
            isPanning = false;
        } else if (dragState.type === 'resize') {
            const rect = dragState.target.getBoundingClientRect();
            const currentLeft = parseFloat(dragState.target.style.left) || rect.left;
            const currentTop = parseFloat(dragState.target.style.top) || rect.top;
            const newWidth = rect.width;
            const newHeight = rect.height;

            // Apply minimum size constraints while preserving position
            const minSize = 50;
            if (newWidth < minSize || newHeight < minSize) {
                const constrainedWidth = Math.max(minSize, newWidth);
                const constrainedHeight = Math.max(minSize, newHeight);

                // Only update dimensions, don't touch position
                dragState.target.style.width = `${constrainedWidth}px`;
                dragState.target.style.height = `${constrainedHeight}px`;

                // Update SVG inside if it exists
                const svgImage = dragState.target.querySelector('svg');
                if (svgImage) {
                    svgImage.setAttribute('width', `${constrainedWidth}px`);
                    svgImage.setAttribute('height', `${constrainedHeight}px`);
                }
            }
        }
        // Reset all dragState properties
        dragState.type = null;
        dragState.target = null;
        dragState.handle = null;
        dragDidMove = false;
    });

    // --- Other UI Events ---
    // Helper to compute minimum zoom to fit SVG in viewport
    function getMinZoomToFit() {
        const mainBounds = getMainERDBounds();
        if (!mainBounds.width || !mainBounds.height) return 0.01;
        const viewport = getViewportDimensions();
        const svgWidth = viewport.width;
        const svgHeight = viewport.height;
        const scaleX = svgWidth / mainBounds.width;
        const scaleY = svgHeight / mainBounds.height;
        return Math.min(scaleX, scaleY);
    }

    svg.addEventListener('wheel', (event) => {
        // Check if mouse is over selection container - if so, let it scroll naturally
        const selectionContainer = document.getElementById('selection-container');
        if (selectionContainer && event.target.closest('#selection-container')) {
            // Don't prevent default - let the selection container scroll
            return;
        }

        // Check if mouse is over other containers that might need scrolling
        if (event.target.closest('#metadata-container')) {
            return;
        }

        // Otherwise, handle zoom as normal
        event.preventDefault();
        const dir = event.deltaY < 0 ? 1 : -1;
        const scaleAmount = 1 + dir * 0.04;
        let newS = userS * scaleAmount;
        const minZoom = getMinZoomToFit();
        newS = Math.max(minZoom, Math.min(5, newS)); // Clamp to minZoom
        const pt = svg.createSVGPoint();
        pt.x = event.clientX;
        pt.y = event.clientY;
        const svgP = pt.matrixTransform(mainGroup.getScreenCTM().inverse());
        userTx -= (svgP.x * (newS - userS)) / initialS;
        userTy -= (svgP.y * (newS - userS)) / initialS;
        userS = newS;
        applyTransform();
    }, { passive: false });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' || e.key.toLowerCase() === 'r') {
            window.location.reload();

        }
    });

    window.addEventListener('scroll', onViewportChange, { passive: true });
    window.addEventListener('resize', onViewportChange, { passive: true });



    // --- Consolidated event listeners
    document.addEventListener('click', function (event) {
        // SVG highlight click handler
        if (event.target.closest('svg')) {
            let clickedElement = event.target;
            let tableId = null, edgeId = null;

            // First, try to find a node or edge by traversing up the DOM tree
            while (clickedElement && clickedElement !== svg) {
                if (clickedElement.classList && clickedElement.classList.contains('node')) {
                    tableId = clickedElement.id;
                    break;
                }
                if (clickedElement.classList && clickedElement.classList.contains('edge')) {
                    edgeId = clickedElement.id;
                    break;
                }
                clickedElement = clickedElement.parentElement;
            }

            // If we didn't find a node/edge by class, try finding by ID pattern
            if (!tableId && !edgeId) {
                clickedElement = event.target;
                while (clickedElement && clickedElement !== svg) {
                    if (clickedElement.id && clickedElement.id.startsWith('edge-')) {
                        edgeId = clickedElement.id;
                        break;
                    }
                    // Check if this element's ID matches a known table
                    if (clickedElement.id && tables[clickedElement.id]) {
                        tableId = clickedElement.id;
                        break;
                    }
                    clickedElement = clickedElement.parentElement;
                }
            }

            // Handle table click
            if (tableId && tables[tableId]) {
                event.preventDefault();
                event.stopPropagation();
                if (highlightedElementId === tableId) {
                    clearAllHighlights();
                } else {
                    clearAllHighlights();
                    highlightedElementId = tableId;
                    const connectedEdges = tables[tableId].edges;
                    const connectedTables = [tableId, ...connectedEdges.map(edgeId => edges[edgeId].tables).flat()];
                    const uniqueTables = [...new Set(connectedTables)];
                    highlightElements(uniqueTables, connectedEdges);
                    showSelectionWindow(uniqueTables, connectedEdges, event);
                }
                return;
            }

            // Handle edge click
            if (edgeId && edges[edgeId]) {
                event.preventDefault();
                event.stopPropagation();
                if (highlightedElementId === edgeId) {
                    clearAllHighlights();
                } else {
                    clearAllHighlights();
                    highlightedElementId = edgeId;
                    const connectedTables = edges[edgeId].tables;
                    highlightElements(connectedTables, [edgeId]);
                }
                return;
            }

            // Click on SVG background (not node/edge and not in containers): clear all highlights
            if (
                event.target === svg ||
                (!event.target.closest('.node') &&
                 !event.target.closest('.edge') &&
                 !event.target.closest('#selection-container') &&
                 !event.target.closest('#metadata-container') &&
                 !event.target.closest('#miniature-container'))
            ) {
                // Clear all highlights and restore original state
                clearAllHighlights();
                event.stopPropagation();
                return;
            }
        }

    });

    // Function to enhance edge clickability by adding invisible click areas
    function enhanceEdgeClickability() {
        const edges = svg.querySelectorAll('.edge');
        edges.forEach(edge => {
            const paths = edge.querySelectorAll('path');
            paths.forEach(path => {
                // Create a copy of the path with wider stroke for easier clicking
                const clickPath = path.cloneNode(true);
                clickPath.style.stroke = 'transparent';
                clickPath.style.strokeWidth = '12px'; // Much wider for easier clicking
                clickPath.style.fill = 'none';
                clickPath.style.pointerEvents = 'stroke';
                clickPath.style.cursor = 'pointer';

                // Insert the click path before the visible path
                edge.insertBefore(clickPath, path);

                // Make the original path non-interactive so the click path handles clicks
                path.style.pointerEvents = 'none';
            });
        });
    }

    // Table Selector functionality
    function initializeTableSelector() {
        const tableSelector = document.getElementById('table-selector');
        if (!tableSelector) {
            console.warn('Table selector element not found');
            return;
        }

        // Make sure we have access to the tables data
        if (!tables || Object.keys(tables).length === 0) {
            console.warn('No tables data available for table selector');
            return;
        }

        console.log('Initializing table selector with', Object.keys(tables).length, 'tables');

        // Function to populate the selector with tables
        function populateTableSelector(tablesToShow = null) {
            // Clear existing options
            while (tableSelector.firstChild) {
                tableSelector.removeChild(tableSelector.firstChild);
            }
            
            let tablesToDisplay;
            let optionText;
            
            if (!tablesToShow) {
                // Show all tables
                tablesToDisplay = Object.keys(tables);
                optionText = `All Tables (${tablesToDisplay.length})`;
            } else {
                // Show only highlighted/selected tables
                tablesToDisplay = tablesToShow;
                optionText = `Selected Tables (${tablesToDisplay.length})`;
            }
            
            console.log('About to populate selector with options:', optionText);
            
            // Add the default option - create in HTML namespace explicitly
            const defaultOption = document.createElementNS('http://www.w3.org/1999/xhtml', 'option');
            defaultOption.value = '';
            defaultOption.textContent = optionText;
            tableSelector.appendChild(defaultOption);
            console.log('Added default option, current option count:', tableSelector.options.length);
            
            // Add table options
            let addedCount = 0;
            tablesToDisplay.sort().forEach((tableId, index) => {
                const option = document.createElementNS('http://www.w3.org/1999/xhtml', 'option');
                option.value = tableId;
                option.textContent = tableId;
                tableSelector.appendChild(option);
                addedCount++;
                
                // Log progress for first few and last few
                if (index < 3 || index >= tablesToDisplay.length - 3) {
                    console.log(`Added option ${index + 1}: ${tableId}, total options now: ${tableSelector.options.length}`);
                }
            });

            console.log('Populated table selector with', tablesToDisplay.length, 'tables, final option count:', tableSelector.options.length);
            console.log('TableSelector element:', tableSelector);
            console.log('TableSelector innerHTML length:', tableSelector.innerHTML.length);
        }

        // Function to update selector based on current highlights
        function updateTableSelector() {
            const highlightedTables = document.querySelectorAll('.node.highlighted');
            if (highlightedTables.length > 0) {
                const tableIds = Array.from(highlightedTables).map(el => el.id).filter(id => tables[id]);
                populateTableSelector(tableIds);
            } else {
                populateTableSelector(); // Show all tables
            }
        }

        // Handle selector change
        tableSelector.addEventListener('change', function() {
            const selectedTableId = this.value;
            if (!selectedTableId) return;

            // Clear existing highlights
            clearAllHighlights();

            if (tables[selectedTableId]) {
                // Set this table as highlighted
                highlightedElementId = selectedTableId;
                
                // Get connected edges and tables (same logic as SVG click handler)
                const connectedEdges = tables[selectedTableId].edges;
                const connectedTables = [selectedTableId, ...connectedEdges.map(edgeId => edges[edgeId].tables).flat()];
                const uniqueTables = [...new Set(connectedTables)];
                
                // Highlight the table and its connections
                highlightElements(uniqueTables, connectedEdges);
                
                // Show selection window
                showSelectionWindow(uniqueTables, connectedEdges, null);
                
                // Focus on the selected table
                focusOnTable(selectedTableId);
            }
            
            // Reset selector to default option
            this.selectedIndex = 0;
        });

        // Prevent drag events from interfering with table selector interaction
        tableSelector.addEventListener('mousedown', function(event) {
            event.stopPropagation();
        });

        tableSelector.addEventListener('click', function(event) {
            event.stopPropagation();
        });

        tableSelector.addEventListener('focus', function(event) {
            event.stopPropagation();
        });

        // Function to focus on a table (zoom to it)
        function focusOnTable(tableId) {
            const tableElement = document.getElementById(tableId);
            if (!tableElement) return;

            try {
                // Get the table's SVG bounding box
                const bbox = tableElement.getBBox();
                
                // Calculate the center of the table in SVG coordinates
                const tableCenterX = bbox.x + bbox.width / 2;
                const tableCenterY = bbox.y + bbox.height / 2;
                
                // Zoom to the table with a reasonable zoom level
                zoomToPoint(tableCenterX, tableCenterY, Math.max(userS, 1.2));
            } catch (error) {
                console.warn('Could not focus on table:', tableId, error);
            }
        }

        // Store the update function globally so it can be called from other parts
        window.updateTableSelector = updateTableSelector;

        // Initial population
        populateTableSelector();
    }


    function initializeSvgView() {

        if (!svg || !mainGroup || !miniatureContainer || !viewportIndicator || !getMainERDBounds()) {
            setTimeout(initializeSvgView, 200);
            return;
        }

        try {
            // Get bounds and verify they're valid
            const mainBounds = getMainERDBounds();
            if (!mainBounds || typeof mainBounds !== 'object' ||
                mainBounds.width <= 0 || mainBounds.height <= 0) {
                setTimeout(initializeSvgView, 200);
                return;
            }

            // Calculate center of the diagram
            const centerX = mainBounds.x + mainBounds.width / 2;
            const centerY = mainBounds.y + mainBounds.height / 2;

            // Calculate zoom level (fit the diagram with some padding, but more zoomed in)
            const viewport = getViewportDimensions();
            const viewportWidth = viewport.width;
            const viewportHeight = viewport.height;
            const scaleX = viewportWidth / (mainBounds.width * 0.8); // Less padding = more zoomed in
            const scaleY = viewportHeight / (mainBounds.height * 0.8);
            const scale = Math.min(scaleX, scaleY, 1.5); // Allow zoom in up to 1.5x

            // Reset and apply transformation
            userTx = 0;
            userTy = 0;
            userS = scale;


            // Use zoomToPoint for consistent positioning
            zoomToPoint(centerX, centerY, scale);

            // Force viewport indicator update
            updateViewportIndicator();

            // Enhance edge clickability by adding invisible click areas
            enhanceEdgeClickability();

            // Ensure viewport indicator is visible
            if (viewportIndicator) {
                viewportIndicator.style.display = 'block';
                viewportIndicator.style.opacity = '1';
                viewportIndicator.style.border = '2px solid #ff4081';
                viewportIndicator.style.backgroundColor = 'rgba(255, 64, 129, 0.2)';
                viewportIndicator.style.pointerEvents = 'all';

                // Add this debug to check viewport indicator dimensions
                const viStyle = window.getComputedStyle(viewportIndicator);
            }

            // Position miniature container next to metadata container
            const metadataContainer = document.getElementById('metadata-container');
            if (miniatureContainer && metadataContainer) {
                const metadataRect = metadataContainer.getBoundingClientRect();
                const margin = 16; // 16px margin between containers

                miniatureContainer.style.position = 'fixed';
                miniatureContainer.style.left = `${metadataRect.right + margin}px`;
                miniatureContainer.style.top = `${metadataRect.top}px`;

            }

            // Position containers
            updateSelectionContainerPosition();

            // Add browser zoom level to metadata
            const addBrowserZoomToMetadata = () => {
                const metadataInner = document.querySelector('.metadata-inner-container ul');
                if (metadataInner) {
                    // Remove existing browser zoom entry if it exists
                    const existingZoomItem = metadataInner.querySelector('.browser-zoom-item');
                    if (existingZoomItem) {
                        existingZoomItem.remove();
                    }

                    // Calculate browser zoom level
                    const browserZoom = Math.round(window.devicePixelRatio * 100);

                    // Create new browser zoom item
                    const zoomItem = document.createElement('li');
                    zoomItem.className = 'browser-zoom-item';
                    zoomItem.innerHTML = `Browser Zoom: ${browserZoom}%`;

                    // Add it to the metadata list
                    metadataInner.appendChild(zoomItem);
                }
            };

            // Add browser zoom to metadata initially
            addBrowserZoomToMetadata();

            // Update browser zoom when window is resized/zoomed
            window.addEventListener('resize', addBrowserZoomToMetadata);

            // Initialize window controls for all containers
            if (metadataContainer) {
                addWindowControls(metadataContainer, {
                    buttons: { copy: true, download: true, edit: false }
                });
                makeResizable(metadataContainer);
            }

            if (miniatureContainer) {
                addWindowControls(miniatureContainer, {
                    buttons: { copy: false, edit: false }
                });
                makeResizable(miniatureContainer);
            }

            if (selectionContainer) {
                addWindowControls(selectionContainer, {
                    buttons: { copy: true, download: true, edit: true }
                });
                makeResizable(selectionContainer);
            }

            // Initialize table selector
            initializeTableSelector();
        } catch (error) {
            console.error("Error during SVG initialization:", error);
            setTimeout(initializeSvgView, 300);
        }
    }

    // Primary initialization on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', () => {
        // Small delay to ensure SVG is fully parsed
        setTimeout(initializeSvgView, 300);

        // Also initialize when window is resized
        window.addEventListener('resize', () => {
            // Debounce the resize event
            if (window.resizeTimer) clearTimeout(window.resizeTimer);
            window.resizeTimer = setTimeout(() => {
                updateViewportIndicator();
                updateSelectionContainerPosition();
            }, 250);
        });
    });

    // Backup initialization for cases when DOMContentLoaded already fired
    if (document.readyState === 'complete' || document.readyState === 'interactive') {
        setTimeout(initializeSvgView, 300);
    }
});

]]></script>
</svg>
